<!doctype html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">



<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">












  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.0" rel="stylesheet" type="text/css">


  <meta name="keywords" content="Hexo, NexT">





  <link rel="alternate" href="/atom.xml" title="My Little World" type="application/atom+xml">




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.0">






<meta property="og:type" content="website">
<meta property="og:title" content="My Little World">
<meta property="og:url" content="http://yoohannah.github.io/index.html">
<meta property="og:site_name" content="My Little World">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="My Little World">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: 'åšä¸»'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoohannah.github.io/">





  <title> My Little World </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  










  
  
    
  

  <div class="container one-collumn sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">My Little World</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle">learn and share</p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            é¦–é¡µ
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br>
            
            åˆ†ç±»
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            æ ‡ç­¾
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            å½’æ¡£
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br>
            
            å…³äº
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://yoohannah.github.io/post/deepLearning/ConvolutionalNeuralNetworks.html">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="YooHannah">
    <meta itemprop="description" content>
    <meta itemprop="image" content="/psb.jpg">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="My Little World">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="My Little World" src>
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/post/deepLearning/ConvolutionalNeuralNetworks.html" itemprop="url">
                  å·ç§¯ç¥ç»ç½‘ç»œ
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2025-02-03T17:15:37+08:00">
                2025-02-03
              </time>
            

            

            
          </span>

          

          
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h1><p>å¦‚æœç”¨ç¥ç»ç½‘ç»œç›´æ¥å¤„ç†1000x1000çš„å›¾ç‰‡ï¼Œé‚£ä¹ˆåœ¨ä¸€å¼€å§‹å…¥å‚å°±éœ€è¦1000x1000x3 = 3miliä¸ªå‚æ•°ï¼ŒåŠ ä¸Šåç»­layerçš„å‚æ•°ï¼Œ<br>ä¼šå¯¼è‡´æ•´ä¸ªç¥ç»ç½‘ç»œéœ€è¦è¶³å¤Ÿå·¨å¤§çš„å†…å­˜ï¼Œä¸”æ¶ˆè€—è®­ç»ƒæ—¶é—´ï¼Œå¦å¤–éš¾ä»¥è·å–è¶³å¤Ÿå¤šçš„æ•°æ®é˜²æ­¢å‡ºç°è¿‡æ‹Ÿåˆé—®é¢˜å’Œç«äº‰éœ€æ±‚<br>å› æ­¤ï¼Œè®¡ç®—æœºè§†è§‰ä¸­è¿›è¡Œå›¾ç‰‡è¯†åˆ«å°±å¼•å…¥äº†å·ç§¯è®¡ç®—ï¼Œè§£å†³å¤§å›¾ç‰‡è¯†åˆ«é—®é¢˜</p>
<h1 id="å·ç§¯è®¡ç®—"><a href="#å·ç§¯è®¡ç®—" class="headerlink" title="å·ç§¯è®¡ç®—"></a>å·ç§¯è®¡ç®—</h1><p>å·ç§¯è¿ç®—åœ¨å›¾åƒå¤„ç†å’Œè®¡ç®—æœºè§†è§‰ä¸­è¢«å¹¿æ³›ç”¨äºè¾¹ç¼˜æ£€æµ‹ã€‚<br>è¾¹ç¼˜æ£€æµ‹æ˜¯è¯†åˆ«å›¾åƒä¸­åƒç´ å€¼å˜åŒ–æ˜¾è‘—çš„åŒºåŸŸï¼Œè¿™äº›åŒºåŸŸé€šå¸¸å¯¹åº”äºç‰©ä½“çš„è¾¹ç•Œã€‚<br>å·ç§¯è¿ç®—é€šè¿‡åœ¨å›¾åƒä¸Šåº”ç”¨ç‰¹å®šçš„æ»¤æ³¢å™¨ï¼ˆæˆ–å·ç§¯æ ¸ï¼‰æ¥å®ç°è¿™ä¸€ç‚¹ã€‚</p>
<p>å·ç§¯è¿ç®—æ¶‰åŠå°†ä¸€ä¸ªå°çŸ©é˜µï¼ˆç§°ä¸ºå·ç§¯æ ¸æˆ–æ»¤æ³¢å™¨ï¼‰åœ¨å›¾åƒä¸Šæ»‘åŠ¨ï¼Œå¹¶åœ¨æ¯ä¸ªä½ç½®è®¡ç®—è¯¥æ ¸ä¸å›¾åƒå±€éƒ¨åŒºåŸŸçš„ç‚¹ç§¯ã€‚<br>å·ç§¯æ ¸çš„å¤§å°é€šå¸¸è¾ƒå°ï¼ˆå¦‚ 3x3ã€5x5ï¼‰ï¼Œè€Œå›¾åƒå¯èƒ½å¾ˆå¤§ã€‚</p>
<h2 id="æ­¥éª¤"><a href="#æ­¥éª¤" class="headerlink" title="æ­¥éª¤"></a>æ­¥éª¤</h2><p>é€‰æ‹©å·ç§¯æ ¸ï¼šé€‰æ‹©ä¸€ä¸ªåˆé€‚çš„å·ç§¯æ ¸ï¼Œä¾‹å¦‚ Sobel æ ¸ï¼Œç”¨äºæ£€æµ‹å›¾åƒä¸­çš„è¾¹ç¼˜ã€‚<br>æ»‘åŠ¨å·ç§¯æ ¸ï¼šå°†å·ç§¯æ ¸ä»å›¾åƒçš„å·¦ä¸Šè§’å¼€å§‹ï¼Œé€åƒç´ åœ°åœ¨å›¾åƒä¸Šæ»‘åŠ¨ã€‚å¯¹äºæ¯ä¸ªä½ç½®ï¼Œå°†å·ç§¯æ ¸ä¸å›¾åƒçš„å¯¹åº”åŒºåŸŸè¿›è¡Œç‚¹ç§¯è¿ç®—ã€‚<br>è®¡ç®—å·ç§¯å€¼ï¼šå°†å·ç§¯æ ¸ä¸å›¾åƒå±€éƒ¨åŒºåŸŸçš„åƒç´ å€¼ç›¸ä¹˜å¹¶æ±‚å’Œï¼Œå¾—åˆ°è¯¥ä½ç½®çš„å·ç§¯å€¼ã€‚<br>ç”Ÿæˆè¾“å‡ºå›¾åƒï¼šå°†æ¯ä¸ªä½ç½®çš„å·ç§¯å€¼ç»„æˆä¸€ä¸ªæ–°çš„å›¾åƒï¼Œè¯¥å›¾åƒçš„æ¯ä¸ªåƒç´ å€¼è¡¨ç¤ºåŸå§‹å›¾åƒä¸­å¯¹åº”ä½ç½®çš„è¾¹ç¼˜å¼ºåº¦ã€‚<br><img src="/image/deepLearning/111.png" alt><br><img src="/image/deepLearning/112.png" alt><br><img src="/image/deepLearning/113.png" alt><br><img src="/image/deepLearning/114.png" alt><br><img src="/image/deepLearning/115.png" alt></p>
<h3 id="padding"><a href="#padding" class="headerlink" title="padding"></a>padding</h3><p>å¦‚ä¸Šè®¡ç®—è¿‡ç¨‹å­˜åœ¨ä¸¤ä¸ªå¼Šç«¯<br>ä¸€ä¸ªæ˜¯å·ç§¯è®¡ç®—å®Œä¹‹åï¼Œè¾“å‡ºå›¾åƒçš„å¤§å°ä¼šæ¯”è¾“å…¥å›¾åƒå°ï¼Œå¦‚æœç¥ç»ç½‘ç»œæœ‰100å±‚ï¼Œæ¯ä¸€å±‚éƒ½ç¼©å°ä¸€ç‚¹ç‚¹ï¼Œæœ€ç»ˆå¾—åˆ°çš„å›¾ç‰‡å¯èƒ½æ˜¯1x1å¤§å°çš„å›¾ç‰‡ï¼Œ<br>å¦å¤–ä¸€ä¸ªæ˜¯æ— æ³•å……åˆ†åˆ©ç”¨å›¾ç‰‡è¾¹ç¼˜ä¿¡æ¯ï¼Œå› ä¸ºå·ç§¯æ ¸åœ¨è¾¹ç¼˜å¤„è®¡ç®—æ—¶ï¼Œå›¾ç‰‡çš„è¾¹ç¼˜æ•°æ®åªè¢«ç”¨åˆ°äº†ä¸€æ¬¡ï¼Œä½†æ˜¯ä¸­é—´çš„æ•°æ®è¢«ç”¨åˆ°äº†å¤šæ¬¡ï¼Œå¯¼è‡´å›¾ç‰‡ä¿¡æ¯æ²¡æœ‰ç­‰æ¦‚ç‡çš„å‚æ•°æ¨æµ‹<br>ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œåœ¨å›¾ç‰‡è¾¹ç¼˜æ·»åŠ påœˆ0ï¼Œè¿™æ ·å·ç§¯æ ¸åœ¨è¾¹ç¼˜å¤„è®¡ç®—æ—¶ï¼Œå›¾ç‰‡çš„è¾¹ç¼˜æ•°æ®å°±å¯ä»¥è¢«ç”¨åˆ°äº†å¤šæ¬¡ï¼Œä»è€Œå¯ä»¥é˜²æ­¢è®¡ç®—åå›¾ç‰‡ç¼©å°<br>è¿™ä¸ªæ“ä½œçš„è¿‡ç¨‹å°±æ˜¯å·ç§¯è®¡ç®—åŠ paddingçš„æ“ä½œ<br><img src="/image/deepLearning/116.png" alt><br>åŠ paddingæœ‰ä¸¤ç§æ–¹å¼valid å’Œ same<br>valid è¡¨ç¤ºä¸åŠ paddingï¼Œè¾“å‡ºå›¾ç‰‡è®¡ç®—å…¬å¼ä¸º nxn  * fxf = (n-f+1) x (n-f+1)<br>same è¡¨ç¤ºåŠ paddingï¼Œä½¿å¾—è¾“å‡ºå›¾åƒçš„å¤§å°å’Œè¾“å…¥å›¾åƒçš„å¤§å°ç›¸åŒ<br>(n + 2p - f + 1 ) x (n + 2p - f + 1 ) = n x n<br>p = (f - 1) / 2<br>è¿™æ ·è¿‡æ»¤å™¨f ä¸€èˆ¬ä¸ºå¥‡æ•°ï¼Œæ‰èƒ½ä¿è¯å®ç°å¯¹ç§°å¡«å……(4å‘¨å¡«å……æ•°ç›¸åŒ)ï¼Œä¸ç„¶ä¼šå‡ºç°ä¸å¯¹ç§°å¡«å……ï¼ˆå·¦è¾¹å¤šå³è¾¹å°‘ï¼‰<br>å¦å¤–å¥‡æ•°è¿‡æ»¤å™¨ä¸ºå¥‡æ•°ï¼Œä¼šå­˜åœ¨ä¸­å¿ƒç‚¹ï¼Œæ–¹ä¾¿å®šä½è¿‡æ»¤å™¨ä½ç½®<br><img src="/image/deepLearning/117.png" alt></p>
<h3 id="stride"><a href="#stride" class="headerlink" title="stride"></a>stride</h3><p>stride è¡¨ç¤ºå·ç§¯æ ¸åœ¨å›¾åƒä¸Šæ»‘åŠ¨çš„æ­¥é•¿ï¼Œé»˜è®¤å€¼ä¸º1ï¼Œè¡¨ç¤ºæ¯æ¬¡æ»‘åŠ¨ä¸€ä¸ªåƒç´ <br>å¦‚æœstride ä¸º2ï¼Œè¡¨ç¤ºæ¯æ¬¡æ»‘åŠ¨2ä¸ªåƒç´ ï¼Œè¿™æ ·å¯ä»¥å‡å°‘è®¡ç®—é‡ï¼ŒåŒæ—¶å¯ä»¥å‡å°‘è¾“å‡ºå›¾åƒçš„å¤§å°<br>è¾“å‡ºå›¾åƒçš„å¤§å°è®¡ç®—å…¬å¼ä¸º math.floor((n + 2p - f) / stride) + 1</p>
<p><img src="/image/deepLearning/118.png" alt></p>
<h3 id="ä¸‰ç»´è®¡ç®—"><a href="#ä¸‰ç»´è®¡ç®—" class="headerlink" title="ä¸‰ç»´è®¡ç®—"></a>ä¸‰ç»´è®¡ç®—</h3><p>ä¸Šé¢è®¨è®ºçš„æ˜¯åœ¨ä¸€å¼ ç°åº¦å›¾ç‰‡ä¸Šçš„è®¡ç®—ï¼Œå¦‚æœæ˜¯å½©è‰²å›¾ç‰‡ï¼Œé‚£ä¹ˆéœ€è¦å¯¹å›¾ç‰‡çš„æ¯ä¸ªé€šé“è¿›è¡Œå·ç§¯è®¡ç®—ï¼Œ<br>ç„¶åå°†æ¯ä¸ªé€šé“çš„å·ç§¯ç»“æœç›¸åŠ ï¼Œå¾—åˆ°æœ€ç»ˆçš„è¾“å‡ºå›¾åƒ<br>æœ€ç»ˆè¾“å…¥å›¾ç‰‡å¤§å°åŒä¸Šï¼Œä¸º (n-f+1) x (n-f+1)<br>ä½†æ˜¯è¦ä¿è¯è¾“å…¥å›¾ç‰‡çš„é€šé“æ•°å’Œå·ç§¯æ ¸çš„é€šé“æ•°ç›¸åŒï¼Œå¦åˆ™æ— æ³•è¿›è¡Œå·ç§¯è®¡ç®—<br><img src="/image/deepLearning/119.png" alt><br>å¦‚æœåŒæ—¶å¯¹å›¾ç‰‡è¿›è¡Œå¤šä¸ªé€šé“ï¼Œå¤šä¸ªè¿‡æ»¤å™¨çš„è®¡ç®—ï¼Œ<br>é‚£ä¹ˆè¾“å‡ºå›¾ç‰‡ç»´åº¦éœ€è¦åŠ ä¸Šè¿‡æ»¤å™¨çš„ä¸ªæ•°ï¼Œç›¸å½“äºä¸€å¼ è¿‡æ»¤å™¨äº§ç”Ÿä¸€ä¸ªé€šé“<br>è¾“å‡ºå›¾ç‰‡çš„å¤§å°ä¸º (n-f+1) x (n-f+1) x è¿‡æ»¤å™¨çš„ä¸ªæ•°<br><img src="/image/deepLearning/120.png" alt></p>
<h1 id="å·ç§¯å±‚"><a href="#å·ç§¯å±‚" class="headerlink" title="å·ç§¯å±‚"></a>å·ç§¯å±‚</h1><p>ä¹‹å‰çš„ç¥ç»ç½‘ç»œï¼Œè¾“å…¥x å’Œ w éƒ½æ˜¯å…·ä½“çš„ä¸€ä¸ªæ•°å­—ï¼Œç°åœ¨ç›¸å½“ä¹‹äºx å’Œ w æ˜¯ä¸€ä¸ªä¸‰ç»´çŸ©é˜µ<br>æœ‰å‡ ä¸ªè¿‡æ»¤å™¨ï¼Œç›¸å½“äºæœ‰å‡ ä¸ªç¥ç»å…ƒï¼Œæ¯ä¸ªç¥ç»å…ƒçš„è¾“å…¥æ˜¯ä¸€ä¸ªä¸‰ç»´çŸ©é˜µï¼Œ<br>æ¯ä¸ªç¥ç»å…ƒçš„wæ˜¯ä¸€ä¸ªå’Œä¸Šä¸€å±‚è¾“å…¥æ·±åº¦ç›¸åŒçš„ä¸‰ç»´çŸ©é˜µ, b ä¹Ÿæ˜¯ä¸€ä¸ªå’Œä¸Šä¸€å±‚è¾“å…¥æ·±åº¦ç›¸åŒçš„ä¸‰ç»´çŸ©é˜µ<br>è¿™æ ·æ¯ä¸ªç¥ç»å…ƒè®¡ç®—ç»“æœå°±æ˜¯ä¸€ä¸ª2ç»´çŸ©é˜µï¼Œ<br>å¤šä¸ªç¥ç»å…ƒçš„è®¡ç®—ç»“æœå°±æ˜¯ä¸€ä¸ªä¸‰ç»´çŸ©é˜µï¼Œç›¸å½“äºå¤šä¸ªé€šé“çš„å›¾ç‰‡</p>
<h2 id="å•å±‚çš„å®ç°åŸç†"><a href="#å•å±‚çš„å®ç°åŸç†" class="headerlink" title="å•å±‚çš„å®ç°åŸç†"></a>å•å±‚çš„å®ç°åŸç†</h2><p><img src="/image/deepLearning/121.png" alt><br>ç›¸å…³ç¬¦å·è¡¨ç¤º<br><img src="/image/deepLearning/122.png" alt></p>
<h2 id="å·ç§¯å±‚çš„å®ç°"><a href="#å·ç§¯å±‚çš„å®ç°" class="headerlink" title="å·ç§¯å±‚çš„å®ç°"></a>å·ç§¯å±‚çš„å®ç°</h2><p><img src="/image/deepLearning/123.png" alt></p>
<h1 id="æ± åŒ–å±‚"><a href="#æ± åŒ–å±‚" class="headerlink" title="æ± åŒ–å±‚"></a>æ± åŒ–å±‚</h1><p>å‡å°æ¨¡å‹è§„æ¨¡ï¼Œæé«˜è®¡ç®—é€Ÿåº¦<br>ç±»ä¼¼ä¸å·ç§¯å±‚ï¼Œåªä¸è¿‡åœ¨è¿‡æ»¤å™¨èŒƒå›´å†…ï¼Œä¸å†æ˜¯å·ç§¯è®¡ç®—ï¼Œè€Œæ˜¯å–æœ€å¤§å€¼æˆ–è€…å¹³å‡å€¼<br>ä½†æ˜¯è¦æ³¨æ„ï¼Œæ± åŒ–å±‚çš„è¿‡æ»¤å™¨å¤§å°å’Œæ­¥é•¿æ˜¯å›ºå®šçš„ï¼Œåœ¨æ•´ä¸ªç¥ç»ç½‘ç»œä¸­å±äºé™æ€å±æ€§ï¼Œä¸å‚ä¸æ¢¯åº¦ä¸‹é™è¿ç®—<br><img src="/image/deepLearning/124.png" alt><br><img src="/image/deepLearning/125.png" alt><br><img src="/image/deepLearning/126.png" alt></p>
<h1 id="å·ç§¯ç¥ç»ç½‘ç»œ"><a href="#å·ç§¯ç¥ç»ç½‘ç»œ" class="headerlink" title="å·ç§¯ç¥ç»ç½‘ç»œ"></a>å·ç§¯ç¥ç»ç½‘ç»œ</h1><p>ä¸Šé¢æåˆ°äº†å·ç§¯å±‚å’Œæ± åŒ–å±‚ï¼Œå·ç§¯ç¥ç»ç½‘ç»œçš„æœ€åä¸€å±‚å«åšå…¨è¿æ¥å±‚<br>ç›¸å½“äºä¹‹å‰çš„æ ‡å‡†ç¥ç»ç½‘ç»œï¼Œå°†å·ç§¯å±‚å’Œæ± åŒ–å±‚çš„è¾“å‡ºç»“æœè¿›è¡Œå±•å¹³ï¼Œç„¶åè¿›è¡Œå…¨è¿æ¥è®¡ç®—<br><img src="/image/deepLearning/127.png" alt><br>éšç€å·ç§¯æ± åŒ–å±‚çš„å¢åŠ ï¼Œå›¾ç‰‡å°ºå¯¸ä¼šè¶Šæ¥è¶Šå°ï¼Œä½†æ˜¯é€šé“è¶Šæ¥å¤š<br>æ± åŒ–å±‚æ²¡æœ‰å­¦ä¹ å‚æ•°ï¼Œå·ç§¯å±‚å¯å­¦ä¹ å‚æ•°è¿œå°äºå…¨è¿æ¥å±‚<br>è€Œä¸”éšç€å·ç§¯ç¥ç»ç½‘ç»œçš„å‘åè®¡ç®—ï¼Œæ¿€æ´»å€¼æ•°æ®é€æ¸å‡å°‘<br><img src="/image/deepLearning/128.png" alt></p>
<h2 id="ä¼˜ç‚¹"><a href="#ä¼˜ç‚¹" class="headerlink" title="ä¼˜ç‚¹"></a>ä¼˜ç‚¹</h2><blockquote>
<p>Parameter sharing: A feature detector (such as a vertical edge detector) thatâ€™s useful in one part of the image is probably useful in another part of the image.<br>Sparsity of connections: In each layer, each output value<br>depends only on a small number of inputs.</p>
</blockquote>
<ol>
<li>å‚æ•°å…±äº«ï¼Œä»è€Œå‡å°‘å‚æ•°æ•°é‡</li>
<li>ç»“æœè¾“å‡ºä»…ä¾èµ–è¾“å…¥çš„éƒ¨åˆ†æ•°æ®ï¼Œè®¡ç®—é€Ÿåº¦å¿«</li>
</ol>
<p><img src="/image/deepLearning/129.png" alt></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://yoohannah.github.io/post/deepLearning/HyperparameterTuning.html">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="YooHannah">
    <meta itemprop="description" content>
    <meta itemprop="image" content="/psb.jpg">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="My Little World">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="My Little World" src>
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/post/deepLearning/HyperparameterTuning.html" itemprop="url">
                  è¶…å‚æ•°è°ƒä¼˜
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2025-01-31T21:26:37+08:00">
                2025-01-31
              </time>
            

            

            
          </span>

          

          
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="è¶…å‚æ•°å¦‚ä½•å–å€¼"><a href="#è¶…å‚æ•°å¦‚ä½•å–å€¼" class="headerlink" title="è¶…å‚æ•°å¦‚ä½•å–å€¼"></a>è¶…å‚æ•°å¦‚ä½•å–å€¼</h1><h2 id="ç›´æ¥è°ƒä¼˜"><a href="#ç›´æ¥è°ƒä¼˜" class="headerlink" title="ç›´æ¥è°ƒä¼˜"></a>ç›´æ¥è°ƒä¼˜</h2><p>æ ¹æ®ç»éªŒå¯¹äºè¶…å‚æ•°çš„é‡è¦æ€§è¿›è¡Œæ’åº</p>
<ol>
<li>å­¦ä¹ ç‡</li>
<li>momentum çš„Î²ï¼ˆ~0.9ï¼‰;éšè—å±‚çš„ç¥ç»å…ƒæ•°é‡;mini batch size</li>
<li>éšè—å±‚çš„æ•°é‡ï¼›å­¦ä¹ ç‡çš„è¡°å‡ç‡</li>
<li>adam çš„Î²1ï¼ˆ~0.9ï¼‰ï¼ŒÎ²2ï¼ˆ~0.999ï¼‰Î£ï¼ˆ10^-8ï¼‰è¿™ä¸‰è€…ä¸€èˆ¬å›ºå®šï¼Œå¾ˆå°‘éœ€è¦è°ƒè¯•</li>
</ol>
<p>æ•°å€¼é€‰æ‹©ä¸Šéµå¾ªéšæœºå–å€¼å’Œç²¾ç¡®æœç´¢çš„åŸåˆ™<br>éšæœºå–å€¼å¯ä»¥å¿«é€Ÿæ‰¾åˆ°å½±å“è¾ƒå¤§çš„è¶…å‚æ•°ï¼Œç¡®å®šèŒƒå›´åï¼Œç²¾ç¡®æœç´¢å¯ä»¥è¿›ä¸€æ­¥ä¼˜åŒ–è¶…å‚æ•°ï¼Œç”±ç²—ç³™åˆ°ç²¾ç»†</p>
<p><img src="/image/deepLearning/78.png" alt><br><img src="/image/deepLearning/79.png" alt><br><img src="/image/deepLearning/80.png" alt></p>
<h2 id="å€Ÿé‰´å·²æœ‰å…¶ä»–é¢†åŸŸæ¨¡å‹ï¼Œå¤ç”¨å…¶å‚æ•°è¿›è¡Œæµ‹è¯•è¯„ä¼°"><a href="#å€Ÿé‰´å·²æœ‰å…¶ä»–é¢†åŸŸæ¨¡å‹ï¼Œå¤ç”¨å…¶å‚æ•°è¿›è¡Œæµ‹è¯•è¯„ä¼°" class="headerlink" title="å€Ÿé‰´å·²æœ‰å…¶ä»–é¢†åŸŸæ¨¡å‹ï¼Œå¤ç”¨å…¶å‚æ•°è¿›è¡Œæµ‹è¯•è¯„ä¼°"></a>å€Ÿé‰´å·²æœ‰å…¶ä»–é¢†åŸŸæ¨¡å‹ï¼Œå¤ç”¨å…¶å‚æ•°è¿›è¡Œæµ‹è¯•è¯„ä¼°</h2><h2 id="æ ¹æ®è®¡ç®—èƒ½åŠ›é€‰æ‹©è°ƒè¯•æ–¹å¼"><a href="#æ ¹æ®è®¡ç®—èƒ½åŠ›é€‰æ‹©è°ƒè¯•æ–¹å¼" class="headerlink" title="æ ¹æ®è®¡ç®—èƒ½åŠ›é€‰æ‹©è°ƒè¯•æ–¹å¼"></a>æ ¹æ®è®¡ç®—èƒ½åŠ›é€‰æ‹©è°ƒè¯•æ–¹å¼</h2><p>1ï¼Œå¦‚æœè®¡ç®—èƒ½åŠ›æœ‰é™ï¼Œä¸€æ¬¡è¿›è¡Œä¸€ä¸ªæ¨¡å‹çš„è®­ç»ƒè°ƒè¯•ï¼Œç”¨æ—¶é—´æ¢å–æ•ˆæœ<br>2ï¼Œå¦‚æœè®¡ç®—èƒ½åŠ›å……è¶³ï¼Œä¸€æ¬¡åŒæ—¶è¿›è¡Œå¤šä¸ªæ¨¡å‹çš„ä¸åŒè¶…å‚è®­ç»ƒè°ƒè¯•ï¼Œç”¨å¹¶è¡Œæ¢å–æ—¶é—´</p>
<h1 id="batchå½’ä¸€åŒ–å¤„ç†"><a href="#batchå½’ä¸€åŒ–å¤„ç†" class="headerlink" title="batchå½’ä¸€åŒ–å¤„ç†"></a>batchå½’ä¸€åŒ–å¤„ç†</h1><p>åŸºäºå¯¹è¾“å…¥æ ·æœ¬æ•°æ®è¿›è¡Œå½’ä¸€åŒ–å¤„ç†å¯åŠ é€Ÿç®—æ³•è®­ç»ƒå­¦ä¹ çš„åŸç†ï¼Œå¯¹éšå±‚çš„è¾“å…¥æ•°æ®ä¹ŸåŒæ ·è¿›è¡Œå½’ä¸€åŒ–å¤„ç†ï¼Œ<br>å¯ä»¥é™ä½å‰ä¸€å±‚çš„æ•°æ®è®¡ç®—ç»“æŸå˜åŠ¨å¯¹åä¸€å±‚è®¡ç®—çš„å½±å“ï¼Œé™ä½å‰åå±‚çš„è”ç³»ï¼Œæ¯ä¸€å±‚éƒ½å¯ä»¥ç‹¬ç«‹å­¦ä¹ ï¼Œä»è€ŒåŠ é€Ÿç®—æ³•çš„è®­ç»ƒé€Ÿåº¦<br><img src="/image/deepLearning/81.png" alt><br><img src="/image/deepLearning/82.png" alt><br><img src="/image/deepLearning/83.png" alt><br><img src="/image/deepLearning/84.png" alt><br><img src="/image/deepLearning/85.png" alt><br><img src="/image/deepLearning/86.png" alt></p>
<h1 id="Softmax-regression"><a href="#Softmax-regression" class="headerlink" title="Softmax regression"></a>Softmax regression</h1><p>Softmax ç®—æ³•æ˜¯ä¸€ç§ç”¨äºå¤šåˆ†ç±»ä»»åŠ¡çš„å‡½æ•°ï¼Œé€šå¸¸åº”ç”¨äºç¥ç»ç½‘ç»œçš„è¾“å‡ºå±‚ï¼Œä»¥å°†ç½‘ç»œçš„è¾“å‡ºè½¬æ¢ä¸ºæ¦‚ç‡åˆ†å¸ƒã€‚<br>å®ƒå¯ä»¥å°†ä¸€ä¸ªæœªå½’ä¸€åŒ–çš„å‘é‡ï¼ˆå³åŸå§‹çš„ç½‘ç»œè¾“å‡ºï¼‰è½¬æ¢ä¸ºä¸€ä¸ªå½’ä¸€åŒ–çš„æ¦‚ç‡åˆ†å¸ƒï¼Œä½¿å¾—æ¯ä¸ªç±»åˆ«çš„æ¦‚ç‡å€¼åœ¨ 0 åˆ° 1 ä¹‹é—´ï¼Œå¹¶ä¸”æ‰€æœ‰ç±»åˆ«çš„æ¦‚ç‡å’Œä¸º 1ã€‚<br><img src="/image/deepLearning/87.png" alt></p>
<h1 id="TensorFlow-æ¡†æ¶å­¦ä¹ "><a href="#TensorFlow-æ¡†æ¶å­¦ä¹ " class="headerlink" title="TensorFlow æ¡†æ¶å­¦ä¹ "></a>TensorFlow æ¡†æ¶å­¦ä¹ </h1><p><img src="/image/deepLearning/88.png" alt></p>
<blockquote>
<p>What you should remember: - Tensorflow is a programming framework used in deep learning - The two main object classes in tensorflow are Tensors and Operators. - When you code in tensorflow you have to take the following steps: - Create a graph containing Tensors (Variables, Placeholders â€¦) and Operations (tf.matmul, tf.add, â€¦) - Create a session - Initialize the session - Run the session to execute the graph - You can execute the graph multiple times as youâ€™ve seen in model() - The backpropagation and optimization is automatically done when running the session on the â€œoptimizerâ€ object.</p>
</blockquote>
<p><a href="https://github.com/YooHannah/algorithm/blob/master/deeplearning/TensorFlow/index.py" target="_blank" rel="noopener">å®éªŒ</a><br><a href="https://github.com/GeeeekExplorer/AndrewNg-Deep-Learning/blob/master/Improving%20Deep%20Neural%20Networks%20Hyperparameter%20tuning%2C%20Regularization%20and%20Optimization/week7/TensorFlow%20Tutorial%20Solution.ipynb" target="_blank" rel="noopener">ç»ƒä¹ ä»£ç </a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://yoohannah.github.io/post/deepLearning/OptGradientDescent.html">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="YooHannah">
    <meta itemprop="description" content>
    <meta itemprop="image" content="/psb.jpg">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="My Little World">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="My Little World" src>
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/post/deepLearning/OptGradientDescent.html" itemprop="url">
                  ä¸€äº›ä¼˜åŒ–æ¢¯åº¦ä¸‹é™çš„æ–¹æ³•
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2025-01-31T14:57:37+08:00">
                2025-01-31
              </time>
            

            

            
          </span>

          

          
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="å°æ‰¹é‡æ¢¯åº¦ä¸‹é™ç®—æ³•"><a href="#å°æ‰¹é‡æ¢¯åº¦ä¸‹é™ç®—æ³•" class="headerlink" title="å°æ‰¹é‡æ¢¯åº¦ä¸‹é™ç®—æ³•"></a>å°æ‰¹é‡æ¢¯åº¦ä¸‹é™ç®—æ³•</h1><p>åœ¨å•è½®è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œä¸å†ä¸€æ¬¡ä»è®¡ç®—æ•´ä¸ªè®­ç»ƒæ•°æ®ï¼Œå°†æ•´ä¸ªè®­ç»ƒæ•°æ®åˆ†æ‰¹è¿›è¡Œè®­ç»ƒï¼Œæ¯æ‰¹ï¼ˆepochï¼‰è®­ç»ƒçš„æ ·æœ¬æ•°ç§°ä¸ºbatch size</p>
<p>batch size æœ€å¤§ç­‰äºæ•´ä¸ªè®­ç»ƒæ ·æœ¬æ•°mæ—¶ï¼Œç›¸å½“äºè¿›è¡Œä¸€æ¬¡æ‰¹é‡è¿ç®—ï¼Œå°±æ˜¯æ ‡å‡†çš„æ‰¹é‡æ¢¯åº¦ä¸‹é™ç®—æ³•,<br>éœ€è¦è®¡ç®—å®ŒåŸºäºæ•´ä¸ªè®­ç»ƒæ ·æœ¬å‚æ•°å’ŒæŸå¤±å‡½æ•°ï¼ŒèŠ±è´¹æ—¶é—´è¾ƒé•¿ï¼Œç„¶åæ‰èƒ½è¿›è¡Œæ¢¯åº¦ä¸‹é™è®¡ç®—</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"># (Batch) Gradient Descent:</span><br><span class="line">X = data_input</span><br><span class="line">Y = labels</span><br><span class="line">parameters = initialize_parameters(layers_dims)</span><br><span class="line">for i in range(0, num_iterations):</span><br><span class="line">    # Forward propagation</span><br><span class="line">    a, caches = forward_propagation(X, parameters)</span><br><span class="line">    # Compute cost.</span><br><span class="line">    cost += compute_cost(a, Y)</span><br><span class="line">    # Backward propagation.</span><br><span class="line">    grads = backward_propagation(a, caches, parameters)</span><br><span class="line">    # Update parameters.</span><br><span class="line">    parameters = update_parameters(parameters, grads)</span><br></pre></td></tr></table></figure>
<p>batch size æœ€å°ç­‰äº1æ—¶ï¼Œå°±æ˜¯ä¸€ä¸ªæ‰¹æ¬¡å¤„ç†ä¸€ä¸ªæ•°æ®, é€Ÿåº¦å¿«ï¼Œä½†æ˜¯æ²¡æ³•åˆ©ç”¨å‘é‡åŠ é€Ÿæ¢¯åº¦ä¸‹é™ï¼Œä¹Ÿç§°ä¸ºéšæœºæ¢¯åº¦ä¸‹é™ç®—æ³•Stochastic Gradient Descent:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"># Stochastic Gradient Descent:</span><br><span class="line">X = data_input</span><br><span class="line">Y = labels</span><br><span class="line">parameters = initialize_parameters(layers_dims)</span><br><span class="line">for i in range(0, num_iterations):</span><br><span class="line">    for j in range(0, m):</span><br><span class="line">        # Forward propagation</span><br><span class="line">        a, caches = forward_propagation(X[:,j], parameters) # X[:,j] ä»måˆ—ä¸­ï¼Œæ¯æ¬¡å–ä¸€åˆ—ï¼Œå°±æ˜¯ä¸€ä¸ªæ ·æœ¬</span><br><span class="line">        # Compute cost</span><br><span class="line">        cost += compute_cost(a, Y[:,j])</span><br><span class="line">        # Backward propagation</span><br><span class="line">        grads = backward_propagation(a, caches, parameters)</span><br><span class="line">        # Update parameters.</span><br><span class="line">        parameters = update_parameters(parameters, grads)</span><br></pre></td></tr></table></figure></p>
<p>å½“batch size ä»‹äº1å’Œmä¹‹é—´æ—¶ï¼Œå°±æ˜¯å°æ‰¹é‡æ¢¯åº¦ä¸‹é™ç®—æ³•Mini-batch Gradient Descent<br>å°æ‰¹é‡æ¢¯åº¦ä¸‹é™å¤„ç†æ•°æ®åˆ†ä¸¤æ­¥ï¼Œ<br>ä¸€æ­¥æ˜¯æ··æ´—æ•°æ®ï¼Œå°†æ•°æ®é›†é¡ºåºæ‰“ä¹±ï¼Œä½†ä¿è¯X(i) å’Œ Yï¼ˆiï¼‰æ˜¯ä¸€ä¸€å¯¹åº”çš„<br>ç¬¬äºŒæ­¥æ˜¯å°†æ•°æ®åˆ†æˆå¤šä¸ªbatchï¼Œæ¯ä¸ªbatchåŒ…å«batch size ä¸ªæ ·æœ¬ï¼Œéœ€è¦æ³¨æ„å¦‚æœm ä¸èƒ½æ•´é™¤batch sizeï¼Œæœ€åä¸€ä¸ªbatch æ˜¯ä¸è¶³batch size ä¸ªæ ·æœ¬ï¼Œéœ€è¦å•ç‹¬å¤„ç†</p>
<blockquote>
<p>Shuffling and Partitioning are the two steps required to build mini-batches -<br>Powers of two are often chosen to be the mini-batch size, e.g., 16, 32, 64, 128.</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"># GRADED FUNCTION: random_mini_batches</span><br><span class="line"></span><br><span class="line">def random_mini_batches(X, Y, mini_batch_size = 64, seed = 0):</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">    Creates a list of random minibatches from (X, Y)</span><br><span class="line">    </span><br><span class="line">    Arguments:</span><br><span class="line">    X -- input data, of shape (input size, number of examples)</span><br><span class="line">    Y -- true &quot;label&quot; vector (1 for blue dot / 0 for red dot), of shape (1, number of examples)</span><br><span class="line">    mini_batch_size -- size of the mini-batches, integer</span><br><span class="line">    </span><br><span class="line">    Returns:</span><br><span class="line">    mini_batches -- list of synchronous (mini_batch_X, mini_batch_Y)</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">    </span><br><span class="line">    np.random.seed(seed)            # To make your &quot;random&quot; minibatches the same as ours</span><br><span class="line">    m = X.shape[1]                  # number of training examples</span><br><span class="line">    mini_batches = []</span><br><span class="line">        </span><br><span class="line">    # Step 1: Shuffle (X, Y)</span><br><span class="line">    permutation = list(np.random.permutation(m))</span><br><span class="line">    shuffled_X = X[:, permutation]</span><br><span class="line">    shuffled_Y = Y[:, permutation].reshape((1,m))</span><br><span class="line"></span><br><span class="line">    # Step 2: Partition (shuffled_X, shuffled_Y). Minus the end case.</span><br><span class="line">    num_complete_minibatches = math.floor(m/mini_batch_size) # number of mini batches of size mini_batch_size in your partitionning</span><br><span class="line">    for k in range(0, num_complete_minibatches):</span><br><span class="line">        mini_batch_X = shuffled_X[:, k * mini_batch_size : (k + 1) * mini_batch_size]</span><br><span class="line">        mini_batch_Y = shuffled_Y[:, k * mini_batch_size : (k + 1) * mini_batch_size]</span><br><span class="line">        mini_batch = (mini_batch_X, mini_batch_Y)</span><br><span class="line">        mini_batches.append(mini_batch)</span><br><span class="line">    </span><br><span class="line">    # Handling the end case (last mini-batch &lt; mini_batch_size)</span><br><span class="line">    if m % mini_batch_size != 0:</span><br><span class="line">        ### START CODE HERE ### (approx. 2 lines)</span><br><span class="line">        mini_batch_X = shuffled_X[:, num_complete_minibatches * mini_batch_size :]</span><br><span class="line">        mini_batch_Y = shuffled_Y[:, num_complete_minibatches * mini_batch_size :]</span><br><span class="line">        ### END CODE HERE ###</span><br><span class="line">        mini_batch = (mini_batch_X, mini_batch_Y)</span><br><span class="line">        mini_batches.append(mini_batch)</span><br><span class="line">    </span><br><span class="line">    return mini_batches</span><br></pre></td></tr></table></figure>
<p>è¿­ä»£è¿‡ç¨‹å¤„ç†çš„æ•°æ®é›†å°±æ˜¯ä¸Šé¢åˆ†æ‰¹å¥½çš„mini_batches</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">mini_batches = random_mini_batches(X, Y, mini_batch_size = 64, seed = 0)</span><br><span class="line">t =  math.floor(m/mini_batch_size)</span><br><span class="line">if m % mini_batch_size != 0</span><br><span class="line">  t+=1</span><br><span class="line">for i in range(0, num_iterations):</span><br><span class="line">    for j in range(0, t):</span><br><span class="line">        # Forward propagation</span><br><span class="line">        a, caches = forward_propagation(mini_batches[j][0], parameters) # å–ä¸€æ‰¹è®¡ç®—ä¸€æ‰¹ï¼Œä¸ç”¨æ•´ä¸ªè®¡ç®—å®Œå†æ›´æ–°æ¢¯åº¦</span><br><span class="line">        # Compute cost</span><br><span class="line">        cost += compute_cost(a, mini_batches[j][1])</span><br><span class="line">        # Backward propagation</span><br><span class="line">        grads = backward_propagation(a, caches, parameters)</span><br><span class="line">        # Update parameters.</span><br><span class="line">        parameters = update_parameters(parameters, grads)</span><br></pre></td></tr></table></figure>
<blockquote>
<p>The difference between gradient descent, mini-batch gradient descent and stochastic gradient descent is the number of examples you use to perform one update step. - You have to tune a learning rate hyperparameter  ğ›¼ . - With a well-turned mini-batch size, usually it outperforms either gradient descent or stochastic gradient descent (particularly when the training set is large).</p>
</blockquote>
<p><img src="/image/deepLearning/65.png" alt><br><img src="/image/deepLearning/66.png" alt><br><img src="/image/deepLearning/67.png" alt><br><img src="/image/deepLearning/68.png" alt></p>
<h1 id="momentum"><a href="#momentum" class="headerlink" title="momentum"></a>momentum</h1><h2 id="æŒ‡æ•°åŠ æƒå¹³å‡"><a href="#æŒ‡æ•°åŠ æƒå¹³å‡" class="headerlink" title="æŒ‡æ•°åŠ æƒå¹³å‡"></a>æŒ‡æ•°åŠ æƒå¹³å‡</h2><p>æŒ‡æ•°åŠ æƒå¹³å‡ï¼ˆExponential Weighted Moving Average, EWMAï¼‰æ˜¯ä¸€ç§ç”¨äºå¹³æ»‘æ—¶é—´åºåˆ—æ•°æ®çš„æŠ€æœ¯ã€‚<br>å®ƒé€šè¿‡å¯¹æ•°æ®ç‚¹èµ‹äºˆä¸åŒçš„æƒé‡æ¥è®¡ç®—å¹³å‡å€¼ï¼Œè¾ƒæ–°çš„æ•°æ®ç‚¹æƒé‡è¾ƒå¤§ï¼Œè¾ƒæ—§çš„æ•°æ®ç‚¹æƒé‡è¾ƒå°ã€‚<br>è¿™æ ·å¯ä»¥æ›´æ•æ„Ÿåœ°åæ˜ æœ€æ–°æ•°æ®çš„å˜åŒ–ï¼ŒåŒæ—¶ä¿ç•™å†å²æ•°æ®çš„è¶‹åŠ¿ã€‚<br>æŒ‡æ•°åŠ æƒå¹³å‡çš„è®¡ç®—å…¬å¼å¦‚ä¸‹ï¼š</p>
<p>St = Î² <em> St-1 + ï¼ˆ1-Î²ï¼‰ </em> Xt<br>å…¶ä¸­ï¼š<br> Stæ˜¯æ—¶é—´ t æ—¶åˆ»çš„æŒ‡æ•°åŠ æƒå¹³å‡å€¼ã€‚<br> Xtæ˜¯æ—¶é—´ t æ—¶åˆ»çš„å®é™…æ•°æ®å€¼ã€‚<br> Î² æ˜¯å¹³æ»‘å› å­ï¼Œå–å€¼èŒƒå›´åœ¨ 0 åˆ° 1 ä¹‹é—´ã€‚è¾ƒå¤§çš„  å€¼ä½¿å¾— EWMA å¯¹æœ€æ–°æ•°æ®æ›´æ•æ„Ÿï¼Œè¾ƒå°çš„  å€¼åˆ™ä½¿å¾— EWMA æ›´å¹³æ»‘ã€‚<br> St-1æ˜¯æ—¶é—´ t-1 æ—¶åˆ»çš„æŒ‡æ•°åŠ æƒå¹³å‡å€¼ã€‚<br>è§£é‡Š<br>åˆå§‹å€¼ï¼šé€šå¸¸ï¼Œåˆå§‹çš„æŒ‡æ•°åŠ æƒå¹³å‡å€¼ S0  å¯ä»¥è®¾ç½®ä¸ºç¬¬ä¸€ä¸ªæ•°æ®ç‚¹ X0 ã€‚<br>é€’å½’è®¡ç®—ï¼šæ¯ä¸ªæ–°çš„æ•°æ®ç‚¹éƒ½ä¼šæ›´æ–° EWMAï¼Œæ–°çš„ EWMA æ˜¯å½“å‰æ•°æ®ç‚¹å’Œå‰ä¸€ä¸ª EWMA çš„åŠ æƒå’Œã€‚<br>å¹³æ»‘å› å­ ï¼šå†³å®šäº†æ–°æ•°æ®ç‚¹å’Œå†å²æ•°æ®å¯¹å½“å‰ EWMA çš„å½±å“ç¨‹åº¦ã€‚è¾ƒå¤§çš„  å€¼ä¼šä½¿å¾— EWMA å¯¹æ–°æ•°æ®ç‚¹å˜åŒ–æ›´æ•æ„Ÿï¼Œè¾ƒå°çš„  å€¼ä¼šä½¿å¾— EWMA æ›´å¹³æ»‘ï¼Œå—å†å²æ•°æ®å½±å“æ›´å¤§ã€‚</p>
<h3 id="åå·®ä¿®æ­£"><a href="#åå·®ä¿®æ­£" class="headerlink" title="åå·®ä¿®æ­£"></a>åå·®ä¿®æ­£</h3><p>åœ¨è®¡ç®— EWMA æ—¶ï¼Œåˆå§‹å€¼çš„é€‰æ‹©å¯¹åç»­è®¡ç®—çš„å½±å“è¾ƒå¤§ã€‚ç‰¹åˆ«æ˜¯åœ¨æ•°æ®åºåˆ—çš„åˆå§‹é˜¶æ®µï¼Œ<br>ç”±äºç¼ºä¹è¶³å¤Ÿçš„å†å²æ•°æ®ï¼Œè®¡ç®—çš„å¹³å‡å€¼å¯èƒ½ä¼šåç¦»çœŸå®å€¼ã€‚<br>å› æ­¤ï¼Œéœ€è¦å¯¹åˆå§‹é˜¶æ®µçš„è®¡ç®—ç»“æœè¿›è¡Œä¿®æ­£ï¼Œä»¥å‡å°è¿™ç§åå·®ã€‚<br>ä¸ºäº†è¿›è¡Œåå·®ä¿®æ­£ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å…¬å¼ï¼š<br>St^ = St / (1 - Î²^t)<br>å…¶ä¸­ï¼š<br>St^æ˜¯ç»è¿‡åå·®ä¿®æ­£çš„æ—¶é—´ t æ—¶åˆ»çš„æŒ‡æ•°åŠ æƒå¹³å‡å€¼ã€‚<br>Stæ˜¯æ—¶é—´ t æ—¶åˆ»çš„æœªä¿®æ­£çš„æŒ‡æ•°åŠ æƒå¹³å‡å€¼ã€‚<br>tæ˜¯æ—¶é—´æ­¥æ•°ï¼Œä»1 å¼€å§‹ï¼Œå®ƒæ˜¯Î²^t æ˜¯æŒ‡Î²çš„ t æ¬¡æ–¹ã€‚<br>é€šè¿‡å¯¹åˆå§‹å€¼è¿›è¡Œä¿®æ­£ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ EWMA åœ¨åˆå§‹é˜¶æ®µæ›´æ¥è¿‘çœŸå®å€¼ï¼Œä»è€Œå‡å°‘åå·®ã€‚<br>ä¿®æ­£åçš„ EWMA å¯ä»¥å¸®åŠ©æˆ‘ä»¬æ›´å‡†ç¡®åœ°åæ˜ æ•°æ®çš„è¶‹åŠ¿å’Œå˜åŒ–ã€‚</p>
<h2 id="momentum-1"><a href="#momentum-1" class="headerlink" title="momentum"></a>momentum</h2><p>momentum æ˜¯ä¸€ç§ä¼˜åŒ–ç®—æ³•ï¼Œç”¨äºåŠ é€Ÿæ¢¯åº¦ä¸‹é™è¿‡ç¨‹ã€‚å®ƒé€šè¿‡å¼•å…¥åŠ¨é‡ï¼ˆmomentumï¼‰çš„æ¦‚å¿µæ¥åŠ é€Ÿå‚æ•°çš„æ›´æ–°ã€‚<br>åœ¨æ¯æ¬¡è¿­ä»£ä¸­ï¼Œmomentum ä¼šè€ƒè™‘ä¸Šä¸€æ¬¡è¿­ä»£çš„æ¢¯åº¦æ–¹å‘ï¼Œå¹¶æ ¹æ®åŠ¨é‡çš„å¤§å°æ¥è°ƒæ•´å½“å‰çš„æ¢¯åº¦æ–¹å‘ã€‚<br>è¿™æ ·å¯ä»¥åœ¨æ¢¯åº¦ä¸‹é™çš„è¿‡ç¨‹ä¸­ï¼Œæ›´åŠ å¹³æ»‘åœ°æ›´æ–°å‚æ•°ï¼Œä»è€ŒåŠ é€Ÿæ”¶æ•›ã€‚<br>momentum çš„è®¡ç®—å…¬å¼å¦‚ä¸‹ï¼š<br>VdW = Î² <em> VdW + (1 - Î²) </em> dW<br>Vdb = Î² <em> Vdb + (1 - Î²) </em> db<br>W = W - Î± <em> VdW<br>b = b - Î± </em> Vdb<br>å…¶ä¸­ï¼š<br>VdWæ˜¯æƒé‡å‚æ•°Wçš„åŠ¨é‡ã€‚<br>Vdbæ˜¯åç½®å‚æ•°bçš„åŠ¨é‡ã€‚<br>dWæ˜¯æƒé‡å‚æ•°Wçš„æ¢¯åº¦ã€‚<br>dbæ˜¯åç½®å‚æ•°bçš„æ¢¯åº¦ã€‚<br>Î±æ˜¯å­¦ä¹ ç‡ã€‚<br>Î²æ˜¯åŠ¨é‡å› å­ï¼Œé€šå¸¸å–å€¼åœ¨0.9åˆ°0.99ä¹‹é—´ã€‚</p>
<p>ç”±äºå°æ‰¹é‡æ¢¯åº¦ä¸‹é™æ‰€é‡‡ç”¨çš„è·¯å¾„å°†â€œæŒ¯è¡â€è‡³æ”¶æ•›ï¼Œåˆ©ç”¨momentumå¯ä»¥å‡å°‘è¿™äº›æŒ¯è¡ã€‚<br>ï¼ˆå°†VdWï¼Œå¸¦å…¥Wæ›´æ–°å¼å­è®¡ç®—ï¼Œä¼šå‘ç° W ä¸‹é™çš„æ¯”ä¹‹å‰è¦æ…¢ä¸€äº›ï¼Œè´Ÿè´Ÿå¾—æ­£ï¼Œä¼šåŠ å›æ¥-Î² <em> VdW + Î² </em> dWï¼‰<br><img src="/image/deepLearning/70.png" alt><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"># GRADED FUNCTION: initialize_velocity</span><br><span class="line"></span><br><span class="line">def initialize_velocity(parameters):</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">    Initializes the velocity as a python dictionary with:</span><br><span class="line">                - keys: &quot;dW1&quot;, &quot;db1&quot;, ..., &quot;dWL&quot;, &quot;dbL&quot; </span><br><span class="line">                - values: numpy arrays of zeros of the same shape as the corresponding gradients/parameters.</span><br><span class="line">    Arguments:</span><br><span class="line">    parameters -- python dictionary containing your parameters.</span><br><span class="line">                    parameters[&apos;W&apos; + str(l)] = Wl</span><br><span class="line">                    parameters[&apos;b&apos; + str(l)] = bl</span><br><span class="line">    </span><br><span class="line">    Returns:</span><br><span class="line">    v -- python dictionary containing the current velocity.</span><br><span class="line">                    v[&apos;dW&apos; + str(l)] = velocity of dWl</span><br><span class="line">                    v[&apos;db&apos; + str(l)] = velocity of dbl</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">    </span><br><span class="line">    L = len(parameters) // 2 # number of layers in the neural networks</span><br><span class="line">    v = &#123;&#125;</span><br><span class="line">    </span><br><span class="line">    # Initialize velocity</span><br><span class="line">    for l in range(L):</span><br><span class="line">        v[&quot;dW&quot; + str(l+1)] = np.zeros_like(parameters[&quot;W&quot; + str(l+1)])</span><br><span class="line">        v[&quot;db&quot; + str(l+1)] = np.zeros_like(parameters[&quot;b&quot; + str(l+1)])</span><br><span class="line">        </span><br><span class="line">    return v</span><br></pre></td></tr></table></figure></p>
<p><img src="/image/deepLearning/69.png" alt></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"># GRADED FUNCTION: update_parameters_with_momentum</span><br><span class="line"></span><br><span class="line">def update_parameters_with_momentum(parameters, grads, v, beta, learning_rate):</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">    Update parameters using Momentum</span><br><span class="line">    </span><br><span class="line">    Arguments:</span><br><span class="line">    parameters -- python dictionary containing your parameters:</span><br><span class="line">                    parameters[&apos;W&apos; + str(l)] = Wl</span><br><span class="line">                    parameters[&apos;b&apos; + str(l)] = bl</span><br><span class="line">    grads -- python dictionary containing your gradients for each parameters:</span><br><span class="line">                    grads[&apos;dW&apos; + str(l)] = dWl</span><br><span class="line">                    grads[&apos;db&apos; + str(l)] = dbl</span><br><span class="line">    v -- python dictionary containing the current velocity:</span><br><span class="line">                    v[&apos;dW&apos; + str(l)] = ...</span><br><span class="line">                    v[&apos;db&apos; + str(l)] = ...</span><br><span class="line">    beta -- the momentum hyperparameter, scalar</span><br><span class="line">    learning_rate -- the learning rate, scalar</span><br><span class="line">    </span><br><span class="line">    Returns:</span><br><span class="line">    parameters -- python dictionary containing your updated parameters </span><br><span class="line">    v -- python dictionary containing your updated velocities</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line"></span><br><span class="line">    L = len(parameters) // 2 # number of layers in the neural networks</span><br><span class="line">    </span><br><span class="line">    # Momentum update for each parameter</span><br><span class="line">    for l in range(L):</span><br><span class="line">        </span><br><span class="line">        # compute velocities</span><br><span class="line">        v[&quot;dW&quot; + str(l+1)] = beta * v[&quot;dW&quot; + str(l+1)] + (1 - beta) * grads[&quot;dW&quot; + str(l+1)]</span><br><span class="line">        v[&quot;db&quot; + str(l+1)] = beta * v[&quot;db&quot; + str(l+1)] + (1 - beta) * grads[&quot;db&quot; + str(l+1)]</span><br><span class="line">        # update parameters</span><br><span class="line">        parameters[&quot;W&quot; + str(l+1)] -= learning_rate * v[&quot;dW&quot; + str(l+1)]</span><br><span class="line">        parameters[&quot;b&quot; + str(l+1)] -= learning_rate * v[&quot;db&quot; + str(l+1)]</span><br><span class="line">        </span><br><span class="line">    return parameters, v</span><br></pre></td></tr></table></figure>
<blockquote>
<p>Note that:</p>
</blockquote>
<blockquote>
<p>The velocity is initialized with zeros. So the algorithm will take a few iterations to â€œbuild upâ€ velocity and start to take bigger steps.<br>If  ğ›½=0 , then this just becomes standard gradient descent without momentum.<br>How do you choose  ğ›½ ?</p>
</blockquote>
<blockquote>
<p>The larger the momentum  ğ›½  is, the smoother the update because the more we take the past gradients into account. But if  ğ›½  is too big, it could also smooth out the updates too much.<br>Common values for  ğ›½  range from 0.8 to 0.999. If you donâ€™t feel inclined to tune this,  ğ›½=0.9  is often a reasonable default.<br>Tuning the optimal  ğ›½  for your model might need trying several values to see what works best in term of reducing the value of the cost function  ğ½ .</p>
</blockquote>
<blockquote>
<p>Momentum takes past gradients into account to smooth out the steps of gradient descent. It can be applied with batch gradient descent, mini-batch gradient descent or stochastic gradient descent. - You have to tune a momentum hyperparameter  ğ›½  and a learning rate  ğ›¼ .</p>
</blockquote>
<h1 id="Adam"><a href="#Adam" class="headerlink" title="Adam"></a>Adam</h1><h2 id="RMSprop"><a href="#RMSprop" class="headerlink" title="RMSprop"></a>RMSprop</h2><p>Root Mean Square Propagation<br>ç±»ä¼¼æŒ‡æ•°åŠ æƒå¹³å‡ï¼Œåœ¨æ›´æ”¹æ›´æ–°æ¢¯åº¦çš„é€»è¾‘ï¼Œä¸å†ç›´æ¥å‡å»å­¦ä¹ ç‡ä¹˜ä»¥æ¢¯åº¦ï¼Œè€Œæ˜¯å‡å»å­¦ä¹ ç‡ä¹˜ä»¥ä¼˜åŒ–å¤„ç†åçš„æ¢¯åº¦å€¼ï¼Œè¯¦è§å¦‚ä¸‹å…¬å¼<br><img src="/image/deepLearning/71.png" alt></p>
<h2 id="Adam-ä¼˜åŒ–ç®—æ³•"><a href="#Adam-ä¼˜åŒ–ç®—æ³•" class="headerlink" title="Adam ä¼˜åŒ–ç®—æ³•"></a>Adam ä¼˜åŒ–ç®—æ³•</h2><p>ç»“åˆæŒ‡æ•°å¹³å‡å’ŒRMSpropä¸¤ç§ç®—æ³•æ›´æ–°æ¢¯åº¦<br><img src="/image/deepLearning/72.png" alt><br><img src="/image/deepLearning/74.png" alt><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line"># GRADED FUNCTION: initialize_adam</span><br><span class="line"></span><br><span class="line">def initialize_adam(parameters) :</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">    Initializes v and s as two python dictionaries with:</span><br><span class="line">                - keys: &quot;dW1&quot;, &quot;db1&quot;, ..., &quot;dWL&quot;, &quot;dbL&quot; </span><br><span class="line">                - values: numpy arrays of zeros of the same shape as the corresponding gradients/parameters.</span><br><span class="line">    </span><br><span class="line">    Arguments:</span><br><span class="line">    parameters -- python dictionary containing your parameters.</span><br><span class="line">                    parameters[&quot;W&quot; + str(l)] = Wl</span><br><span class="line">                    parameters[&quot;b&quot; + str(l)] = bl</span><br><span class="line">    </span><br><span class="line">    Returns: </span><br><span class="line">    v -- python dictionary that will contain the exponentially weighted average of the gradient.</span><br><span class="line">                    v[&quot;dW&quot; + str(l)] = ...</span><br><span class="line">                    v[&quot;db&quot; + str(l)] = ...</span><br><span class="line">    s -- python dictionary that will contain the exponentially weighted average of the squared gradient.</span><br><span class="line">                    s[&quot;dW&quot; + str(l)] = ...</span><br><span class="line">                    s[&quot;db&quot; + str(l)] = ...</span><br><span class="line"></span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">    </span><br><span class="line">    L = len(parameters) // 2 # number of layers in the neural networks</span><br><span class="line">    v = &#123;&#125;</span><br><span class="line">    s = &#123;&#125;</span><br><span class="line">    </span><br><span class="line">    # Initialize v, s. Input: &quot;parameters&quot;. Outputs: &quot;v, s&quot;.</span><br><span class="line">    for l in range(L):</span><br><span class="line">        v[&quot;dW&quot; + str(l+1)] = np.zeros_like(parameters[&quot;W&quot; + str(l+1)])</span><br><span class="line">        v[&quot;db&quot; + str(l+1)] = np.zeros_like(parameters[&quot;b&quot; + str(l+1)])</span><br><span class="line">        s[&quot;dW&quot; + str(l+1)] = np.zeros_like(parameters[&quot;W&quot; + str(l+1)])</span><br><span class="line">        s[&quot;db&quot; + str(l+1)] = np.zeros_like(parameters[&quot;b&quot; + str(l+1)])</span><br><span class="line">    </span><br><span class="line">    return v, s</span><br><span class="line"></span><br><span class="line"># GRADED FUNCTION: update_parameters_with_adam</span><br><span class="line"></span><br><span class="line">def update_parameters_with_adam(parameters, grads, v, s, t, learning_rate = 0.01,</span><br><span class="line">                                beta1 = 0.9, beta2 = 0.999,  epsilon = 1e-8):</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">    Update parameters using Adam</span><br><span class="line">    </span><br><span class="line">    Arguments:</span><br><span class="line">    parameters -- python dictionary containing your parameters:</span><br><span class="line">                    parameters[&apos;W&apos; + str(l)] = Wl</span><br><span class="line">                    parameters[&apos;b&apos; + str(l)] = bl</span><br><span class="line">    grads -- python dictionary containing your gradients for each parameters:</span><br><span class="line">                    grads[&apos;dW&apos; + str(l)] = dWl</span><br><span class="line">                    grads[&apos;db&apos; + str(l)] = dbl</span><br><span class="line">    v -- Adam variable, moving average of the first gradient, python dictionary</span><br><span class="line">    s -- Adam variable, moving average of the squared gradient, python dictionary</span><br><span class="line">    learning_rate -- the learning rate, scalar.</span><br><span class="line">    beta1 -- Exponential decay hyperparameter for the first moment estimates </span><br><span class="line">    beta2 -- Exponential decay hyperparameter for the second moment estimates </span><br><span class="line">    epsilon -- hyperparameter preventing division by zero in Adam updates</span><br><span class="line"></span><br><span class="line">    Returns:</span><br><span class="line">    parameters -- python dictionary containing your updated parameters </span><br><span class="line">    v -- Adam variable, moving average of the first gradient, python dictionary</span><br><span class="line">    s -- Adam variable, moving average of the squared gradient, python dictionary</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">    </span><br><span class="line">    L = len(parameters) // 2                 # number of layers in the neural networks</span><br><span class="line">    v_corrected = &#123;&#125;                         # Initializing first moment estimate, python dictionary</span><br><span class="line">    s_corrected = &#123;&#125;                         # Initializing second moment estimate, python dictionary</span><br><span class="line">    </span><br><span class="line">    # Perform Adam update on all parameters</span><br><span class="line">    for l in range(L):</span><br><span class="line">        # Moving average of the gradients. Inputs: &quot;v, grads, beta1&quot;. Output: &quot;v&quot;.</span><br><span class="line">        v[&quot;dW&quot; + str(l+1)] = beta1 * v[&quot;dW&quot; + str(l+1)] + (1 - beta1) * grads[&quot;dW&quot; + str(l+1)]</span><br><span class="line">        v[&quot;db&quot; + str(l+1)] = beta1 * v[&quot;db&quot; + str(l+1)] + (1 - beta1) * grads[&quot;db&quot; + str(l+1)]</span><br><span class="line"></span><br><span class="line">        # Compute bias-corrected first moment estimate. Inputs: &quot;v, beta1, t&quot;. Output: &quot;v_corrected&quot;.</span><br><span class="line">        v_corrected[&quot;dW&quot; + str(l+1)] = v[&quot;dW&quot; + str(l+1)] / (1 - beta1 ** t)</span><br><span class="line">        v_corrected[&quot;db&quot; + str(l+1)] = v[&quot;db&quot; + str(l+1)] / (1 - beta1 ** t)</span><br><span class="line"></span><br><span class="line">        # Moving average of the squared gradients. Inputs: &quot;s, grads, beta2&quot;. Output: &quot;s&quot;.</span><br><span class="line">        s[&quot;dW&quot; + str(l+1)] = beta2 * s[&quot;dW&quot; + str(l+1)] + (1 - beta2) * grads[&quot;dW&quot; + str(l+1)] ** 2</span><br><span class="line">        s[&quot;db&quot; + str(l+1)] = beta2 * s[&quot;db&quot; + str(l+1)] + (1 - beta2) * grads[&quot;db&quot; + str(l+1)] ** 2</span><br><span class="line"></span><br><span class="line">        # Compute bias-corrected second raw moment estimate. Inputs: &quot;s, beta2, t&quot;. Output: &quot;s_corrected&quot;.</span><br><span class="line">        s_corrected[&quot;dW&quot; + str(l+1)] = s[&quot;dW&quot; + str(l+1)] / (1 - beta2 ** t)</span><br><span class="line">        s_corrected[&quot;db&quot; + str(l+1)] = s[&quot;db&quot; + str(l+1)] / (1 - beta2 ** t)</span><br><span class="line"></span><br><span class="line">        # Update parameters. Inputs: &quot;parameters, learning_rate, v_corrected, s_corrected, epsilon&quot;. Output: &quot;parameters&quot;.</span><br><span class="line">        parameters[&quot;W&quot; + str(l+1)] -= learning_rate * v_corrected[&quot;dW&quot; + str(l+1)] / (np.sqrt(s_corrected[&quot;dW&quot; + str(l+1)]) + epsilon)</span><br><span class="line">        parameters[&quot;b&quot; + str(l+1)] -= learning_rate * v_corrected[&quot;db&quot; + str(l+1)] / (np.sqrt(s_corrected[&quot;db&quot; + str(l+1)]) + epsilon)</span><br><span class="line"></span><br><span class="line">    return parameters, v, s</span><br></pre></td></tr></table></figure></p>
<p><img src="/image/deepLearning/73.png" alt><br><a href="https://arxiv.org/pdf/1412.6980" target="_blank" rel="noopener">Adam ç®—æ³•åŸç†</a></p>
<h1 id="å®éªŒ"><a href="#å®éªŒ" class="headerlink" title="å®éªŒ"></a>å®éªŒ</h1><p><a href="https://github.com/YooHannah/algorithm/blob/master/deeplearning/OptGradientDescent/index.py" target="_blank" rel="noopener">ä¸Šé¢ä¸‰ç§ç®—æ³•ç»ƒä¹ </a></p>
<p>å°ç»“</p>
<blockquote>
<p>Momentum usually helps, but given the small learning rate and the simplistic dataset, its impact is almost negligeable. Also, the huge oscillations you see in the cost come from the fact that some minibatches are more difficult thans others for the optimization algorithm.</p>
</blockquote>
<blockquote>
<p>Adam on the other hand, clearly outperforms mini-batch gradient descent and Momentum. If you run the model for more epochs on this simple dataset, all three methods will lead to very good results. However, youâ€™ve seen that Adam converges a lot faster.</p>
</blockquote>
<p>å®éªŒæ•ˆæœAdamç®—æ³•é€Ÿåº¦å¿«ï¼Œå‡†ç¡®ç‡é«˜</p>
<blockquote>
<p>Some advantages of Adam include:</p>
</blockquote>
<blockquote>
<p>Relatively low memory requirements (though higher than gradient descent and gradient descent with momentum)<br>Usually works well even with little tuning of hyperparameters (except  ğ›¼ )</p>
</blockquote>
<h1 id="å­¦ä¹ ç‡è¡°å‡"><a href="#å­¦ä¹ ç‡è¡°å‡" class="headerlink" title="å­¦ä¹ ç‡è¡°å‡"></a>å­¦ä¹ ç‡è¡°å‡</h1><p>åœ¨å°æ‰¹é‡æ¢¯åº¦ä¸‹é™è®¡ç®—è¿‡ç¨‹ä¸­ï¼Œéšç€è®¡ç®—æ‰¹æ¬¡åç§»ï¼Œé€æ¸å‡å°å­¦ä¹ ç‡çš„å€¼ï¼Œå¯ä»¥é™ä½æ¢¯åº¦éœ‡è¡å¹…åº¦ï¼ŒåŠ é€Ÿæ”¶æ•›é€Ÿåº¦<br>ä¸€äº›å­¦ä¹ ç‡è¡°å‡ç®—æ³•å¦‚ä¸‹<br><img src="/image/deepLearning/75.png" alt><br><img src="/image/deepLearning/76.png" alt></p>
<h1 id="ä¸¤ä¸ªç»éªŒæ³•åˆ™"><a href="#ä¸¤ä¸ªç»éªŒæ³•åˆ™" class="headerlink" title="ä¸¤ä¸ªç»éªŒæ³•åˆ™"></a>ä¸¤ä¸ªç»éªŒæ³•åˆ™</h1><p>Unlikely to get stuck in a bad local optima ä¸€èˆ¬ä¸å­˜åœ¨å±€éƒ¨æœ€ä¼˜è§£ï¼ŒæŸå¤±å‡½æ•°ä¸å‚æ•°å…³ç³»å¾€å¾€æˆé©¬éè£…<br>Plateaus can make learning slow å¹³ç¼“çš„åœ°æ–¹å¾€å¾€ä¼šé€ æˆå­¦ä¹ é€Ÿåº¦ä¸‹é™ï¼Œéœ€è¦èŠ±è´¹æ›´å¤šæ—¶é—´æ‰¾åˆ°æ›´ä¼˜è§£</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://yoohannah.github.io/post/deepLearning/OptNeuralNetwork.html">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="YooHannah">
    <meta itemprop="description" content>
    <meta itemprop="image" content="/psb.jpg">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="My Little World">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="My Little World" src>
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/post/deepLearning/OptNeuralNetwork.html" itemprop="url">
                  ä¸€äº›ä¼˜åŒ–æ·±åº¦ç¥ç»ç½‘ç»œã€è®­ç»ƒè¿‡ç¨‹ã€‘çš„æ–¹æ³•
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2025-01-29T10:48:37+08:00">
                2025-01-29
              </time>
            

            

            
          </span>

          

          
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="æ•°æ®é›†çš„ä½¿ç”¨"><a href="#æ•°æ®é›†çš„ä½¿ç”¨" class="headerlink" title="æ•°æ®é›†çš„ä½¿ç”¨"></a>æ•°æ®é›†çš„ä½¿ç”¨</h1><p>ä¸€èˆ¬å°†æ•°æ®é›†åˆ†æˆä¸‰éƒ¨åˆ†ï¼Œè®­ç»ƒé›†ï¼ˆtraining setï¼‰ï¼Œäº¤å‰éªŒè¯é›†ï¼ˆcross validation set / dev setï¼‰ï¼Œæµ‹è¯•é›†ï¼ˆtest setï¼‰<br>è®­ç»ƒé›†ç”¨äºè®­ç»ƒæ¨¡å‹<br>äº¤å‰éªŒè¯é›†ç”¨äºè°ƒæ•´è¶…å‚æ•°ï¼Œæˆ–è€…æ¯”è¾ƒä¸åŒæ¨¡å‹ç®—æ³•æ€§èƒ½çš„ä¼˜åŠ£<br>æµ‹è¯•é›†ç”¨äºå¯¹æœ€ç»ˆæ¨¡å‹çš„è¿›è¡Œæ— åè¯„ä¼°(æ˜¯å¦å­˜åœ¨æ¬ æ‹Ÿåˆæˆ–è¿‡æ‹Ÿåˆ)</p>
<p>å¦‚æœä¸éœ€è¦è¿›è¡Œæœ€ç»ˆçš„æ— åè¯„ä¼°ï¼Œé‚£ä¹ˆå¯ä»¥å°†äº¤å‰éªŒè¯é›†å’Œæµ‹è¯•é›†åˆå¹¶ä¸ºä¸€ä¸ªæ•°æ®é›†ï¼Œè¿›è¡Œæ¨¡å‹è®­ç»ƒå’Œè¯„ä¼°<br>å°†æµ‹è¯•é›†æ•°æ®åˆå¹¶åˆ°äº¤å‰éªŒè¯é›†ä¸­ï¼Œæ•°æ®é›†æœ€ç»ˆåªä¼šå‰©ä¸‹è®­ç»ƒé›†å’Œæµ‹è¯•éªŒè¯é›†</p>
<p>å¦å¤–éœ€è¦æ³¨æ„è¿›è¡Œè®­ç»ƒçš„æ•°æ®é›†å’ŒéªŒè¯æµ‹è¯•çš„æ•°æ®é›†è¦æ¥è‡ªåŒä¸€ä¸ªåˆ†å¸ƒï¼Œå¦åˆ™ä¼šå½±å“è®­ç»ƒé€Ÿåº¦<br>æ¯”å¦‚è®­ç»ƒé›†å›¾ç‰‡æ¥è‡ªç½‘ç»œï¼Œåˆ†è¾¨ç‡é«˜ï¼Œæ¸…æ™°åº¦é«˜ï¼Œä½†æ˜¯æµ‹è¯•é›†å›¾ç‰‡æ¥è‡ªæ‰‹æœºï¼Œåˆ†è¾¨ç‡ä½ï¼Œæ¸…æ™°åº¦ä½<br>é‚£ä¹ˆè®­ç»ƒå‡ºæ¥çš„æ¨¡å‹åœ¨æµ‹è¯•é›†ä¸Šçš„è¡¨ç°å¯èƒ½ä¼šå¾ˆå·®</p>
<p><img src="/image/deepLearning/42.png" alt><br><img src="/image/deepLearning/43.png" alt></p>
<h1 id="ä½¿ç”¨åå·®-bias-å’Œæ–¹å·®-variance-å¯¹æ¨¡å‹è¿›è¡Œè¯„ä¼°"><a href="#ä½¿ç”¨åå·®-bias-å’Œæ–¹å·®-variance-å¯¹æ¨¡å‹è¿›è¡Œè¯„ä¼°" class="headerlink" title="ä½¿ç”¨åå·®(bias)å’Œæ–¹å·®(variance)å¯¹æ¨¡å‹è¿›è¡Œè¯„ä¼°"></a>ä½¿ç”¨åå·®(bias)å’Œæ–¹å·®(variance)å¯¹æ¨¡å‹è¿›è¡Œè¯„ä¼°</h1><p>é«˜åå·®ä¸€èˆ¬æ¬ æ‹Ÿåˆ<br>é«˜æ–¹å·®ä¸€èˆ¬è¿‡æ‹Ÿåˆ<br>å…ˆæ¥å¤ä¹ ä¸€ä¸‹åå·®å’Œæ–¹å·®çš„å®šä¹‰<br><a href="https://yoohannah.github.io/post/machineLearning/overfitting.html">è§£å†³è¿‡æ‹Ÿåˆé—®é¢˜</a><br><a href="https://yoohannah.github.io/post/machineLearning/biasVariance.html">é«˜åå·®å’Œé«˜æ–¹å·®</a><br><img src="/image/deepLearning/44.png" alt><br><img src="/image/LLM/119.png" alt></p>
<h2 id="æ­£åˆ™åŒ–å¤„ç†-Regularization-è¿‡æ‹Ÿåˆé—®é¢˜"><a href="#æ­£åˆ™åŒ–å¤„ç†-Regularization-è¿‡æ‹Ÿåˆé—®é¢˜" class="headerlink" title="æ­£åˆ™åŒ–å¤„ç†(Regularization)è¿‡æ‹Ÿåˆé—®é¢˜"></a>æ­£åˆ™åŒ–å¤„ç†(Regularization)è¿‡æ‹Ÿåˆé—®é¢˜</h2><p>é€šè¿‡ç»™æˆæœ¬å‡½æ•°å¢åŠ æ­£åˆ™åŒ–é¡¹ï¼Œè¿›è¡Œæƒé‡è¡°å‡ï¼Œæ¥é™ä½æ¨¡å‹çš„æ–¹å·®ï¼Œä»è€Œé¿å…è¿‡æ‹Ÿåˆçš„å‡ºç°<br><img src="/image/deepLearning/45.png" alt><br><img src="/image/deepLearning/46.png" alt><br><img src="/image/deepLearning/48.png" alt><br><img src="/image/deepLearning/47.png" alt></p>
<h2 id="L2-å…·ä½“å®ç°"><a href="#L2-å…·ä½“å®ç°" class="headerlink" title="L2 å…·ä½“å®ç°"></a>L2 å…·ä½“å®ç°</h2><p><img src="/image/deepLearning/60.png" alt><br><img src="/image/deepLearning/61.png" alt></p>
<h2 id="Dropout-æ­£åˆ™åŒ–"><a href="#Dropout-æ­£åˆ™åŒ–" class="headerlink" title="Dropout æ­£åˆ™åŒ–"></a>Dropout æ­£åˆ™åŒ–</h2><p>dropout æ–¹æ³• å®ç°åŸç†å°±æ˜¯åœ¨æ¯å±‚è®¡ç®—å‰å‰ï¼Œç”Ÿæˆéšæœºè’™å±‚ï¼ŒæŒ‰keep_probæ¯”ä¾‹éšæœºå¹²æ‰ä¸€äº›èŠ‚ç‚¹ï¼Œå†å‚ä¸è¿ç®—ï¼Œè®¡ç®—åé™¤ä»¥keep_probï¼Œä¿è¯æœ€ç»ˆè¾“å‡ºçš„ç»“æœä¸å˜<br>åœ¨åå‘ä¼ æ’­æ—¶ï¼Œä½¿ç”¨å‘å‰ä¼ æ’­çš„è’™å±‚å¯¹æ¢¯åº¦è¿›è¡Œç›¸åº”çš„å¤„ç†ï¼Œä¿è¯è¯¥è½®çš„å‚æ•°çŸ©é˜µç›¸åŒï¼Œæ‰€ä»¥è¦å¯¹å‘å‰ä¼ æ’­çš„è’™å±‚è¿›è¡Œç¼“å­˜å¤„ç†æ–¹ä¾¿ä½¿ç”¨<br><img src="/image/deepLearning/49.png" alt><br><img src="/image/deepLearning/50.png" alt></p>
<p>å¯ä»¥çœ‹åˆ°ç›¸æ¯”L2 ç±»ä¼¼äºå¯¹w è¿›è¡Œç¼©å°å¤„ç†ï¼Œdropout æ–¹æ³•ç±»ä¼¼äºå¯¹w è¿›è¡Œæ”¾å¤§å¤„ç†, å› ä¸ºå¹²æ‰ä¸€äº›èŠ‚ç‚¹ç›¸å½“äºéšæœºå–æ¶ˆæŸäº›w çš„å½±å“ï¼Œæœ€åé™¤ä»¥keep_prob ç›¸å½“äºå¯¹w è¿›è¡Œæ”¾å¤§å¤„ç†</p>
<h2 id="å…¶å®ƒæ­£åˆ™åŒ–æ–¹æ³•"><a href="#å…¶å®ƒæ­£åˆ™åŒ–æ–¹æ³•" class="headerlink" title="å…¶å®ƒæ­£åˆ™åŒ–æ–¹æ³•"></a>å…¶å®ƒæ­£åˆ™åŒ–æ–¹æ³•</h2><p>é™¤äº†ä¸Šé¢æåˆ°ç»™costå‡½æ•°æ·»åŠ L1,L2æ­£åˆ™åŒ–é¡¹ï¼Œè¿˜å¯ä»¥é€šè¿‡dropout æ–¹æ³•ï¼Œæ•°æ®å¢å¼ºï¼Œææ—©ç»“æŸè®­ç»ƒç­‰æ­£åˆ™åŒ–æ–¹æ³•æ¥é¿å…è¿‡æ‹Ÿåˆçš„å‡ºç°<br><img src="/image/deepLearning/51.png" alt><br><img src="/image/deepLearning/52.png" alt></p>
<p><a href="https://github.com/YooHannah/algorithm/blob/master/deeplearning/Regularization/index.py" target="_blank" rel="noopener">L2å’ŒDropoutå®éªŒ</a></p>
<h1 id="å½’ä¸€åŒ–è®­ç»ƒé›†"><a href="#å½’ä¸€åŒ–è®­ç»ƒé›†" class="headerlink" title="å½’ä¸€åŒ–è®­ç»ƒé›†"></a>å½’ä¸€åŒ–è®­ç»ƒé›†</h1><p>é€šè¿‡å¯¹è®­ç»ƒæ•°æ®é›†è¿›è¡Œå½’ä¸€åŒ–å¤„ç†ï¼ŒåŠ å¿«æ¢¯åº¦ä¸‹é™ï¼Œæé«˜è®­ç»ƒé€Ÿåº¦<br>å¤ä¹ ä¸€ä¸‹<a href="https://yoohannah.github.io/post/machineLearning/lineregression.html">ç‰¹å¾æ”¾ç¼©</a><br><img src="/image/deepLearning/53.png" alt><br><img src="/image/deepLearning/54.png" alt></p>
<h1 id="åˆå§‹åŒ–å‚æ•°"><a href="#åˆå§‹åŒ–å‚æ•°" class="headerlink" title="åˆå§‹åŒ–å‚æ•°"></a>åˆå§‹åŒ–å‚æ•°</h1><p>ç”±äºç¥ç»ç½‘ç»œçš„å¤šå±‚çš„è®¡ç®—è¿‡ç¨‹ä¸­ï¼Œæƒé‡æ˜¯ä¹˜ç§¯å…³ç³»ï¼Œå¦‚æœå„å±‚åˆå§‹åŒ–å‚æ•°ä¸€å¼€å§‹å¤§äº1 æˆ–è€…å°äº1ï¼Œæ•´ä¸ªä¹˜ç§¯ä¸‹æ¥ï¼Œå°±å¯¼è‡´y^ æ— é™å¤§æˆ–è€…æ— é™å°ï¼Œä»è€Œå¯¼è‡´æ¢¯åº¦çˆ†ç‚¸æˆ–è€…æ¢¯åº¦æ¶ˆå¤±<br><img src="/image/deepLearning/55.png" alt><br>è§£å†³<br><img src="/image/deepLearning/56.png" alt><br><a href="https://github.com/YooHannah/algorithm/blob/master/deeplearning/Initialization/index.py" target="_blank" rel="noopener">ä¸åŒåˆå§‹åŒ–å‚æ•°æ–¹å¼</a></p>
<h1 id="æ¢¯åº¦æ ¡éªŒ"><a href="#æ¢¯åº¦æ ¡éªŒ" class="headerlink" title="æ¢¯åº¦æ ¡éªŒ"></a>æ¢¯åº¦æ ¡éªŒ</h1><p>åŒè¾¹è¯¯å·®ä¼šæ¯”å•è¾¹è¯¯å·®æ›´å‡†ç¡®<br><img src="/image/deepLearning/57.png" alt><br>æ¢¯åº¦æ ¡éªŒçš„è¿‡ç¨‹å°±æ˜¯æ‹¿åˆ°ä¸€è½®è®­ç»ƒçš„å‚æ•°å’Œæ¢¯åº¦ï¼Œè¿›è¡Œæ‘Šå¹³å¤„ç†ï¼Œå­—å…¸å˜ n * 1 äºŒç»´æ•°ç»„ï¼Œæ¯ä¸€å±‚çš„æ¯ä¸€ä¸ªw æ˜¯ä¸€ä¸ªæ•°ç»„<br>å¯¹æ¯ä¸€å±‚æ¯ä¸€ä¸ªå‚æ•°ä¿®æ”¹ä¸€ä¸ªå¾ˆå°çš„å€¼ï¼Œä¸€æ¬¡åŠ ï¼Œä¸€æ¬¡å‡ï¼Œé‡æ–°è®¡ç®—cost å€¼ï¼Œæ‹¿åˆ°ä¸¤ä¸ªcost å€¼åè¿›è¡ŒåŒè¾¹è¯¯å·®è®¡ç®—ï¼Œ<br>æ•´ä¸ªå‚æ•°éƒ½è®¡ç®—å®Œåï¼Œä¸æ¢¯åº¦è¿›è¡Œæ¯”è¾ƒï¼Œè¯¦è§å…¬å¼<br>å¦‚æœæ¯”è¾ƒå€¼ç›¸å·®ä¸å¤§ï¼Œè¯´æ˜æ¢¯åº¦è®¡ç®—æ²¡æœ‰é—®é¢˜<br><img src="/image/deepLearning/58.png" alt><br><img src="/image/deepLearning/59.png" alt></p>
<h2 id="å®éªŒ"><a href="#å®éªŒ" class="headerlink" title="å®éªŒ"></a>å®éªŒ</h2><p><img src="/image/deepLearning/62.png" alt><br><img src="/image/deepLearning/63.png" alt><br><img src="/image/deepLearning/64.png" alt><br><a href="https://github.com/YooHannah/algorithm/blob/master/deeplearning/GradientChecking/index.py" target="_blank" rel="noopener">å…·ä½“ä»£ç </a></p>
<h1 id="åˆ†æè§£å†³é—®é¢˜"><a href="#åˆ†æè§£å†³é—®é¢˜" class="headerlink" title="åˆ†æè§£å†³é—®é¢˜"></a>åˆ†æè§£å†³é—®é¢˜</h1><p>ä¹‹å‰æåˆ°çš„ä¸€äº›ä¼˜åŒ–æ¨¡å‹çš„æ–¹æ³•<br><img src="/image/deepLearning/89.png" alt></p>
<h2 id="æ­£äº¤åŒ–"><a href="#æ­£äº¤åŒ–" class="headerlink" title="æ­£äº¤åŒ–"></a>æ­£äº¤åŒ–</h2><p>æ˜¯ä¸€ç§è§£å†³é—®é¢˜çš„æ€æƒ³ï¼Œç®€å•æ¥è¯´å°±æ˜¯é€šè¿‡å°†é—®é¢˜åˆ†è§£ä¸ºç›¸äº’ç‹¬ç«‹çš„å­é—®é¢˜ï¼Œä»è€Œä½¿å¾—æ¯ä¸ªå­é—®é¢˜å¯ä»¥ç‹¬ç«‹è§£å†³ï¼Œå‡å°‘ç›¸äº’å¹²æ‰°<br>æ¯”å¦‚ä¸‹é¢çš„è®­ç»ƒè¿‡ç¨‹ï¼Œæ¯ä¸€ä¸ªé˜¶æ®µæœ‰æ¯ä¸€ä¸ªé˜¶æ®µè¦å®Œæˆçš„ç›®æ ‡ï¼Œæ¯ä¸€ä¸ªé˜¶æ®µçš„å®ç°ç›®æ ‡è¿‡ç¨‹ä¼šé‡åˆ°ä¸åŒé—®é¢˜ï¼Œé’ˆå¯¹ä¸åŒé˜¶æ®µä¸åŒé—®é¢˜é‡‡å–ç›¸åº”è§£å†³åŠæ³•<br>æ¯ä¸ªå­ç›®æ ‡ç›¸äº’ç‹¬ç«‹ï¼Œäº’ä¸å¹²æ‰°ä¸€ä¸ªé˜¶æ®µçš„ç›®æ ‡å®Œæˆåï¼Œå†è¿›è¡Œä¸‹ä¸€ä¸ªé˜¶æ®µçš„ç›®æ ‡<br><img src="/image/deepLearning/90.png" alt><br>å°±ç›¸å½“äºæŠŠä¸€ä¸ªå¤§é—®é¢˜åˆ†è§£ä¸ºå¤šä¸ªå°é—®é¢˜ï¼Œæ¯ä¸ªå°é—®é¢˜ç›¸äº’ç‹¬ç«‹ï¼Œäº’ä¸å¹²æ‰°ï¼Œ<br>é’ˆå¯¹ä¸åŒé—®é¢˜ï¼Œé‡‡å–ç›¸åº”çš„è§£å†³åŠæ³•ï¼Œæœ€ç»ˆå®Œæ•´æ•´ä¸ªæ¨¡å‹çš„è®­ç»ƒ</p>
<h2 id="å»ºç«‹å•ä¸€æ•°å­—è¯„ä¼°æŒ‡æ ‡"><a href="#å»ºç«‹å•ä¸€æ•°å­—è¯„ä¼°æŒ‡æ ‡" class="headerlink" title="å»ºç«‹å•ä¸€æ•°å­—è¯„ä¼°æŒ‡æ ‡"></a>å»ºç«‹å•ä¸€æ•°å­—è¯„ä¼°æŒ‡æ ‡</h2><p>å¦‚æœéœ€è¦å¯¹å¤šä¸ªæŒ‡æ ‡è¿›è¡Œä¼˜åŒ–ï¼Œå‚è€ƒä¸Šé¢æ­£äº¤åŒ–æ€æƒ³ï¼Œç‹¬ç«‹è§£å†³æ¯ä¸ªæŒ‡æ ‡çš„ä¼˜åŒ–é—®é¢˜ï¼Œå³å»ºç«‹å•ä¸€æ•°å­—è¯„ä¼°æŒ‡æ ‡<br>æ¨¡å‹è¯„ä¼°é˜¶æ®µä¼šç”¨åˆ°å¤šä¸ªæŒ‡æ ‡ï¼Œæ¯”å¦‚å‡†ç¡®ç‡ï¼Œå¬å›ç‡ï¼ŒF1 å€¼ï¼Œ<br>ä½†æ˜¯è¿™äº›æŒ‡æ ‡ä¹‹é—´å­˜åœ¨ç›¸äº’å½±å“ï¼Œæ¯”å¦‚å‡†ç¡®ç‡é«˜ï¼Œå¬å›ç‡ä½ï¼ŒF1 å€¼ä½<br>æ‰€ä»¥éœ€è¦å»ºç«‹å•ä¸€æ•°å­—è¯„ä¼°æŒ‡æ ‡ï¼Œæ¯”å¦‚F1 å€¼ï¼Œé€šè¿‡F1<br>æ­¤æ—¶F1 å€¼å°±æ˜¯ã€ä¼˜åŒ–æŒ‡æ ‡ã€‘(éœ€è¦ç»§ç»­æé«˜çš„æŒ‡æ ‡)ï¼Œå…¶ä»–æŒ‡æ ‡å°±æ˜¯ã€æ»¡è¶³æŒ‡æ ‡ã€‘(è¾¾åˆ°ä¸€å®šé˜ˆå€¼å³å¯)<br>ä¹‹åæ¨¡å‹è®­ç»ƒç›¸å½“äºå°±æœç€ä¼˜åŒ–é¡¹æŒ‡æ ‡è¿›è¡Œè®­ç»ƒï¼Œæœ‰çš„æ”¾çŸ¢<br>æˆ–è€…é€šè¿‡å…¶ä»–æŒ‡æ ‡ç»¼åˆè®¡ç®—å‡ºå”¯ä¸€çš„æŒ‡æ ‡å€¼æ¥è¯„ä¼°æ¨¡å‹ä¼˜åŠ£<br><a href="https://yoohannah.github.io/post/machineLearning/MachineLearningDevelopmentProcess.html">ç›¸å…³å¤ä¹ ä¸€</a><br><a href="https://yoohannah.github.io/post/machineLearning/abnormalTest.html">ç›¸å…³å¤ä¹ äºŒ</a><br><img src="/image/deepLearning/91.png" alt></p>
<h2 id="æ··æ´—æ•°æ®ä¿è¯æ•°æ®åˆ†å¸ƒå‡åŒ€"><a href="#æ··æ´—æ•°æ®ä¿è¯æ•°æ®åˆ†å¸ƒå‡åŒ€" class="headerlink" title="æ··æ´—æ•°æ®ä¿è¯æ•°æ®åˆ†å¸ƒå‡åŒ€"></a>æ··æ´—æ•°æ®ä¿è¯æ•°æ®åˆ†å¸ƒå‡åŒ€</h2><p>é¿å…devå’Œtesté›†æ•°æ®åˆ†å¸ƒå·®å¼‚è¿‡å¤§ï¼Œåœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œä¼šå¯¼è‡´æ¨¡å‹è®­ç»ƒæ•ˆæœä¸ä½³<br>åœ¨è®­ç»ƒå‰ï¼ŒæŠŠæ•°æ®è¿›è¡Œæ··æ´—ï¼Œæ‰“ä¹±æ•°æ®åˆ†å¸ƒï¼Œä¿è¯devå’Œtestæ•°æ®åˆ†å¸ƒå·®å¼‚ä¸å¤§</p>
<blockquote>
<p>Choose a dev set and test set to reflect data you expect to get in the future and consider important to do well on.</p>
</blockquote>
<h3 id="æ•°æ®é›†å¤§å°å»ºè®®"><a href="#æ•°æ®é›†å¤§å°å»ºè®®" class="headerlink" title="æ•°æ®é›†å¤§å°å»ºè®®"></a>æ•°æ®é›†å¤§å°å»ºè®®</h3><blockquote>
<p>Set your dev set to be big enough to detect differences in algorithm/models youâ€™re trying out.<br>Set your test set to be big enough to give high confidence in the overall performance of your system.<br>å¦‚æœå¯¹å®é™…æ•°æ®æ•ˆæœè¦æ±‚è¾ƒé«˜ï¼Œé‚£ä¹ˆæœ€å¥½è¦æœ‰test set è¿›è¡Œæ€§èƒ½æµ‹è¯•ï¼Œå¦åˆ™ä¼šå½±å“å®é™…ä½¿ç”¨æ•ˆæœ</p>
</blockquote>
<h2 id="æ›´æ”¹æŒ‡æ ‡"><a href="#æ›´æ”¹æŒ‡æ ‡" class="headerlink" title="æ›´æ”¹æŒ‡æ ‡"></a>æ›´æ”¹æŒ‡æ ‡</h2><p>å¦‚æœè®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œä¹‹å‰è®¾ç½®çš„æŒ‡æ ‡å·²ç»ä¸èƒ½æ»¡è¶³æ¨¡å‹è®­ç»ƒè¦æ±‚ï¼Œ<br>æˆ–è€…å·²ç»é”™è¯¯çš„å¯¹æ¨¡å‹è¿›è¡Œäº†ç­›é€‰ï¼Œ<br>è¦ä¹ˆéœ€è¦æ›´æ”¹æŒ‡æ ‡ï¼Œè¦ä¹ˆéœ€è¦æ›´æ”¹æ¨¡å‹ç»“æ„ï¼Œè¦ä¹ˆæ›´æ”¹dev/test set<br><img src="/image/deepLearning/92.png" alt><br><img src="/image/deepLearning/93.png" alt></p>
<h2 id="ä»¥äººçš„èƒ½åŠ›ä¸ºå‚è€ƒ"><a href="#ä»¥äººçš„èƒ½åŠ›ä¸ºå‚è€ƒ" class="headerlink" title="ä»¥äººçš„èƒ½åŠ›ä¸ºå‚è€ƒ"></a>ä»¥äººçš„èƒ½åŠ›ä¸ºå‚è€ƒ</h2><p><img src="/image/deepLearning/94.png" alt><br>Why compare to human-level performance<br>Humans are quite good at a lot of tasks. So long as ML is worse than humans, you can:</p>
<ul>
<li>Get labeled data from humans.</li>
<li>Gain insight from manual error analysis: Why did a person get this right?</li>
<li>Better analysis of bias/variance.<br><img src="/image/deepLearning/95.png" alt></li>
</ul>
<h2 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h2><p><img src="/image/deepLearning/96.png" alt><br><img src="/image/deepLearning/97.png" alt></p>
<h1 id="é”™è¯¯åˆ†æ"><a href="#é”™è¯¯åˆ†æ" class="headerlink" title="é”™è¯¯åˆ†æ"></a>é”™è¯¯åˆ†æ</h1><p>å¯¹åˆ¤æ–­é”™è¯¯çš„æ•°æ®è¿›è¡Œé”™è¯¯ç±»å‹ç»Ÿè®¡åˆ†æï¼Œå†³å®šä¸‹ä¸€æ­¥ä¼˜åŒ–æ–¹å‘ï¼Œç»™å‡ºä¼˜å…ˆçº§<br><img src="/image/deepLearning/98.png" alt></p>
<h2 id="æ¸…é™¤æ ‡ç­¾é”™è¯¯"><a href="#æ¸…é™¤æ ‡ç­¾é”™è¯¯" class="headerlink" title="æ¸…é™¤æ ‡ç­¾é”™è¯¯"></a>æ¸…é™¤æ ‡ç­¾é”™è¯¯</h2><p>å¦‚æœdev/test set æ•°æ®ä¸­ï¼Œå­˜åœ¨æ ‡ç­¾é”™è¯¯çš„æ•°æ®ï¼Œ<br>å¦‚æœè¯¥ç±»æ•°æ®åœ¨é”™è¯¯æ•°æ®ä¸­å æ¯”è¾ƒå¤§ï¼Œå·²ç»å½±å“åˆ°dev set é˜¶æ®µå¯¹æ¨¡å‹çš„é€‰æ‹©<br>åˆ™éœ€è¦é‡‡å–æªæ–½è¿›è¡Œæ ‡ç­¾é”™è¯¯çš„æ•°æ®æ¸…é™¤<br><img src="/image/deepLearning/99.png" alt></p>
<blockquote>
<p>Correcting incorrect dev/test set examples<br>â€¢ Apply same process to your dev and test sets to make sure they continue to come from the same distribution åˆ†å¸ƒç›¸åŒ<br>â€¢ Consider examining examples your algorithm got right as well as ones it got wrong.æ­£ç¡®é”™è¯¯æ•°æ®éƒ½æ£€æŸ¥ä¸‹æ ‡ç­¾<br>â€¢ Train and dev/test data may now come from slightly different distributions. è®­ç»ƒæ•°æ®å’ŒéªŒè¯æµ‹è¯•æ•°æ®ç°åœ¨å¯ä»¥æ¥è‡ªç¨å¾®ä¸åŒçš„åˆ†å¸ƒ</p>
</blockquote>
<h3 id="ä¸åŒåˆ†å¸ƒæ•°æ®é›†å¤„ç†"><a href="#ä¸åŒåˆ†å¸ƒæ•°æ®é›†å¤„ç†" class="headerlink" title="ä¸åŒåˆ†å¸ƒæ•°æ®é›†å¤„ç†"></a>ä¸åŒåˆ†å¸ƒæ•°æ®é›†å¤„ç†</h3><p>å¯¹äºè®­ç»ƒé›†å’ŒéªŒè¯æµ‹è¯•é›†åˆ†å¸ƒä¸åŒçš„é—®é¢˜<br>ä¸å»ºè®®å°†æ•°æ®æ··æ´—åå†è¿›è¡Œè®­ç»ƒï¼Œè¿™æ ·ä¼šå¯¼è‡´éªŒè¯æµ‹è¯•é˜¶æ®µä¸æ˜¯å®é™…æ•°æ®ï¼Œè€Œæ˜¯éƒ¨åˆ†æµ‹è¯•æ•°æ®çš„é—®é¢˜<br>æ›´å¥½çš„å¤„ç†åŠæ³•æ˜¯æŠŠéªŒè¯æµ‹è¯•é›†æ•°æ®é›†çš„50%ä¹Ÿè¿›è¡Œè®­ç»ƒï¼Œå‰©ä¸‹50%å†å‡åˆ†è¿›è¡ŒéªŒè¯æµ‹è¯•<br><img src="/image/deepLearning/100.png" alt><br><img src="/image/deepLearning/101.png" alt></p>
<h2 id="å¿«é€Ÿæ­å»ºç„¶åè¿­ä»£"><a href="#å¿«é€Ÿæ­å»ºç„¶åè¿­ä»£" class="headerlink" title="å¿«é€Ÿæ­å»ºç„¶åè¿­ä»£"></a>å¿«é€Ÿæ­å»ºç„¶åè¿­ä»£</h2><p>å¦‚æœéœ€è¦å¯¹ä¸€ä¸ªå…¨æ–°çš„é—®é¢˜è¿›è¡Œæ¨¡å‹è®­ç»ƒï¼Œå»ºè®®å¿«é€Ÿæ­å»ºæ¨¡å‹ï¼Œç„¶åè¿­ä»£ï¼Œåœ¨è¿­ä»£ä¸­å‘ç°é—®é¢˜ï¼Œä¼˜åŒ–ç®—æ³•<br>â€¢ Set up dev/test set and metric<br>â€¢ Build initial system quickly<br>â€¢ Use Bias/Variance analysis &amp; Error analysis to prioritize next steps.<br>ä½†æ˜¯è¦å°½å¯èƒ½é¿å…ç³»ç»Ÿè¿‡äºç®€å•æˆ–è€…è¿‡äºå¤æ‚ï¼Œ<br>å¯¹äºæœ‰ä¼—å¤šè®ºæ–‡æ”¯æŒçš„é—®é¢˜ï¼Œæ¯”å¦‚äººè„¸è¯†åˆ«ï¼Œå¯ä»¥æ ¹æ®è®ºæ–‡å¿«é€Ÿæ­å»ºå¤æ‚æ¨¡å‹ï¼Œç„¶åå¼€å§‹è®­ç»ƒ<br>å¯¹äºé™Œç”Ÿé¢†åŸŸçš„é—®é¢˜ï¼Œåˆ™å¯ä»¥ç”±ç®€å•åˆ°å¤æ‚è¿›è¡Œè®­ç»ƒ</p>
<h2 id="ä¸åŒ¹é…æ•°æ®"><a href="#ä¸åŒ¹é…æ•°æ®" class="headerlink" title="ä¸åŒ¹é…æ•°æ®"></a>ä¸åŒ¹é…æ•°æ®</h2><p>æ›´ç»†è‡´çš„å¯¹é”™è¯¯ç‡è¿›è¡Œåˆ†æï¼Œé€šè¿‡è®¡ç®—ä¸åŒé”™è¯¯ç‡çš„å·®å€¼ï¼Œåˆ†æä¸åŒåŸå› æ¯”é‡ï¼Œå†³å®šä¼˜åŒ–æ–¹å‘<br>Â· å¯é¿å…åå·®<br>Â· æ–¹å·®ï¼Œå¦‚æœæ¯”è¾ƒå¤§ï¼Œè¯´æ˜æ¨¡å‹ä¸èƒ½æ³›åŒ–åˆ°åŒä¸€åˆ†å¸ƒæ•°æ®<br>Â· æ•°æ®ä¸åŒ¹é…ï¼Œè®­ç»ƒæ•°æ®å’ŒéªŒè¯æ•°æ®å¯èƒ½åˆ†å¸ƒä¸åŒ<br>Â· è¿‡æ‹Ÿåˆç¨‹åº¦<br><img src="/image/deepLearning/102.png" alt><br><img src="/image/deepLearning/103.png" alt><br><img src="/image/deepLearning/104.png" alt></p>
<h3 id="å¦‚ä½•ç»“å±€æ•°æ®ä¸åŒ¹é…é—®é¢˜"><a href="#å¦‚ä½•ç»“å±€æ•°æ®ä¸åŒ¹é…é—®é¢˜" class="headerlink" title="å¦‚ä½•ç»“å±€æ•°æ®ä¸åŒ¹é…é—®é¢˜"></a>å¦‚ä½•ç»“å±€æ•°æ®ä¸åŒ¹é…é—®é¢˜</h3><p>å¯¹train set å’Œdev setè¿›è¡Œé”™è¯¯åˆ†æï¼Œæ‰¾å‡ºäºŒè€…ä¸åŒï¼Œç„¶åå°½å¯èƒ½å¤šçš„ç”¨dev set æ•°æ®è¿›è¡Œè®­ç»ƒ<br>é™¤äº†å»æ”¶é›†çœŸå®çš„dev setï¼Œè¿˜å¯ä»¥é€šè¿‡äººå·¥åˆæˆçš„æ•°æ®è¿›è¡Œè®­ç»ƒï¼Œ<br>ä½†æ˜¯è¦æ³¨æ„ï¼Œäººå·¥åˆæˆçš„æ•°æ®åªæ˜¯å®é™…æ•°æ®çš„ä¸€ä¸ªå­é›†ï¼Œé¿å…å‡ºç°å¯¹å­é›†æ•°æ®è¿‡æ‹Ÿåˆçš„æƒ…å†µ<br>Addressing data mismatch<br>â€¢ Carry out manual error analysis to try to understand difference between training and dev/test sets<br>â€¢ Make training data more similar; or collect more data similar to dev/test sets<br><img src="/image/deepLearning/105.png" alt><br><img src="/image/deepLearning/106.png" alt></p>
<h1 id="è¿ç§»å­¦ä¹ "><a href="#è¿ç§»å­¦ä¹ " class="headerlink" title="è¿ç§»å­¦ä¹ "></a>è¿ç§»å­¦ä¹ </h1><p><a href="https://yoohannah.github.io/post/machineLearning/MachineLearningDevelopmentProcess.html">å¤ä¹ </a><br>é€‚ç”¨æƒ…å½¢<br>â€¢ Task A and B have the same input x.<br>â€¢ You have a lot more data for Task A than Task B.<br>â€¢ Low level features from A could be helpful for learning B.<br><img src="/image/deepLearning/107.png" alt></p>
<h1 id="å¤šä»»åŠ¡å­¦ä¹ "><a href="#å¤šä»»åŠ¡å­¦ä¹ " class="headerlink" title="å¤šä»»åŠ¡å­¦ä¹ "></a>å¤šä»»åŠ¡å­¦ä¹ </h1><p>å»ºç«‹å•ä¸€ç¥ç»ç½‘ç»œåŒæ—¶è¾“å‡ºå¤šä¸ªä»»åŠ¡çš„ç»“æœ<br>é€‚ç”¨æƒ…å½¢<br>â€¢ Training on a set of tasks that could benefit from having shared lower-level features.<br>â€¢ Usually: Amount of data you have for each task is quite similar.<br>â€¢ Can train a big enough neural network to do well on all the tasks.<br><img src="/image/deepLearning/108.png" alt></p>
<h1 id="ç«¯åˆ°ç«¯æ·±åº¦å­¦ä¹ "><a href="#ç«¯åˆ°ç«¯æ·±åº¦å­¦ä¹ " class="headerlink" title="ç«¯åˆ°ç«¯æ·±åº¦å­¦ä¹ "></a>ç«¯åˆ°ç«¯æ·±åº¦å­¦ä¹ </h1><p>ç«¯åˆ°ç«¯æ·±åº¦å­¦ä¹ ï¼ˆEnd-to-End Deep Learningï¼‰æ˜¯æŒ‡åœ¨æ„å»ºå’Œè®­ç»ƒæ·±åº¦å­¦ä¹ æ¨¡å‹æ—¶ï¼Œç›´æ¥ä»åŸå§‹è¾“å…¥æ•°æ®åˆ°æœ€ç»ˆè¾“å‡ºç»“æœçš„æ•´ä¸ªè¿‡ç¨‹éƒ½ç”±ä¸€ä¸ªå•ä¸€çš„æ¨¡å‹æ¥å®Œæˆã€‚<br>è¿™ç§æ–¹æ³•é¿å…äº†ä¼ ç»Ÿæœºå™¨å­¦ä¹ ä¸­å¸¸è§çš„å¤šä¸ªç‹¬ç«‹æ­¥éª¤å’Œæ‰‹å·¥ç‰¹å¾å·¥ç¨‹ï¼Œæ—¨åœ¨é€šè¿‡ä¸€ä¸ªç»Ÿä¸€çš„æ¨¡å‹è‡ªåŠ¨å­¦ä¹ å’Œä¼˜åŒ–æ•´ä¸ªä»»åŠ¡ã€‚</p>
<p>ä¼˜ç‚¹:<br>â€¢ Let the data speak<br>â€¢ Less hand-designing of components needed<br>ç¼ºç‚¹:<br>â€¢ May need large amount of data<br>â€¢ Excludes potentially useful hand-designed components</p>
<p>é€‚ç”¨æƒ…å½¢<br>Do you have sufficient data to learn a function of the complexity needed to map x to y?<br>æœ‰æ²¡æœ‰è¶³å¤Ÿæœ‰æ•ˆçš„ç›´æ¥ä»xåˆ°yæ˜ å°„æ•°æ®ç”¨æ¥è¿›è¡Œå¤æ‚å‡½æ•°çš„å­¦ä¹ ï¼Ÿ</p>
<p>ç°å®ä¸­ï¼Œå¦‚æœæ²¡è¶³å¤Ÿå¤šx-&gt; Y  çš„æ˜ å°„æ•°æ®ï¼Œå­˜åœ¨ä¸­é—´æ•°æ®æ–¹ä¾¿ï¼Œx-&gt; Z -&gt; Y è¿™æ ·çš„æ˜ å°„æ•°æ®ï¼Œ<br>é‚£ä¹ˆå°†ç«¯åˆ°ç«¯ä»»åŠ¡åˆ†è§£æˆä¸¤ä¸ªå°ä»»åŠ¡ï¼Œä¼šæ›´ç®€å•<br>æ¯”å¦‚ä¸‹é¢çš„äººè„¸è¯†åˆ«å’Œæ ¹æ®æ‰‹Xå…‰å›¾ç‰‡åˆ¤æ–­å„¿ç«¥å¹´é¾„ï¼Œè‡ªåŠ¨é©¾é©¶ï¼Œä½†å¦‚æœæ˜¯æœºå™¨ç¿»è¯‘å°±æ¯”è¾ƒé€‚åˆç«¯åˆ°ç«¯</p>
<p><img src="/image/deepLearning/109.png" alt><br><img src="/image/deepLearning/110.png" alt></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://yoohannah.github.io/post/nodejs/streamExamp.html">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="YooHannah">
    <meta itemprop="description" content>
    <meta itemprop="image" content="/psb.jpg">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="My Little World">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="My Little World" src>
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/post/nodejs/streamExamp.html" itemprop="url">
                  ä¸€ä¸ªå®ç°æµé€šä¿¡çš„æ¡ˆä¾‹
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2025-01-26T16:17:37+08:00">
                2025-01-26
              </time>
            

            

            
          </span>

          

          
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h1><p>å‰ç«¯åŒ…æ‹¬nodeå±‚å’Œçº¯å‰ç«¯å±‚ï¼Œéœ€è¦è¯·æ±‚ç¬¬ä¸‰æ–¹httpæ¥å£åœ¨é¡µé¢å®ç°chatGTPçš„æ‰“å­—æœºæ•ˆæœ</p>
<h1 id="æ–¹æ¡ˆ"><a href="#æ–¹æ¡ˆ" class="headerlink" title="æ–¹æ¡ˆ"></a>æ–¹æ¡ˆ</h1><ol>
<li>åœ¨nodeå±‚è°ƒç”¨ç¬¬ä¸‰æ–¹httpæ¥å£ï¼Œé¿å…è·¨åŸŸé—®é¢˜</li>
<li>ç”±äºç¬¬ä¸‰æ–¹æ¥å£ä¸ºæµå¼æ¥å£ï¼Œä»nodeå±‚å‘å‡ºè¯·æ±‚å†è½¬å‘åˆ°å‰ç«¯ä¹Ÿéœ€è¦è¿›è¡Œæµå¼é€šä¿¡</li>
<li>å‰ç«¯å±‚å¯¹è¿”å›çš„æµå¼æ•°æ®è¿›è¡Œå¤„ç†åæ›´æ–°æ•°æ®å‘ˆç°åœ¨é¡µé¢ä¸Š</li>
</ol>
<h1 id="å®ç°"><a href="#å®ç°" class="headerlink" title="å®ç°"></a>å®ç°</h1><ol>
<li>å‰ç«¯å±‚ä½¿ç”¨fetchè¿›è¡Œè¯·æ±‚ï¼Œä½¿ç”¨ReadableStreamè¿›è¡Œæµå¼å¤„ç†</li>
<li>nodeå±‚ä½¿ç”¨axiosè¿›è¡Œè¯·æ±‚ï¼Œä½¿ç”¨streamè¿›è¡Œæµå¼å¤„ç†  </li>
</ol>
<h2 id="nodeå±‚å®ç°"><a href="#nodeå±‚å®ç°" class="headerlink" title="nodeå±‚å®ç°"></a>nodeå±‚å®ç°</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">'axios'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; PassThrough &#125; <span class="keyword">from</span> <span class="string">'stream'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">faqStream</span>(<span class="params">body?: any</span>): <span class="title">Promise</span>&lt;<span class="title">any</span>&gt; </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> ctx = useContext&lt;HttpContext&gt;();</span><br><span class="line">  ctx.set(&#123;</span><br><span class="line">    Connection: <span class="string">'keep-alive'</span>,</span><br><span class="line">    <span class="string">'Cache-Control'</span>: <span class="string">'no-cache'</span>,</span><br><span class="line">    <span class="string">'Content-Type'</span>: <span class="string">'application/octet-stream'</span> <span class="comment">// è¡¨ç¤ºè¿”å›æ•°æ®æ˜¯ä¸ª stream</span></span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="keyword">const</span> stream = <span class="keyword">new</span> PassThrough();</span><br><span class="line">  ctx.body = stream;</span><br><span class="line">  <span class="comment">// å‘èµ·ç¬¬ä¸‰æ–¹è¯·æ±‚</span></span><br><span class="line">  <span class="keyword">const</span> headers = &#123;</span><br><span class="line">    <span class="string">'Content-Type'</span>: <span class="string">'application/json'</span></span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="keyword">const</span> url = <span class="string">'http://vvvv.xxxx.net/aiBot/oncall_response_stream'</span>;</span><br><span class="line">  axios</span><br><span class="line">    .post(url, ctx.request.body, &#123; <span class="attr">headers</span>: headers, <span class="attr">responseType</span>: <span class="string">'stream'</span> &#125;)</span><br><span class="line">    .then(<span class="function">(<span class="params">response</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (response.status !== <span class="number">200</span>) &#123;</span><br><span class="line">        <span class="built_in">console</span>.error(<span class="string">'Error status:'</span>, response.status);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      response.data.on(<span class="string">'data'</span>, (chunk) =&gt; &#123;</span><br><span class="line">        chunk</span><br><span class="line">          .toString()</span><br><span class="line">          .split(<span class="string">'\n\n'</span>)</span><br><span class="line">          .filter(<span class="function">(<span class="params">item</span>) =&gt;</span> item)</span><br><span class="line">          .forEach(<span class="function">(<span class="params">chunkStr</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">let</span> chunkJson = &#123;&#125;;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">              chunkJson = <span class="built_in">JSON</span>.parse(chunkStr);</span><br><span class="line">            &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">              <span class="built_in">console</span>.error(<span class="string">'Error parse:'</span>, error);</span><br><span class="line">              <span class="built_in">console</span>.error(<span class="string">'Error chunkStr:'</span>, chunkStr);</span><br><span class="line">              <span class="built_in">console</span>.error(<span class="string">'Error origin chunk:'</span>, chunk.toString());</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (chunkJson?.data?.chunk) &#123;</span><br><span class="line">              <span class="comment">// æ‹¿åˆ°æœ‰æ•ˆæ•°æ®åï¼Œä¼ ç»™å‰ç«¯</span></span><br><span class="line">              stream.write(chunkJson.data.chunk);</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;);</span><br><span class="line">      &#125;);</span><br><span class="line">      response.data.on(<span class="string">'end'</span>, () =&gt; &#123;</span><br><span class="line">        <span class="comment">// ç¬¬ä¸‰æ–¹è¯·æ±‚æµç»“æŸåï¼Œå…³é—­å‘å‰ç«¯å†™çš„æµ</span></span><br><span class="line">        stream.end();</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;)</span><br><span class="line">    .catch(<span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="built_in">console</span>.error(<span class="string">'Error all:'</span>, error);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="å‰ç«¯å±‚å®ç°"><a href="#å‰ç«¯å±‚å®ç°" class="headerlink" title="å‰ç«¯å±‚å®ç°"></a>å‰ç«¯å±‚å®ç°</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line">  <span class="keyword">import</span> &#123; useState, useCallback, useRef &#125; <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> [listLoading, setListLoading] = useState(<span class="number">0</span>);</span><br><span class="line">  <span class="keyword">const</span> [hasReport, setHasReport] = useState(<span class="number">-1</span>);</span><br><span class="line">  <span class="keyword">const</span> [AiRemoteData, setAIRemoteData] = useState(<span class="string">''</span>);</span><br><span class="line">  <span class="keyword">const</span> AiRequestController = useRef();</span><br><span class="line">  <span class="keyword">const</span> &#123; addThrottle &#125; = useThrottleFunc();</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ‹‰å–Ai å›ç­”</span></span><br><span class="line">  <span class="keyword">const</span> getAIRemoteData = useCallback(</span><br><span class="line">    addThrottle(</span><br><span class="line">      <span class="keyword">async</span> () =&gt; &#123;</span><br><span class="line">        <span class="keyword">const</span> &#123; keyWord &#125; = query;</span><br><span class="line">        <span class="keyword">if</span> (!keyWord) &#123;</span><br><span class="line">          <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">          setListLoading(<span class="function">(<span class="params">val</span>) =&gt;</span> val + <span class="number">1</span>);</span><br><span class="line">          <span class="keyword">if</span> (AiRequestController.current) &#123;</span><br><span class="line">            <span class="comment">// å¦‚æœå½“å‰è¯·æ±‚å­˜åœ¨ï¼Œåˆ™å–æ¶ˆå½“å‰è¯·æ±‚</span></span><br><span class="line">            AiRequestController.current.abort();</span><br><span class="line">          &#125;</span><br><span class="line">          AiRequestController.current = <span class="keyword">new</span> AbortController();</span><br><span class="line">          <span class="keyword">const</span> jwtToken = <span class="keyword">await</span> getJwt();</span><br><span class="line">          <span class="comment">// 1. åˆ›å»ºä¸€ä¸ªæ–°çš„è¯·æ±‚</span></span><br><span class="line">          <span class="keyword">const</span> response = <span class="keyword">await</span> fetch(</span><br><span class="line">            <span class="string">`https://hahahaha.net/api/diagnosisBasic/faqStream`</span>,</span><br><span class="line">            &#123;</span><br><span class="line">              method: <span class="string">'POST'</span>,</span><br><span class="line">              body: <span class="built_in">JSON</span>.stringify(&#123;</span><br><span class="line">                user_id: userInfo.id,</span><br><span class="line">                query: keyWord,</span><br><span class="line">                class: ''</span><br><span class="line">              &#125;),</span><br><span class="line">              headers: &#123;</span><br><span class="line">                <span class="string">'x-jwt-token'</span>: jwtToken</span><br><span class="line">              &#125;,</span><br><span class="line">              signal: AiRequestController.current.signal</span><br><span class="line">            &#125;</span><br><span class="line">          );</span><br><span class="line">          <span class="keyword">const</span> reader = response.body.getReader(); <span class="comment">// è·å–reader</span></span><br><span class="line">          <span class="keyword">const</span> decoder = <span class="keyword">new</span> TextDecoder(); <span class="comment">// æ–‡æœ¬è§£ç å™¨</span></span><br><span class="line">          <span class="keyword">let</span> answer = <span class="string">''</span>; <span class="comment">// å­˜å‚¨ç­”æ¡ˆ</span></span><br><span class="line">          <span class="comment">// 2. å¾ªç¯å–å€¼</span></span><br><span class="line">          <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">            <span class="comment">// å–å€¼, value æ˜¯åç«¯è¿”å›æµä¿¡æ¯, done è¡¨ç¤ºåç«¯ç»“æŸæµçš„è¾“å‡º</span></span><br><span class="line">            <span class="keyword">const</span> &#123; value, done &#125; = <span class="keyword">await</span> reader.read();</span><br><span class="line">            <span class="keyword">if</span> (done) &#123;</span><br><span class="line">              <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// å¯¹ value è¿›è¡Œè§£ç </span></span><br><span class="line">            <span class="keyword">const</span> val = decoder.decode(value);</span><br><span class="line">            <span class="keyword">if</span> (!answer) &#123;</span><br><span class="line">              setListLoading(<span class="function">(<span class="params">count</span>) =&gt;</span> count - <span class="number">1</span>);</span><br><span class="line">              setHasReport(<span class="number">-1</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            answer += val;</span><br><span class="line">            setAIRemoteData(answer);</span><br><span class="line">          &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> &#123;</span><br><span class="line">          setAIRemoteData(<span class="string">''</span>);</span><br><span class="line">          <span class="built_in">console</span>.error(<span class="string">'æ•°æ®è§£æå‡ºé”™'</span>);</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">          setListLoading(<span class="function">(<span class="params">val</span>) =&gt;</span> val - <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="number">500</span>,</span><br><span class="line">      <span class="string">'getAIRemoteData'</span></span><br><span class="line">    ),</span><br><span class="line">    [query.keyWord]</span><br><span class="line">  );</span><br></pre></td></tr></table></figure>
<h3 id="ç•ªå¤–-å…¨å±€èŠ‚æµå‡½æ•°"><a href="#ç•ªå¤–-å…¨å±€èŠ‚æµå‡½æ•°" class="headerlink" title="ç•ªå¤–: å…¨å±€èŠ‚æµå‡½æ•°"></a>ç•ªå¤–: å…¨å±€èŠ‚æµå‡½æ•°</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> throttleTimerList: &#123; [key: string]: Timeout | <span class="literal">null</span> &#125; = &#123;&#125;;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> useThrottleFunc = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> timer = useRef();</span><br><span class="line">  <span class="keyword">const</span> addThrottle = (</span><br><span class="line">    fn: <span class="function">(<span class="params">params?: LooseObject | <span class="literal">undefined</span></span>) =&gt;</span> <span class="keyword">void</span>,</span><br><span class="line">    waitTime?: number,</span><br><span class="line">    timerKey?: string</span><br><span class="line">  ) =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> timerFlag = timerKey || <span class="string">'getRemoteData'</span>;</span><br><span class="line">    throttleTimerList[timerFlag] = <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="function">(<span class="params">params?: LooseObject | <span class="literal">undefined</span></span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (throttleTimerList[timerFlag]) &#123;</span><br><span class="line">        clearTimeout(throttleTimerList[timerFlag]);</span><br><span class="line">      &#125;</span><br><span class="line">      throttleTimerList[timerFlag] = setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">        fn(params);</span><br><span class="line">        clearTimeout(throttleTimerList[timerFlag]);</span><br><span class="line">        throttleTimerList[timerFlag] = <span class="literal">null</span>;</span><br><span class="line">      &#125;, waitTime || <span class="number">500</span>);</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  useEffect(</span><br><span class="line">    () =&gt; <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="built_in">Object</span>.keys(throttleTimerList).forEach(<span class="function">(<span class="params">key</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (throttleTimerList[key]) &#123;</span><br><span class="line">          clearTimeout(throttleTimerList[key]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">delete</span> throttleTimerList[key];</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;,</span><br><span class="line">    []</span><br><span class="line">  );</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    addThrottle,</span><br><span class="line">    throttleTimer: timer</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h1 id="ç›¸å…³çŸ¥è¯†é“¾æ¥"><a href="#ç›¸å…³çŸ¥è¯†é“¾æ¥" class="headerlink" title="ç›¸å…³çŸ¥è¯†é“¾æ¥"></a>ç›¸å…³çŸ¥è¯†é“¾æ¥</h1><p><a href="https://nodejs.cn/api/webstreams.html#%E7%A4%BA%E4%BE%8B-readablestream" target="_blank" rel="noopener">NODE-Stream</a><br><a href="https://nodejs.cn/api/webstreams.html#%E7%A4%BA%E4%BE%8B-readablestream" target="_blank" rel="noopener">NODE-ReadableStream</a><br><a href="https://developer.mozilla.org/zh-CN/docs/Web/API/ReadableStream" target="_blank" rel="noopener">ReadableStream</a><br><a href="https://juejin.cn/post/7211401380770349115" target="_blank" rel="noopener">application/octet-stream vs text/event-stream</a><br><a href="https://developer.mozilla.org/zh-CN/docs/Web/API/AbortController" target="_blank" rel="noopener">AbortController</a><br><a href="https://juejin.cn/post/7329884027186724901" target="_blank" rel="noopener">fetchè·å–æµå¼æ•°æ®ç›¸å…³é—®é¢˜</a><br><a href="https://juejin.cn/post/7212270321622286394#heading-7" target="_blank" rel="noopener">åœ¨ Koa ä¸­åŸºäº gpt-3.5 æ¨¡å‹å®ç°ä¸€ä¸ªæœ€åŸºæœ¬çš„æµå¼é—®ç­” DEMO</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://yoohannah.github.io/post/deepLearning/NeuralNetwork.html">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="YooHannah">
    <meta itemprop="description" content>
    <meta itemprop="image" content="/psb.jpg">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="My Little World">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="My Little World" src>
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/post/deepLearning/NeuralNetwork.html" itemprop="url">
                  ç¥ç»ç½‘ç»œçš„ç›¸å…³æ¨å¯¼å…¬å¼
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2024-12-01T21:24:37+08:00">
                2024-12-01
              </time>
            

            

            
          </span>

          

          
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="çŸ©é˜µç»´åº¦"><a href="#çŸ©é˜µç»´åº¦" class="headerlink" title="çŸ©é˜µç»´åº¦"></a>çŸ©é˜µç»´åº¦</h1><p>ä¸ºæ–¹ä¾¿é‡å¤è®¡ç®—ï¼Œå‡å°‘forå¾ªç¯çš„ä½¿ç”¨ï¼Œåœ¨ç¥ç»ç½‘ç»œçš„è®¡ç®—è¿‡ç¨‹ä¸­ï¼Œå°½å¯èƒ½çš„å°†æ•°æ®è½¬æˆå‘é‡è¿›è¡Œè®¡ç®—<br>åˆ©ç”¨å‘é‡çš„å¹¿æ’­èƒ½åŠ›è¿›è¡Œå¿«é€Ÿè®¡ç®—ï¼Œç¥ç»ç½‘ç»œå¤šå±‚ä¼ é€’è¿‡ç¨‹ä¸­ï¼ŒçŸ©é˜µçš„ç»´åº¦ä¸€èˆ¬éµå¾ªä»¥ä¸‹å…³ç³»</p>
<p>å¦‚æœå‰ä¸€å±‚ï¼ˆè¾“å…¥ï¼‰ç»´åº¦ä¸ºï¼ˆm,1ï¼‰ï¼Œä¸­é—´å±‚ç»´åº¦æ˜¯ï¼ˆn, 1ï¼‰, åä¸€å±‚ï¼ˆè¾“å‡ºï¼‰ç»´åº¦æ˜¯ï¼ˆpï¼Œ 1ï¼‰<br>é‚£ä¹ˆ ä¸­é—´å±‚wçš„ç»´åº¦å°±æ˜¯ï¼ˆn, mï¼‰ï¼Œ b çš„ç»´åº¦å°±æ˜¯ï¼ˆnï¼Œ1ï¼‰, b çš„ç»´åº¦å§‹ç»ˆå’Œä¸­é—´å±‚ä¸€è‡´<br>è¾“å‡ºå±‚Wçš„ç»´åº¦ï¼ˆp,nï¼‰ï¼Œb çš„ç»´åº¦å°±æ˜¯(p,1)</p>
<p><img src="/image/deepLearning/11.png" alt></p>
<h3 id="å‚æ•°çš„çŸ©é˜µç»´åº¦å…³ç³»"><a href="#å‚æ•°çš„çŸ©é˜µç»´åº¦å…³ç³»" class="headerlink" title="å‚æ•°çš„çŸ©é˜µç»´åº¦å…³ç³»"></a>å‚æ•°çš„çŸ©é˜µç»´åº¦å…³ç³»</h3><p><img src="/image/deepLearning/28.png" alt></p>
<h1 id="å‘å‰ä¼ æ’­è®¡ç®—è¿‡ç¨‹"><a href="#å‘å‰ä¼ æ’­è®¡ç®—è¿‡ç¨‹" class="headerlink" title="å‘å‰ä¼ æ’­è®¡ç®—è¿‡ç¨‹"></a>å‘å‰ä¼ æ’­è®¡ç®—è¿‡ç¨‹</h1><h2 id="ä¸€ä¸ªç¥ç»å…ƒçš„è®¡ç®—"><a href="#ä¸€ä¸ªç¥ç»å…ƒçš„è®¡ç®—" class="headerlink" title="ä¸€ä¸ªç¥ç»å…ƒçš„è®¡ç®—"></a>ä¸€ä¸ªç¥ç»å…ƒçš„è®¡ç®—</h2><p>æ¯ä¸ªç¥ç»å…ƒçš„è®¡ç®—åŒ…æ‹¬ä¸¤éƒ¨åˆ†ï¼Œå…ˆè®¡ç®—z,åœ¨ç”¨æ¿€æ´»å‡½æ•°è®¡ç®—a,<br>åŒä¸€å±‚ä¸åŒç¥ç»å…ƒè®¡ç®—çš„åŒºåˆ«å°±åœ¨äºä½¿ç”¨ä¸åŒçš„å‚æ•°<br><img src="/image/deepLearning/12.png" alt><br>å¦‚æœå°†å‚æ•°wå’Œbæ•´ç†æˆå‘é‡ï¼Œå¯¹å½“å‰æ ·æœ¬æ•°æ®è¿›è¡Œä¸€æ¬¡æ€§å‘é‡è®¡ç®—<br>å°±å¯ä»¥ç›´æ¥å¾—åˆ°å½“å‰å±‚çš„ç›´æ¥äº§å‡ºå‘é‡<br><img src="/image/deepLearning/13.png" alt></p>
<h2 id="ä¸€å±‚ç¥ç»å…ƒçš„è®¡ç®—"><a href="#ä¸€å±‚ç¥ç»å…ƒçš„è®¡ç®—" class="headerlink" title="ä¸€å±‚ç¥ç»å…ƒçš„è®¡ç®—"></a>ä¸€å±‚ç¥ç»å…ƒçš„è®¡ç®—</h2><p>åŒæ ·ï¼Œæ¯ä¸€å±‚éƒ½å¯ä»¥ç”¨ç›¸åŒçš„è®¡ç®—å¼è¡¨ç¤º<br><img src="/image/deepLearning/14.png" alt></p>
<h2 id="ä¸€ç»„æ ·æœ¬æ•°æ®çš„è®¡ç®—"><a href="#ä¸€ç»„æ ·æœ¬æ•°æ®çš„è®¡ç®—" class="headerlink" title="ä¸€ç»„æ ·æœ¬æ•°æ®çš„è®¡ç®—"></a>ä¸€ç»„æ ·æœ¬æ•°æ®çš„è®¡ç®—</h2><p>é€šè¿‡for å¾ªç¯è¿›è¡Œæ¯ä¸€å±‚çš„è®¡ç®—å¯å¾—åˆ°æ‰€æœ‰æ ·æœ¬æ•°æ®çš„é¢„æµ‹æ•°æ®y^<br><img src="/image/deepLearning/15.png" alt><br>ä½†æ˜¯é€šè¿‡å°†è¾“å…¥å±‚ç»´åº¦(m,1) çš„å‘é‡å¢åŠ ä¸ºï¼ˆm,xï¼‰çš„å‘é‡ï¼Œå¯ä»¥å®ç°ä¸€æ¬¡è®¡ç®—xä¸ªæ ·æœ¬çš„æ•ˆæœï¼Œä»è€Œå»æ‰forå¾ªç¯<br>å¦‚æœä¸­é—´å±‚æœ‰nä¸ªç¥ç»å…ƒï¼Œè¾“å‡ºå¾—åˆ°çš„ç»“æœå°±æ˜¯(n,x)çš„çŸ©é˜µ<br>ç¬¬n - 1è¡Œ ä¸Šçš„xä¸ªæ•°ï¼Œæ¯ä¸ªæ•°ä»£è¡¨æ¯ä¸ªæ ·æœ¬æ•°æ®åœ¨ä¸­é—´å±‚ç¬¬n-1ä¸ªç¥ç»å…ƒçš„è®¡ç®—åçš„å€¼<br>ç¬¬x - 1åˆ— ä¸Šçš„nä¸ªæ•°ï¼Œæ¯ä¸ªæ•°ä»£è¡¨ç¬¬x-iä¸ªæ ·æœ¬æ•°æ®åœ¨ä¸­é—´å±‚è®¡ç®—åçš„æ¯ä¸ªç¥ç»å…ƒçš„å€¼<br><img src="/image/deepLearning/16.png" alt><br>æœ€ç»ˆç»è¿‡ä¸¤å±‚ç¥ç»å…ƒå¤„ç†åå˜æˆï¼Œç»“æœå˜æˆ(1,x)çš„å‘é‡ï¼Œæ¯ä¸ªå€¼ä»£è¡¨æ¯ä¸ªæ ·æœ¬ç»è¿‡ç¥ç»ç½‘ç»œè®¡ç®—åçš„é¢„æµ‹å€¼</p>
<h3 id="è¾“å…¥è¾“å‡ºå€¼çŸ©é˜µç»´åº¦ä¹‹é—´çš„å…³ç³»"><a href="#è¾“å…¥è¾“å‡ºå€¼çŸ©é˜µç»´åº¦ä¹‹é—´çš„å…³ç³»" class="headerlink" title="è¾“å…¥è¾“å‡ºå€¼çŸ©é˜µç»´åº¦ä¹‹é—´çš„å…³ç³»"></a>è¾“å…¥è¾“å‡ºå€¼çŸ©é˜µç»´åº¦ä¹‹é—´çš„å…³ç³»</h3><p><img src="/image/deepLearning/29.png" alt></p>
<h2 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h2><p><img src="/image/deepLearning/17.png" alt></p>
<h1 id="å…¶ä»–æ¿€æ´»å‡½æ•°"><a href="#å…¶ä»–æ¿€æ´»å‡½æ•°" class="headerlink" title="å…¶ä»–æ¿€æ´»å‡½æ•°"></a>å…¶ä»–æ¿€æ´»å‡½æ•°</h1><p>é™¤äº†sigmoid æ¿€æ´»å‡½æ•°å¤–ï¼Œå¸¸è§çš„æ¿€æ´»å‡½æ•°è¿˜æœ‰Tanh, ReLu,å’Œleaky ReLu,<br>åä¸‰è€…æ›´å¸¸è§ï¼Œä¸”ä½¿ç”¨æ›´å¹¿æ³›ï¼ŒsigmoidåŸºæœ¬åªç”¨äºäºŒåˆ†ç±»åœºæ™¯<br><img src="/image/deepLearning/18.png" alt></p>
<h2 id="ä¸ºä»€ä¹ˆä¸ä½¿ç”¨çº¿æ€§å‡½æ•°ä½œä¸ºæ¿€æ´»å‡½æ•°"><a href="#ä¸ºä»€ä¹ˆä¸ä½¿ç”¨çº¿æ€§å‡½æ•°ä½œä¸ºæ¿€æ´»å‡½æ•°" class="headerlink" title="ä¸ºä»€ä¹ˆä¸ä½¿ç”¨çº¿æ€§å‡½æ•°ä½œä¸ºæ¿€æ´»å‡½æ•°"></a>ä¸ºä»€ä¹ˆä¸ä½¿ç”¨çº¿æ€§å‡½æ•°ä½œä¸ºæ¿€æ´»å‡½æ•°</h2><p>å› ä¸ºå¦‚æœä½¿ç”¨çº¿æ€§å‡½æ•°ä½œä¸ºæ¿€æ´»å‡½æ•°ï¼Œæ— è®ºç¥ç»ç½‘ç»œæœ‰å¤šå°‘å±‚ï¼Œéƒ½ç›¸å½“äºåªè¿›è¡Œäº†ä¸€æ¬¡çº¿æ€§å‡½æ•°è®¡ç®—ï¼Œéšè—å±‚ä½œç”¨æ¶ˆå¤±<br><img src="/image/deepLearning/19.png" alt></p>
<h2 id="ä¸åŒæ¿€æ´»å‡½æ•°çš„å¯¼æ•°"><a href="#ä¸åŒæ¿€æ´»å‡½æ•°çš„å¯¼æ•°" class="headerlink" title="ä¸åŒæ¿€æ´»å‡½æ•°çš„å¯¼æ•°"></a>ä¸åŒæ¿€æ´»å‡½æ•°çš„å¯¼æ•°</h2><p><img src="/image/deepLearning/20.png" alt><br><img src="/image/deepLearning/21.png" alt><br><img src="/image/deepLearning/22.png" alt></p>
<h1 id="å‘åä¼ æ’­è¿‡ç¨‹"><a href="#å‘åä¼ æ’­è¿‡ç¨‹" class="headerlink" title="å‘åä¼ æ’­è¿‡ç¨‹"></a>å‘åä¼ æ’­è¿‡ç¨‹</h1><p>å›é¡¾ä¸€ä¸‹æ¢¯åº¦ä¸‹é™çš„è®¡ç®—è¿‡ç¨‹<br><img src="/image/deepLearning/24.png" alt><br>å¯¹äºå•ä¸ªç¥ç»å…ƒçš„å‘åä¼ æ’­è¿‡ç¨‹ï¼Œå°±æ˜¯è®¡ç®—å•ä¸ªç¥ç»å…ƒå‚æ•°åå¯¼æ•°çš„è¿‡ç¨‹<br><img src="/image/deepLearning/23.png" alt></p>
<p>å¯¹äºå¤šå±‚çš„ç¥ç»ç½‘ç»œè¿›è¡Œå¸¦å…¥<br><img src="/image/deepLearning/25.png" alt></p>
<h2 id="å°ç»“-1"><a href="#å°ç»“-1" class="headerlink" title="å°ç»“"></a>å°ç»“</h2><p>åŒå‘å‰ä¼ æ’­ä¸€æ ·ï¼Œé€šè¿‡å¼•å…¥å‘é‡çŸ©é˜µï¼Œå‡å°‘forå¾ªç¯<br><img src="/image/deepLearning/26.png" alt></p>
<h1 id="ä¸ºå•¥ä¸èƒ½åˆå§‹åŒ–å‚æ•°ä¸º0ï¼Ÿ"><a href="#ä¸ºå•¥ä¸èƒ½åˆå§‹åŒ–å‚æ•°ä¸º0ï¼Ÿ" class="headerlink" title="ä¸ºå•¥ä¸èƒ½åˆå§‹åŒ–å‚æ•°ä¸º0ï¼Ÿ"></a>ä¸ºå•¥ä¸èƒ½åˆå§‹åŒ–å‚æ•°ä¸º0ï¼Ÿ</h1><p>å¦‚æœåˆå§‹åŒ–å‚æ•°ä¸º0æˆ–ç›¸åŒå€¼ï¼Œé‚£ä¹ˆæ‰€æœ‰èŠ‚ç‚¹è®¡ç®—çš„å€¼éƒ½ç›¸åŒï¼Œä¼šäº§ç”Ÿå¯¹ç§°æ€§ï¼Œå¯¹åç»­è®¡ç®—çš„å½±å“ä¹Ÿç›¸åŒï¼ŒåŒæ ·ä¼šå¯¼è‡´éšè—å±‚èŠ‚ç‚¹ç»“ç®—æ— æ•ˆ<br>è§£å†³åŠæ³•å°±æ˜¯éšæœºåˆå§‹åŒ–å‚æ•°<br><img src="/image/deepLearning/27.png" alt><br>ä¸€èˆ¬ä¸€å¼€å§‹ä¼šå°†å‚æ•°éšæœºæˆæ¯”è¾ƒå°çš„å€¼ï¼Œå¦‚æœä¸€å¼€å§‹æ˜¯æ¯”è¾ƒå¤§çš„å€¼ï¼Œz çš„å€¼å°±ä¼šæ¯”è¾ƒå¤§ï¼Œ<br>å½“æ¿€æ´»å‡½æ•°æ˜¯sigmoid æˆ–è€…tanh è¿™æ ·çš„æ¿€æ´»å‡½æ•°æ—¶ï¼Œ<br>è®¡ç®—ç»“æœæ‰€åœ¨çš„ä½ç½®å°±ä¼šåœ¨æ¢¯åº¦æ¯”è¾ƒå¹³ç¼“çš„åœ°æ–¹å¯¼è‡´ï¼Œæ¿€æ´»å‡½æ•°å¤„äºæ¯”è¾ƒé¥±å’Œçš„çŠ¶æ€ï¼Œæ¢¯åº¦ä¸‹é™æ¯”è¾ƒæ…¢ï¼Œå½±å“å­¦ä¹ é€Ÿåº¦</p>
<h1 id="æ·±åº¦ç½‘ç»œ"><a href="#æ·±åº¦ç½‘ç»œ" class="headerlink" title="æ·±åº¦ç½‘ç»œ"></a>æ·±åº¦ç½‘ç»œ</h1><h2 id="å‘å‰ä¼ æ’­"><a href="#å‘å‰ä¼ æ’­" class="headerlink" title="å‘å‰ä¼ æ’­"></a>å‘å‰ä¼ æ’­</h2><p><img src="/image/deepLearning/30.png" alt></p>
<h2 id="å‘åä¼ æ’­"><a href="#å‘åä¼ æ’­" class="headerlink" title="å‘åä¼ æ’­"></a>å‘åä¼ æ’­</h2><p><img src="/image/deepLearning/31.png" alt></p>
<h2 id="ä¸€äº›è¶…å‚æ•°"><a href="#ä¸€äº›è¶…å‚æ•°" class="headerlink" title="ä¸€äº›è¶…å‚æ•°"></a>ä¸€äº›è¶…å‚æ•°</h2><p><img src="/image/deepLearning/32.png" alt></p>
<h2 id="å°ç»“-2"><a href="#å°ç»“-2" class="headerlink" title="å°ç»“"></a>å°ç»“</h2><p><img src="/image/deepLearning/33.png" alt></p>
<h3 id="ä¸ºä»€ä¹ˆè¦ä½¿ç”¨æ·±å±‚ç½‘ç»œ"><a href="#ä¸ºä»€ä¹ˆè¦ä½¿ç”¨æ·±å±‚ç½‘ç»œ" class="headerlink" title="ä¸ºä»€ä¹ˆè¦ä½¿ç”¨æ·±å±‚ç½‘ç»œ"></a>ä¸ºä»€ä¹ˆè¦ä½¿ç”¨æ·±å±‚ç½‘ç»œ</h3><p>ä½¿ç”¨å°çš„ï¼ˆå•å±‚ç¥ç»å…ƒæ•°æ®é‡å°‘çš„ï¼‰çš„ä½†æ˜¯æœ‰å¤šå±‚çš„æ·±å±‚ç½‘ç»œï¼Œå¾€å¾€ä¼šæ¯”ä½¿ç”¨æµ…å±‚(layeræ•°å°‘)ç½‘ç»œè®¡ç®—æ­¥éª¤æ›´ç®€æ´<br>æ¯”å¦‚ä¸‹é¢çš„ç”µè·¯ä¸æˆ–éé—¨è®¡ç®—è¿‡ç¨‹<br>å¦‚æœåƒå·¦ä¾§ä½¿ç”¨æ·±å±‚ç½‘ç»œï¼Œæ¯ä¸€æ¬¡å±‚ç¥ç»å…ƒéƒ½å°‘ä¸€åŠ<br>å¦‚æœä½¿ç”¨å³ä¾§å•å±‚ç¥ç»ç½‘ç»œï¼Œè¿™ä¸€å±‚ä¸Šçš„ç¥ç»å…ƒä¼šä»¥2çš„æŒ‡æ•°æ–¹å¼è®¡ç®—<br>æ€»ä½“ç®—ä¸‹æ¥ï¼Œæ·±å±‚ç½‘ç»œéœ€è¦å¤„ç†çš„ç¥ç»å…ƒä¼šå°‘å¾ˆå¤š</p>
<p><img src="/image/deepLearning/34.png" alt></p>
<h1 id="å®éªŒç»ƒä¹ "><a href="#å®éªŒç»ƒä¹ " class="headerlink" title="å®éªŒç»ƒä¹ "></a>å®éªŒç»ƒä¹ </h1><h2 id="é€»è¾‘å›å½’å…¨è¿‡ç¨‹"><a href="#é€»è¾‘å›å½’å…¨è¿‡ç¨‹" class="headerlink" title="é€»è¾‘å›å½’å…¨è¿‡ç¨‹"></a>é€»è¾‘å›å½’å…¨è¿‡ç¨‹</h2><p><a href="https://github.com/GeeeekExplorer/AndrewNg-Deep-Learning/blob/master/Neural%20Networks%20and%20Deep%20Learning/Week%202/Logistic%20Regression%20as%20a%20Neural%20Network/Logistic%20Regression%20with%20a%20Neural%20Network%20mindset%20Solution.ipynb" target="_blank" rel="noopener">gitbub[ipynb]é“¾æ¥</a><br><a href="https://colab.research.google.com/github/GeeeekExplorer/AndrewNg-Deep-Learning/blob/master/Neural%20Networks%20and%20Deep%20Learning/Week%202/Logistic%20Regression%20as%20a%20Neural%20Network/Logistic%20Regression%20with%20a%20Neural%20Network%20mindset%20Solution.ipynb#scrollTo=OEOpKgClZLco" target="_blank" rel="noopener">å®éªŒ</a></p>
<h2 id="æ€è·¯æ¢³ç†"><a href="#æ€è·¯æ¢³ç†" class="headerlink" title="æ€è·¯æ¢³ç†"></a>æ€è·¯æ¢³ç†</h2><h2 id="æ•°æ®å¤„ç†"><a href="#æ•°æ®å¤„ç†" class="headerlink" title="æ•°æ®å¤„ç†"></a>æ•°æ®å¤„ç†</h2><h3 id="å‘é‡åŒ–"><a href="#å‘é‡åŒ–" class="headerlink" title="å‘é‡åŒ–"></a>å‘é‡åŒ–</h3><p>å®éªŒä¸­è¦å®ç°å¯¹ä¸€å¼ å›¾ç‰‡æ˜¯å¦æ˜¯çŒ«çš„åˆ¤æ–­ï¼Œ<br>é¦–å…ˆè¦å¯¹å›¾ç‰‡è¿›è¡Œå¤„ç†ï¼Œå°†å›¾ç‰‡è½¬æ¢æˆå‘é‡ï¼Œ<br>ä¸€ä¸ªåƒç´ ç‚¹ç”±RGBä¸‰ä¸ªæ•°æ®ç»„æˆ, ç°åœ¨å¦‚æœæ¨ªç«–éƒ½å–å›¾ç‰‡çš„64ä¸ªåƒç´ ç‚¹<br>ä¸€å¼ 64X64çš„å›¾ç‰‡å°±æœ‰64X64=4096ä¸ª [r,g,b] è¿™æ ·çš„æ•°æ®ï¼Œ<br>ä¸€å¼ å›¾ç‰‡çš„æ•°æ®è¡¨ç¤ºå°±æ˜¯</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[</span><br><span class="line">    [[196 192 190], [193 186 182],...ä¸­é—´è¿˜æœ‰61ç»„, [188 179 174]], æ¯ä¸€è¡Œ æœ‰64ä¸ª</span><br><span class="line">    [[196 192 190], [193 186 182],..., [188 179 174]],</span><br><span class="line">    ... ä¸­é—´æœ‰60è¡Œ</span><br><span class="line">    [[196 192 190], [193 186 182],..., [188 179 174]]</span><br><span class="line">    [[196 192 190], [193 186 182],..., [88 79 74]]</span><br><span class="line">] ä¸€å…±64è¡Œ</span><br></pre></td></tr></table></figure>
<p>ç°åœ¨æŠŠæ‰€æœ‰æ•°æ®æ‘Šå¹³å†è½¬ç½®ï¼Œå°±å¯è½¬æˆä¸€ä¸ª[64X64X3=12288, 1]çš„å‘é‡,<br>ä¹Ÿå°±æ˜¯mä¸ªæµ‹è¯•æ•°æ®ç»„æˆçš„çŸ©é˜µä¸­çš„ä¸€åˆ—</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[[196,], [192,],..., [88,], [79,],[74,]]</span><br></pre></td></tr></table></figure>
<p>A trick when you want to flatten a matrix X of shape (a,b,c,d) to a matrix X_flatten of shape (b âˆ— c âˆ— d, a) is to use:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">X_flatten = X.reshape(X.shape[0], -1).T</span><br></pre></td></tr></table></figure>
<p>ç°åœ¨æˆ‘ä»¬æœ‰209ä¸ªè®­ç»ƒæ•°æ®çš„è®­ç»ƒé›†train_set_x_origçš„ç»´åº¦æ˜¯(209, 64, 64, 3)<br>a å°±æ˜¯209<br>ç°å°†è¦å°†è®­ç»ƒé›†æ•°æ®ä¸€æ¬¡æ€§è½¬æˆ209åˆ—çš„å‘é‡<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">m_train = train_set_x_orig.shape[0] // 209</span><br><span class="line">train_set_x_flatten = train_set_x_orig.reshape(m_train, -1).T</span><br></pre></td></tr></table></figure></p>
<p>train_set_x_flatten ç°åœ¨çš„ç»´åº¦å°±æ˜¯(12288, 209)<br>æ¯ä¸€åˆ—æ˜¯ä¸€å¼ å›¾ç‰‡çš„åƒç´ æ•°æ®</p>
<h3 id="æ•°æ®ä¸­å¿ƒæ ‡å‡†åŒ–"><a href="#æ•°æ®ä¸­å¿ƒæ ‡å‡†åŒ–" class="headerlink" title="æ•°æ®ä¸­å¿ƒæ ‡å‡†åŒ–"></a>æ•°æ®ä¸­å¿ƒæ ‡å‡†åŒ–</h3><p>åŸºäºç°åœ¨å¤„ç†çš„æ˜¯å›¾ç‰‡çš„åƒç´ æ•°æ®ï¼Œæ‰€ä»¥æ‰€æœ‰çš„æ•°æ®è‚¯å®šéƒ½åœ¨0~255ä¹‹é—´</p>
<blockquote>
<p>One common preprocessing step in machine learning is to center and standardize your dataset,<br>meaning that you substract the mean of the whole numpy array from each example,<br>and then divide each example by the standard deviation of the whole numpy array.<br>But for picture datasets,<br>it is simpler and more convenient and works almost as well to just divide every row of the dataset by 255 (the maximum value of a pixel channel).</p>
</blockquote>
<p>ä¸€ä¸ªå¸¸è§çš„é¢„å¤„ç†æ­¥éª¤æ˜¯å°½å¯èƒ½å°†æ•°æ®èšæ‹¢åˆ°åæ ‡ç³»0é™„è¿‘ï¼Œå¸¸ç”¨çš„æ–¹æ³•æ˜¯å¯¹æ•°æ®è¿›è¡Œæ ‡å‡†åŒ–ï¼Œ<br>ä¹Ÿå°±æ˜¯å°†æ•°æ®å‡å»å‡å€¼ï¼Œç„¶åå°†æ•°æ®é™¤ä»¥æ ‡å‡†å·®<br>ä½†æ˜¯å¯¹äºå›¾ç‰‡æ•°æ®é›†æ¥è¯´ï¼Œ<br>é™¤ä»¥255ï¼ˆåƒç´ é€šé“çš„æœ€å¤§å€¼ï¼‰ï¼Œä¼šæ›´ç®€å•ï¼Œè€Œä¸”æ•ˆæœä¹Ÿå·®ä¸å¤š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">train_set_x = train_set_x_flatten / 255.</span><br></pre></td></tr></table></figure></p>
<h3 id="å°ç»“-3"><a href="#å°ç»“-3" class="headerlink" title="å°ç»“"></a>å°ç»“</h3><blockquote>
<p>What you need to remember:<br>Common steps for pre-processing a new dataset are:<br>Figure out the dimensions and shapes of the problem (m_train, m_test, num_px, â€¦)<br>Reshape the datasets such that each example is now a vector of size (num_px <em> num_px </em> 3, 1)<br>â€œStandardizeâ€ the data</p>
</blockquote>
<p>å¸¸è§çš„æ•°æ®é¢„å¤„ç†æ­¥éª¤ï¼š</p>
<ol>
<li>ç¡®å®šé—®é¢˜çš„ç»´åº¦å’Œå½¢çŠ¶ï¼ˆm_train, m_test, num_px, â€¦ï¼‰</li>
<li>å°†æ•°æ®é›†é‡æ–°ç»„ç»‡æˆæ¯ä¸ªç¤ºä¾‹éƒ½æ˜¯å¤§å°ä¸ºï¼ˆnum_px <em> num_px </em> 3, 1ï¼‰çš„å‘é‡</li>
<li>æ ‡å‡†åŒ–æ•°æ®</li>
</ol>
<h2 id="æ„å»ºæ¨¡å‹"><a href="#æ„å»ºæ¨¡å‹" class="headerlink" title="æ„å»ºæ¨¡å‹"></a>æ„å»ºæ¨¡å‹</h2><blockquote>
<p>The main steps for building a Neural Network are:</p>
</blockquote>
<blockquote>
<p>Define the model structure (such as number of input features)<br>Initialize the modelâ€™s parameters<br>Loop:<br>Calculate current loss (forward propagation)<br>Calculate current gradient (backward propagation)<br>Update parameters (gradient descent)<br>You often build 1-3 separately and integrate them into one function we call model().</p>
</blockquote>
<p>æ„å»ºä¸€ä¸ªç¥ç»ç½‘ç»œæ¨¡å‹çš„ä¸»è¦æ­¥éª¤ï¼š</p>
<ol>
<li>å®šä¹‰æ¨¡å‹ç»“æ„ï¼ˆä¾‹å¦‚è¾“å…¥ç‰¹å¾çš„æ•°é‡,è¿™é‡Œæ˜¯ä¸€å¼ å›¾ç‰‡çš„12288ä¸ªrgbæ•°æ®ï¼‰</li>
<li>åˆå§‹åŒ–æ¨¡å‹çš„å‚æ•°</li>
<li>å¾ªç¯ï¼š<br> è®¡ç®—å½“å‰æŸå¤±ï¼ˆå‰å‘ä¼ æ’­ï¼‰<br> è®¡ç®—å½“å‰æ¢¯åº¦ï¼ˆåå‘ä¼ æ’­ï¼‰<br> æ›´æ–°å‚æ•°ï¼ˆæ¢¯åº¦ä¸‹é™ï¼‰<br>é€šå¸¸ä¼šå°†1-3åˆ†åˆ«æ„å»º, ç„¶åå°†å®ƒä»¬é›†æˆåˆ°ä¸€ä¸ªå‡½æ•°ä¸­ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸ºmodel()ã€‚<br><img src="/image/deepLearning/LogReg_kiank.png" alt></li>
</ol>
<h3 id="ğ‘ ğ‘–ğ‘”ğ‘šğ‘œğ‘–ğ‘‘å‡½æ•°å®ç°"><a href="#ğ‘ ğ‘–ğ‘”ğ‘šğ‘œğ‘–ğ‘‘å‡½æ•°å®ç°" class="headerlink" title="ğ‘ ğ‘–ğ‘”ğ‘šğ‘œğ‘–ğ‘‘å‡½æ•°å®ç°"></a>ğ‘ ğ‘–ğ‘”ğ‘šğ‘œğ‘–ğ‘‘å‡½æ•°å®ç°</h3><p>ğ‘ ğ‘–ğ‘”ğ‘šğ‘œğ‘–ğ‘‘(ğ‘¤ğ‘‡ğ‘¥+ğ‘)=1/(1+ğ‘’âˆ’(ğ‘¤ğ‘‡ğ‘¥+ğ‘))<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&quot;&quot;&quot;</span><br><span class="line">    Compute the sigmoid of z</span><br><span class="line">    Arguments:</span><br><span class="line">    z -- A scalar or numpy array of any size.</span><br><span class="line">    Return:</span><br><span class="line">    s -- sigmoid(z)</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line">def sigmoid(z):</span><br><span class="line">    s = 1/(1+np.exp(-z))</span><br><span class="line">    return s</span><br></pre></td></tr></table></figure></p>
<h3 id="åˆå§‹åŒ–æ¨¡å‹çš„å‚æ•°"><a href="#åˆå§‹åŒ–æ¨¡å‹çš„å‚æ•°" class="headerlink" title="åˆå§‹åŒ–æ¨¡å‹çš„å‚æ•°"></a>åˆå§‹åŒ–æ¨¡å‹çš„å‚æ•°</h3><p>ç”¨0æ¥åˆå§‹åŒ–å‚æ•°<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&quot;&quot;&quot;</span><br><span class="line">This function creates a vector of zeros of shape (dim, 1) for w and initializes b to 0.</span><br><span class="line">Argument:</span><br><span class="line">dim -- num_px * num_px * 3</span><br><span class="line">Returns:</span><br><span class="line">w -- initialized vector of shape (dim, 1)</span><br><span class="line">b -- initialized scalar (corresponds to the bias)</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line">def initialize_with_zeros(dim):</span><br><span class="line">    w = np.zeros((dim, 1))</span><br><span class="line">    b = 0</span><br><span class="line">    return w, b</span><br><span class="line"></span><br><span class="line">## æµ‹è¯•</span><br><span class="line">dim = 2</span><br><span class="line">w, b = initialize_with_zeros(dim)</span><br><span class="line"></span><br><span class="line">==&gt;</span><br><span class="line">w = [[0.]</span><br><span class="line"> [0.]]</span><br><span class="line">b = 0.0</span><br></pre></td></tr></table></figure></p>
<h3 id="å‰å‘å‘åä¼ æ’­å®ç°"><a href="#å‰å‘å‘åä¼ æ’­å®ç°" class="headerlink" title="å‰å‘å‘åä¼ æ’­å®ç°"></a>å‰å‘å‘åä¼ æ’­å®ç°</h3><p>æ ¹æ®å…¬å¼è¿›è¡Œä»£ç å®ç°<br><img src="/image/deepLearning/35.png" alt><br>æœ€ç»ˆå¾—åˆ°æ¯è½®è®­ç»ƒçš„æŸå¤±å‡½æ•°å’Œæ¢¯åº¦</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"># GRADED FUNCTION: propagate</span><br><span class="line"></span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line">Implement the cost function and its gradient for the propagation explained above</span><br><span class="line"></span><br><span class="line">Arguments:</span><br><span class="line">w -- weights, a numpy array of size (num_px * num_px * 3, 1)</span><br><span class="line">b -- bias, a scalar</span><br><span class="line">X -- data of size (num_px * num_px * 3, number of examples)</span><br><span class="line">Y -- true &quot;label&quot; vector (containing 0 if non-cat, 1 if cat) of size (1, number of examples)</span><br><span class="line"></span><br><span class="line">Return:</span><br><span class="line">cost -- negative log-likelihood cost for logistic regression</span><br><span class="line">dw -- gradient of the loss with respect to w, thus same shape as w</span><br><span class="line">db -- gradient of the loss with respect to b, thus same shape as b</span><br><span class="line"></span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line"></span><br><span class="line">def propagate(w, b, X, Y):</span><br><span class="line">   </span><br><span class="line">    </span><br><span class="line">    m = X.shape[1]</span><br><span class="line">    </span><br><span class="line">    # FORWARD PROPAGATION (FROM X TO COST)</span><br><span class="line">    A = sigmoid(w.T @ X + b)                                    # compute activation å¾—åˆ° (m,1) çš„çŸ©é˜µA,m æ˜¯è®­ç»ƒé›†æ ·æœ¬æ•°</span><br><span class="line">    cost = -np.mean(Y * np.log(A) + (1 - Y) * np.log(1 - A))    # compute cost, åœ¨æŸäº› NumPy çš„ç‰¹å®šç‰ˆæœ¬æˆ–ä¸Šä¸‹æ–‡ä¸­, np.mean çš„è¾“å‡ºå¯èƒ½æ˜¯å½¢çŠ¶ä¸º (1,) çš„æ•°ç»„ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªçº¯æ ‡é‡</span><br><span class="line">    </span><br><span class="line">    # BACKWARD PROPAGATION (TO FIND GRAD)</span><br><span class="line">    dw = X @ (A - Y).T / m</span><br><span class="line">    db = np.mean(A - Y)</span><br><span class="line"></span><br><span class="line">    assert(dw.shape == w.shape)</span><br><span class="line">    assert(db.dtype == float)</span><br><span class="line">    cost = np.squeeze(cost) # ç§»é™¤å¤šä½™çš„å•ä¸€ç»´åº¦ï¼Œç¡®ä¿ cost æ˜¯æ ‡é‡</span><br><span class="line">    assert(cost.shape == ()) # è¿™é‡Œæ˜ç¡®è¦æ±‚ cost çš„å½¢çŠ¶æ˜¯ ()ï¼Œå³é›¶ç»´æ ‡é‡ã€‚å¦‚æœ cost æ˜¯ (1,)ï¼Œé‚£ä¹ˆä¼šè§¦å‘æ–­è¨€é”™è¯¯ã€‚</span><br><span class="line">    </span><br><span class="line">    grads = &#123;&quot;dw&quot;: dw,</span><br><span class="line">             &quot;db&quot;: db&#125;</span><br><span class="line">    </span><br><span class="line">    return grads, cost</span><br></pre></td></tr></table></figure>
<h3 id="æ¢¯åº¦ä¸‹é™å®ç°"><a href="#æ¢¯åº¦ä¸‹é™å®ç°" class="headerlink" title="æ¢¯åº¦ä¸‹é™å®ç°"></a>æ¢¯åº¦ä¸‹é™å®ç°</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line">&quot;&quot;&quot;</span><br><span class="line">This function optimizes w and b by running a gradient descent algorithm</span><br><span class="line"></span><br><span class="line">Arguments:</span><br><span class="line">w -- weights, a numpy array of size (num_px * num_px * 3, 1)</span><br><span class="line">b -- bias, a scalar</span><br><span class="line">X -- data of shape (num_px * num_px * 3, number of examples)</span><br><span class="line">Y -- true &quot;label&quot; vector (containing 0 if non-cat, 1 if cat), of shape (1, number of examples)</span><br><span class="line">num_iterations -- number of iterations of the optimization loop</span><br><span class="line">learning_rate -- learning rate of the gradient descent update rule</span><br><span class="line">print_cost -- True to print the loss every 100 steps</span><br><span class="line"></span><br><span class="line">Returns:</span><br><span class="line">params -- dictionary containing the weights w and bias b</span><br><span class="line">grads -- dictionary containing the gradients of the weights and bias with respect to the cost function</span><br><span class="line">costs -- list of all the costs computed during the optimization, this will be used to plot the learning curve.</span><br><span class="line"></span><br><span class="line">1) Calculate the cost and the gradient for the current parameters. Use propagate().</span><br><span class="line">2) Update the parameters using gradient descent rule for w and b.</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line"></span><br><span class="line">def optimize(w, b, X, Y, num_iterations, learning_rate, print_cost = False):</span><br><span class="line">     costs = [] // æ”¶é›†æ¯è½®è®¡ç®—çš„æŸå¤±å‡½æ•°å€¼</span><br><span class="line">    </span><br><span class="line">    for i in range(num_iterations):</span><br><span class="line">        </span><br><span class="line">        # Cost and gradient calculation (â‰ˆ 1-4 lines of code)</span><br><span class="line">        # ç¬¬ä¸€è½®ç”¨åˆå§‹åŒ–wå’Œbè®¡ç®—çš„æŸå¤±å‡½æ•°å’Œæ¢¯åº¦</span><br><span class="line">        # åé¢ç”¨æ›´æ–°åçš„wå’Œbè®¡ç®—çš„æŸå¤±å‡½æ•°å’Œæ¢¯åº¦</span><br><span class="line">        grads, cost = propagate(w, b, X, Y) </span><br><span class="line">        </span><br><span class="line">        # è§£æ„æ¢¯åº¦</span><br><span class="line">        dw = grads[&quot;dw&quot;]</span><br><span class="line">        db = grads[&quot;db&quot;]</span><br><span class="line">        </span><br><span class="line">        # æ¢¯åº¦ä¸‹é™æ›´æ–°å‚æ•°</span><br><span class="line">        w = w - learning_rate * dw</span><br><span class="line">        b = b - learning_rate * db</span><br><span class="line">        </span><br><span class="line">        # Record the costs</span><br><span class="line">        # æ¯100è½®è®°å½•ä¸€æ¬¡æŸå¤±å‡½æ•°å€¼</span><br><span class="line">        if i % 100 == 0: </span><br><span class="line">            costs.append(cost)</span><br><span class="line">        </span><br><span class="line">        # å¦‚æœéœ€è¦æ¯100è½®æ‰“å°ä¸‹æŸå¤±å‡½æ•°å°±å†æ‰“å°ä¸‹</span><br><span class="line">        if print_cost and i % 100 == 0:</span><br><span class="line">            print (&quot;Cost after iteration %i: %f&quot; %(i, cost))</span><br><span class="line">    </span><br><span class="line">    # num_iterationsè½® è®­ç»ƒç»“æŸåè¿”å›æœ€ç»ˆæ›´æ–°åˆ°çš„å‚æ•°ï¼Œæ¢¯åº¦ï¼Œå’ŒæŸå¤±å‡½æ•°é›†åˆ(å¯ä»¥ç”¨äºç»˜åˆ¶å­¦ä¹ æ›²çº¿)</span><br><span class="line">    params = &#123;&quot;w&quot;: w,</span><br><span class="line">              &quot;b&quot;: b&#125;</span><br><span class="line">    </span><br><span class="line">    grads = &#123;&quot;dw&quot;: dw,</span><br><span class="line">             &quot;db&quot;: db&#125;</span><br><span class="line">    </span><br><span class="line">    return params, grads, costs</span><br></pre></td></tr></table></figure>
<h3 id="é¢„æµ‹å‡½æ•°"><a href="#é¢„æµ‹å‡½æ•°" class="headerlink" title="é¢„æµ‹å‡½æ•°"></a>é¢„æµ‹å‡½æ•°</h3><p>æ ¹æ®å…¬å¼å®ç°é¢„æµ‹å‡½æ•°</p>
<p>  ğ‘ŒÌ‚ =ğ´=ğœ(ğ‘¤ğ‘‡ğ‘‹+ğ‘)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">&apos;&apos;&apos;</span><br><span class="line">Predict whether the label is 0 or 1 using learned logistic regression parameters (w, b)</span><br><span class="line"></span><br><span class="line">Arguments:</span><br><span class="line">w -- weights, a numpy array of size (num_px * num_px * 3, 1)</span><br><span class="line">b -- bias, a scalar</span><br><span class="line">X -- data of size (num_px * num_px * 3, number of examples)</span><br><span class="line"></span><br><span class="line">Returns:</span><br><span class="line">Y_prediction -- a numpy array (vector) containing all predictions (0/1) for the examples in X</span><br><span class="line">&apos;&apos;&apos;</span><br><span class="line"># X æ˜¯æ‘Šå¹³åæ•°æ® (12288, m), X.shape[0] æ˜¯å½±å“å› ç´ ä¸ªæ•° 12288 ä¸ªRGBå€¼, X.shape[1] æ˜¯è®­ç»ƒé›†æ ·æœ¬æ•°</span><br><span class="line">def predict(w, b, X):</span><br><span class="line">    </span><br><span class="line">    m = X.shape[1]</span><br><span class="line">    Y_prediction = np.zeros((1,m))</span><br><span class="line">    w = w.reshape(X.shape[0], 1)</span><br><span class="line">    </span><br><span class="line">    # Compute vector &quot;A&quot; predicting the probabilities of a cat being present in the picture</span><br><span class="line">    A = sigmoid(w.T @ X + b)</span><br><span class="line">    </span><br><span class="line">    for i in range(A.shape[1]):</span><br><span class="line">        # Convert probabilities A[0,i] to actual predictions p[0,i] </span><br><span class="line">        # å¤§äº0.5 é¢„æµ‹ä¸º1 æ˜¯çŒ«, å°äº0.5 é¢„æµ‹ä¸º0, ä¸æ˜¯çŒ«</span><br><span class="line">        Y_prediction[0, i] = A[0, i] &gt; 0.5</span><br><span class="line">    </span><br><span class="line">    assert(Y_prediction.shape == (1, m))</span><br><span class="line">    </span><br><span class="line">    return Y_prediction</span><br></pre></td></tr></table></figure>
<h3 id="ç»„è£…æ¨¡å‹"><a href="#ç»„è£…æ¨¡å‹" class="headerlink" title="ç»„è£…æ¨¡å‹"></a>ç»„è£…æ¨¡å‹</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line">Builds the logistic regression model by calling the function you&apos;ve implemented previously</span><br><span class="line"></span><br><span class="line">Arguments:</span><br><span class="line">X_train -- training set represented by a numpy array of shape (num_px * num_px * 3, m_train)</span><br><span class="line">Y_train -- training labels represented by a numpy array (vector) of shape (1, m_train)</span><br><span class="line">X_test -- test set represented by a numpy array of shape (num_px * num_px * 3, m_test)</span><br><span class="line">Y_test -- test labels represented by a numpy array (vector) of shape (1, m_test)</span><br><span class="line">num_iterations -- hyperparameter representing the number of iterations to optimize the parameters</span><br><span class="line">learning_rate -- hyperparameter representing the learning rate used in the update rule of optimize()</span><br><span class="line">print_cost -- Set to true to print the cost every 100 iterations</span><br><span class="line"></span><br><span class="line">Returns:</span><br><span class="line">d -- dictionary containing information about the model.</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line"></span><br><span class="line">def model(X_train, Y_train, X_test, Y_test, num_iterations = 2000, learning_rate = 0.5, print_cost = False):</span><br><span class="line"></span><br><span class="line">    # initialize parameters with zeros (â‰ˆ 1 line of code)</span><br><span class="line">    # åˆå§‹åŒ–æ¨¡å‹çš„å‚æ•°</span><br><span class="line">    w, b = initialize_with_zeros(X_train.shape[0])</span><br><span class="line"></span><br><span class="line">    # Gradient descent (â‰ˆ 1 line of code)</span><br><span class="line">    # æ ¹æ®è®­ç»ƒæ•°æ®é‡‡ç”¨æ¢¯åº¦ä¸‹é™æ–¹æ³•æ›´æ–°å‚æ•°</span><br><span class="line">    parameters, grads, costs = optimize(w, b, X_train, Y_train, num_iterations, learning_rate, print_cost)</span><br><span class="line">    </span><br><span class="line">    # Retrieve parameters w and b from dictionary &quot;parameters&quot;</span><br><span class="line">    w = parameters[&quot;w&quot;]</span><br><span class="line">    b = parameters[&quot;b&quot;]</span><br><span class="line">    </span><br><span class="line">    # Predict test/train set examples (â‰ˆ 2 lines of code)</span><br><span class="line">    # ç”¨è®­ç»ƒå¥½çš„å‚æ•°é¢„æµ‹æµ‹è¯•é›†å’Œè®­ç»ƒé›†çš„ç»“æœ</span><br><span class="line">    Y_prediction_test = predict(w, b, X_test)</span><br><span class="line">    Y_prediction_train = predict(w, b, X_train)</span><br><span class="line"></span><br><span class="line">    # Print train/test Errors</span><br><span class="line">    # æ‰“å°è®­ç»ƒé›†å’Œæµ‹è¯•é›†çš„å‡†ç¡®ç‡</span><br><span class="line">    print(&quot;train accuracy: &#123;&#125; %&quot;.format(100 - np.mean(np.abs(Y_prediction_train - Y_train)) * 100))</span><br><span class="line">    print(&quot;test accuracy: &#123;&#125; %&quot;.format(100 - np.mean(np.abs(Y_prediction_test - Y_test)) * 100))</span><br><span class="line"></span><br><span class="line">    # è¿”å›æ¨¡å‹è®­ç»ƒçš„æŸå¤±å‡½æ•°å€¼(å­¦ä¹ æ›²çº¿)ï¼Œè®­ç»ƒæµ‹è¯•æ•°æ®é›†çš„é¢„æµ‹ç»“æœ(åˆ¤æ–­æ¨¡å‹æ˜¯å¦æ‹Ÿåˆ)ï¼Œæ¨¡å‹çš„å‚æ•°, å­¦ä¹ ç‡ï¼Œè¿­ä»£æ¬¡æ•°ç­‰ä¿¡æ¯</span><br><span class="line">    d = &#123;&quot;costs&quot;: costs,</span><br><span class="line">         &quot;Y_prediction_test&quot;: Y_prediction_test, </span><br><span class="line">         &quot;Y_prediction_train&quot; : Y_prediction_train, </span><br><span class="line">         &quot;w&quot; : w, </span><br><span class="line">         &quot;b&quot; : b,</span><br><span class="line">         &quot;learning_rate&quot; : learning_rate,</span><br><span class="line">         &quot;num_iterations&quot;: num_iterations&#125;</span><br><span class="line">    </span><br><span class="line">    return d</span><br><span class="line"></span><br><span class="line"># è°ƒç”¨æ¨¡å‹</span><br><span class="line"># æ³¨æ„å…¥å‚train_set_x, train_set_y, test_set_x, test_set_y, æ˜¯ç»è¿‡é¢„å¤„ç†çš„æ•°æ®é›†</span><br><span class="line">d = model(train_set_x, train_set_y, test_set_x, test_set_y, num_iterations = 2000, learning_rate = 0.005, print_cost = True)</span><br></pre></td></tr></table></figure>
<h3 id="æ¨¡å‹åˆ†æ"><a href="#æ¨¡å‹åˆ†æ" class="headerlink" title="æ¨¡å‹åˆ†æ"></a>æ¨¡å‹åˆ†æ</h3><ol>
<li>é¢„æµ‹ç»“æœåˆ†æ</li>
</ol>
<p>é™¤äº†å‡½æ•°æœ¬èº«é‡Œé¢çš„å‡†ç¡®ç‡è®¡ç®—ï¼Œå¯ä»¥åˆæ­¥åˆ¤æ–­æ¨¡å‹æ˜¯å¦è¿‡æ‹Ÿåˆè®­ç»ƒæ•°æ®ï¼Œè¿˜å¯ä»¥å•ç‹¬æ‹¿å‡ºä¸€ä¸ªæµ‹è¯•æ•°æ®ï¼Œå’Œ é¢„æµ‹æ•°æ®è¿›è¡Œç»“æœæ¯”è¾ƒï¼Œè¿›è¡ŒéªŒè¯</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">index = 14</span><br><span class="line">plt.imshow(test_set_x[:,index].reshape((num_px, num_px, 3)))</span><br><span class="line">print (&quot;y = &quot; + str(test_set_y[0,index]) + &quot;, you predicted that it is a \&quot;&quot; + classes[int(d[&quot;Y_prediction_test&quot;][0,index])].decode(&quot;utf-8&quot;) +  &quot;\&quot; picture.&quot;)</span><br></pre></td></tr></table></figure>
<ol start="2">
<li>å­¦ä¹ æ›²çº¿åˆ†æ</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># Plot learning curve (with costs)</span><br><span class="line">costs = np.squeeze(d[&apos;costs&apos;])</span><br><span class="line">plt.plot(costs)</span><br><span class="line">plt.ylabel(&apos;cost&apos;)</span><br><span class="line">plt.xlabel(&apos;iterations (per hundreds)&apos;)</span><br><span class="line">plt.title(&quot;Learning rate =&quot; + str(d[&quot;learning_rate&quot;]))</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<ol start="3">
<li>å­¦ä¹ ç‡åˆ†æ or è¶…å‚æ•°åˆ†æ</li>
</ol>
<p>å¢åŠ è®­ç»ƒæ¬¡æ•°ï¼Œè§‚å¯Ÿå­¦ä¹ æ›²çº¿å˜åŒ–åŒç†</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">learning_rates = [0.01, 0.001, 0.0001]</span><br><span class="line">models = &#123;&#125;</span><br><span class="line">for i in learning_rates:</span><br><span class="line">    print (&quot;learning rate is: &quot; + str(i))</span><br><span class="line">    models[str(i)] = model(train_set_x, train_set_y, test_set_x, test_set_y, num_iterations = 1500, learning_rate = i, print_cost = False)</span><br><span class="line">    print (&apos;\n&apos; + &quot;-------------------------------------------------------&quot; + &apos;\n&apos;)</span><br><span class="line"></span><br><span class="line">for i in learning_rates:</span><br><span class="line">    plt.plot(np.squeeze(models[str(i)][&quot;costs&quot;]), label = str(models[str(i)][&quot;learning_rate&quot;]))</span><br><span class="line"></span><br><span class="line">plt.ylabel(&apos;cost&apos;)</span><br><span class="line">plt.xlabel(&apos;iterations (hundreds)&apos;)</span><br><span class="line"></span><br><span class="line">legend = plt.legend(loc=&apos;upper center&apos;, shadow=True)</span><br><span class="line">frame = legend.get_frame()</span><br><span class="line">frame.set_facecolor(&apos;0.90&apos;)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<h3 id="åº”ç”¨è®­ç»ƒç»“æœè¿›è¡Œé¢„æµ‹"><a href="#åº”ç”¨è®­ç»ƒç»“æœè¿›è¡Œé¢„æµ‹" class="headerlink" title="åº”ç”¨è®­ç»ƒç»“æœè¿›è¡Œé¢„æµ‹"></a>åº”ç”¨è®­ç»ƒç»“æœè¿›è¡Œé¢„æµ‹</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">my_image = &quot;my_image2.jpg&quot;   # change this to the name of your image file </span><br><span class="line"></span><br><span class="line">fname = &quot;images/&quot; + my_image</span><br><span class="line">image = np.array(plt.imread(fname))</span><br><span class="line">image = image/255.</span><br><span class="line">my_image = np.array(Image.fromarray(np.uint8(image)).resize((num_px,num_px))).reshape((1, num_px*num_px*3)).T // æ‘Šå¹³æ•°æ®(12288, 1)</span><br><span class="line">#my_image = scipy.misc.imresize(image, size=(num_px,num_px)).reshape((1, num_px*num_px*3)).T</span><br><span class="line">my_predicted_image = predict(d[&quot;w&quot;], d[&quot;b&quot;], my_image)</span><br><span class="line"></span><br><span class="line">plt.imshow(image)</span><br><span class="line">print(&quot;y = &quot; + str(np.squeeze(my_predicted_image)) + &quot;, your algorithm predicts a \&quot;&quot; + classes[int(np.squeeze(my_predicted_image)),].decode(&quot;utf-8&quot;) +  &quot;\&quot; picture.&quot;)</span><br></pre></td></tr></table></figure>
<p><a href="https://dennybritz.com/posts/wildml/implementing-a-neural-network-from-scratch/" target="_blank" rel="noopener">äºŒåˆ†ç±»é—®é¢˜çš„å®è·µ</a><br><a href="https://scikit-learn.org/stable/" target="_blank" rel="noopener">scikitæ¡†æ¶</a></p>
<h2 id="ä½¿ç”¨éšè—å±‚å®ç°å¯¹éçº¿æ€§æ•°æ®çš„åˆ†ç±»"><a href="#ä½¿ç”¨éšè—å±‚å®ç°å¯¹éçº¿æ€§æ•°æ®çš„åˆ†ç±»" class="headerlink" title="ä½¿ç”¨éšè—å±‚å®ç°å¯¹éçº¿æ€§æ•°æ®çš„åˆ†ç±»"></a>ä½¿ç”¨éšè—å±‚å®ç°å¯¹éçº¿æ€§æ•°æ®çš„åˆ†ç±»</h2><p>é¢˜ç›®<br>æˆ‘ä»¬ç°åœ¨æœ‰ä¸€å †æ•°æ®åˆ†å¸ƒæˆèŠ±æœµçš„å½¢çŠ¶ï¼Œéçº¿æ€§ï¼Œå¦‚ä¸‹ï¼Œ<br><img src="/image/deepLearning/37.png" alt><br>å¯ä»¥çœ‹åˆ°ä¸Šé¢çš„æ•°æ®æœ‰çš„æ˜¯çº¢è‰²ï¼Œæœ‰çš„æ˜¯è“è‰²ï¼Œå‡è®¾çº¢è‰²ä»£è¡¨æ”¯æŒç‰¹æœ—æ™®ï¼Œè“è‰²ä»£è¡¨æ”¯æŒæ‹œç™»<br>æˆ‘ä»¬å¸Œæœ›ç”¨ä¸€ä¸ªç¥ç»ç½‘ç»œæ¥å¯¹è¿™äº›æ•°æ®è¿›è¡Œåˆ†ç±»ï¼Œ<br>åˆ†ç±»ç»“æœå°±æ˜¯è¾“å…¥æ•°æ®å¯ä»¥ç›´æ¥å¾—åˆ°æ•°æ®æ˜¯çº¢è‰²è¿˜æ˜¯è“è‰²çš„æ ‡ç­¾<br>è§£å†³æ€è·¯å°±æƒ³åŠæ³•å¯¹çº¢è‰²å’Œè“è‰²çš„æ•°æ®é›†ä¸­åœ°åŒºè¿›è¡Œåˆ†å—åˆ’åˆ†ï¼Œ<br>å¦‚æœæˆ‘ä»¬è¿˜æ˜¯ç”¨sigmoid å‡½æ•°ï¼Œé‚£ä¹ˆå°±ä¼šå˜æˆçº¿æ€§çš„ï¼Œä¸ä¼šå¾—åˆ°æ­£ç¡®çš„åŒºå—åˆ’åˆ†<br><img src="/image/deepLearning/38.png" alt><br>æˆ‘ä»¬å¸Œæœ›ç”¨ä¸€ä¸ªéçº¿æ€§å‡½æ•°æŠŠæ•°æ®è¿›è¡Œç²¾ç¡®åº¦æ›´å¥½çš„åˆ’åˆ†</p>
<blockquote>
<p>The general methodology to build a Neural Network is to: </p>
<ol>
<li>Define the neural network structure ( # of input units, # of hidden units, etc). </li>
<li>Initialize the modelâ€™s parameters </li>
<li>Loop: - Implement forward propagation - Compute loss - Implement backward propagation to get the gradients - Update parameters (gradient descent)</li>
</ol>
<p>You often build helper functions to compute steps 1-3 and then merge them into one function we call nn_model().<br>Once youâ€™ve built nn_model() and learnt the right parameters, you can make predictions on new data.</p>
</blockquote>
<h3 id="æ¨¡å‹ç»“æ„"><a href="#æ¨¡å‹ç»“æ„" class="headerlink" title="æ¨¡å‹ç»“æ„"></a>æ¨¡å‹ç»“æ„</h3><p><img src="/image/deepLearning/39.png" alt></p>
<h3 id="æ¶‰åŠæ–¹ç¨‹"><a href="#æ¶‰åŠæ–¹ç¨‹" class="headerlink" title="æ¶‰åŠæ–¹ç¨‹"></a>æ¶‰åŠæ–¹ç¨‹</h3><p>å‘å‰ä¼ æ’­<br><img src="/image/deepLearning/40.png" alt><br>åå‘ä¼ æ’­<br><img src="/image/deepLearning/41.png" alt></p>
<h3 id="å®ç°"><a href="#å®ç°" class="headerlink" title="å®ç°"></a>å®ç°</h3><p>é‡ç‚¹å…³æ³¨æ¨¡å‹ç»„è£…å¥½åï¼Œå¦‚ä½•ä½¿ç”¨ï¼Œå¦‚ä½•é¢„æµ‹ï¼Œç²¾ç¡®åº¦è®¡ç®—ï¼Œè¶…å‚æ•°å¦‚ä½•è®­ç»ƒï¼Œ<a href="https://yoohannah.github.io/post/machineLearning/MachineLearningDevelopmentProcess.html">è¿ç§»å­¦ä¹ </a>æ€ä¹ˆåš</p>
<p><a href="https://github.com/YooHannah/algorithm/blob/master/deeplearning/NeuralNetworkModel/index.py" target="_blank" rel="noopener">éçº¿æ€§é€»è¾‘å›å½’å®ç°ä»£ç </a></p>
<h2 id="Lå±‚ç¥ç»ç½‘ç»œå®ç°"><a href="#Lå±‚ç¥ç»ç½‘ç»œå®ç°" class="headerlink" title="Lå±‚ç¥ç»ç½‘ç»œå®ç°"></a>Lå±‚ç¥ç»ç½‘ç»œå®ç°</h2><p>æ•´ä½“æ¶æ„<br><img src="/image/deepLearning/LModel.png" alt></p>
<ol>
<li>å‘å‰ä¼ æ’­çš„æ—¶å€™ï¼Œå‰L-1å±‚éƒ½æ˜¯å…ˆçº¿æ€§ç„¶åç”¨relu å‡½æ•°æ¿€æ´»ï¼Œæœ€åä¸€å±‚æ˜¯çº¿æ€§ç„¶åç”¨sigmoid å‡½æ•°æ¿€æ´»<blockquote>
<p>The modelâ€™s structure is: LINEAR -&gt; RELU -&gt; LINEAR -&gt; SIGMOID.<br><img src="/image/deepLearning/forward.png" alt></p>
</blockquote>
</li>
<li>è®¡ç®—æŸå¤±å‡½æ•°<br><img src="/image/deepLearning/cost.png" alt></li>
<li>åå‘ä¼ æ’­çš„æ—¶å€™ï¼Œä¸å‘å‰ä¼ æ’­ç›¸åï¼Œé™¤ç¬¬ä¸€å±‚æ˜¯çº¿æ€§ç„¶åç”¨sigmoid å‡½æ•°æ¿€æ´»ï¼Œåé¢l-1å±‚æ˜¯çº¿æ€§ç„¶åç”¨relu å‡½æ•°æ¿€æ´»ï¼Œå‰é¢çš„æ¯ä¸€å±‚éƒ½æ˜¯çº¿æ€§ç„¶åç”¨relu å‡½æ•°æ¿€æ´»<blockquote>
<p>The modelâ€™s structure is: SIGMOID -&gt; LINEAR -&gt; RELU -&gt; LINEAR -&gt; RELU -&gt; â€¦ -&gt; SIGMOID.<br>for every forward function, there is a corresponding backward function. That is why at every step of your forward module you will be storing some values in a cache. The cached values are useful for computing gradients. In the backpropagation module you will then use the cache to calculate the gradients. This assignment will show you exactly how to carry out each of these steps.<br><img src="/image/deepLearning/backforward.png" alt><br>ä½¿ç”¨é“¾å¼æ³•åˆ™, å¯¹ä¸‹é¢çš„çº¿æ€§å‡½æ•°æ±‚å¯¼dw, db, dA<br><img src="/image/deepLearning/dao1.png" alt><br>å¾—åˆ°åå‘ä¼ æ’­è®¡ç®—å…¬å¼<br><img src="/image/deepLearning/dao2.png" alt></p>
</blockquote>
</li>
</ol>
<p>æ³¨æ„è¾“å‡ºå±‚çš„sigmoid å‡½æ•°æ±‚å¯¼<br><img src="/image/deepLearning/dao3.png" alt></p>
<p><a href="https://github.com/YooHannah/algorithm/blob/master/deeplearning/DeepNeuralNetwork/index.py" target="_blank" rel="noopener">Lå±‚ç¥ç»ç½‘ç»œå®ç°ä»£ç </a></p>
<h2 id="è¿è¡Œå¼‚å¸¸"><a href="#è¿è¡Œå¼‚å¸¸" class="headerlink" title="è¿è¡Œå¼‚å¸¸"></a>è¿è¡Œå¼‚å¸¸</h2><ol>
<li>å‚æ•°åˆå§‹åŒ–é—®é¢˜</li>
</ol>
<table>
<thead>
<tr>
<th>è¯­å¥</th>
<th>åˆå§‹åŒ–æ–¹å¼</th>
<th>ä¼˜ç¼ºç‚¹</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>np.random.randn(layer_dims[l], layer_dims[l - 1])</code></td>
<td>æ ‡å‡†æ­£æ€åˆ†å¸ƒåˆå§‹åŒ–</td>
<td>ç®€å•ï¼Œä½†å¯èƒ½å¯¼è‡´æ¢¯åº¦çˆ†ç‚¸æˆ–æ¢¯åº¦æ¶ˆå¤±ï¼Œå°¤å…¶æ˜¯åœ¨æ·±å±‚ç½‘ç»œä¸­ã€‚</td>
</tr>
<tr>
<td><code>np.random.randn(layer_dims[l], layer_dims[l-1]) / np.sqrt(layer_dims[l-1])</code></td>
<td>Xavieråˆå§‹åŒ–çš„å˜ä½“ï¼Œ<code>np.sqrt(layer_dims[l-1])</code>æ˜¯ä¸Šä¸€å±‚ç¥ç»å…ƒä¸ªæ•°</td>
<td>æä¾›æ›´ç¨³å®šçš„æ¢¯åº¦å’Œæ¿€æ´»å€¼ï¼Œé€‚åˆå¯¹ç§°æ¿€æ´»å‡½æ•°ï¼ˆå¦‚Sigmoidã€Tanhï¼‰ã€‚å‡å°‘æ¢¯åº¦çˆ†ç‚¸æˆ–æ¢¯åº¦æ¶ˆå¤±é—®é¢˜ã€‚</td>
</tr>
</tbody>
</table>
<p>å¦‚æœä½¿ç”¨ ReLU æˆ– Leaky ReLU ä½œä¸ºæ¿€æ´»å‡½æ•°ï¼Œå¯ä»¥é‡‡ç”¨ He åˆå§‹åŒ–ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">parameters[&apos;W&apos; + str(l)] = np.random.randn(layer_dims[l], layer_dims[l-1]) * np.sqrt(2 / layer_dims[l-1])</span><br></pre></td></tr></table></figure></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://yoohannah.github.io/post/deepLearning/basicKnowledge.html">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="YooHannah">
    <meta itemprop="description" content>
    <meta itemprop="image" content="/psb.jpg">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="My Little World">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="My Little World" src>
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/post/deepLearning/basicKnowledge.html" itemprop="url">
                  ä¸€äº›åŸºç¡€çŸ¥è¯†
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2024-11-27T17:10:37+08:00">
                2024-11-27
              </time>
            

            

            
          </span>

          

          
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="æ·±åº¦å­¦ä¹ ä¸ºä»€ä¹ˆä¼šå´›èµ·"><a href="#æ·±åº¦å­¦ä¹ ä¸ºä»€ä¹ˆä¼šå´›èµ·" class="headerlink" title="æ·±åº¦å­¦ä¹ ä¸ºä»€ä¹ˆä¼šå´›èµ·"></a>æ·±åº¦å­¦ä¹ ä¸ºä»€ä¹ˆä¼šå´›èµ·</h1><p>éšç€ æ•°æ®é‡çš„å¢å¤šï¼Œè®¡ç®—èƒ½åŠ›çš„æé«˜ä»¥åŠç®—æ³•çš„è¿›æ­¥ï¼Œä½¿å¾—æ·±åº¦å­¦ä¹ çš„è®­ç»ƒå‘¨æœŸå˜çŸ­ï¼Œå¯ä»¥å¿«é€Ÿè¿›è¡Œè¿­ä»£æ›´æ–°ä¼˜åŒ–<br>ä»è€Œç”¨äºå·¥ä¸šç”Ÿæˆ</p>
<p>ä¸‹é¢ä»¥äºŒåˆ†ç±»é—®é¢˜ä¸ºä¾‹ï¼Œå¤ä¹ ä¸€ä¸‹ç›¸å…³çš„æ•°å­¦çŸ¥è¯†å’Œæ¦‚å¿µ</p>
<h1 id="æŸå¤±å‡½æ•°å’Œæˆæœ¬å‡½æ•°"><a href="#æŸå¤±å‡½æ•°å’Œæˆæœ¬å‡½æ•°" class="headerlink" title="æŸå¤±å‡½æ•°å’Œæˆæœ¬å‡½æ•°"></a>æŸå¤±å‡½æ•°å’Œæˆæœ¬å‡½æ•°</h1><p>é‡æ–°ç†è§£ä¸€ä¸‹<br>æŸå¤±å‡½æ•°æ˜¯ä¸€ä¸ªè®­ç»ƒæ•°æ®çš„é¢„æµ‹ç»“æœå’Œå®é™…å€¼çš„å·®<br>æˆæœ¬å‡½æ•°æ˜¯æ‰€æœ‰è®­ç»ƒæ•°æ®çš„æŸå¤±å‡½æ•°çš„å¹³å‡å€¼<br><img src="/image/deepLearning/1.png" alt></p>
<h1 id="å¸¸è§æ±‚å¯¼å…¬å¼"><a href="#å¸¸è§æ±‚å¯¼å…¬å¼" class="headerlink" title="å¸¸è§æ±‚å¯¼å…¬å¼"></a>å¸¸è§æ±‚å¯¼å…¬å¼</h1><p>1.Câ€™=0(Cä¸ºå¸¸æ•°)ï¼›<br>2.(Xn)â€™=nX(n-1) (nâˆˆR)ï¼›<br>3.(sinX)â€™=cosXï¼›<br>4.(cosX)â€™=-sinXï¼›<br>5.(aX)â€™=aXIna ï¼ˆlnä¸ºè‡ªç„¶å¯¹æ•°ï¼‰ï¼›<br>6.(logaX)â€™=1/(Xlna) (a&gt;0ï¼Œä¸”aâ‰ 1)ï¼›<br>7.(tanX)â€™=1/(cosX)2=(secX)2<br>8.(cotX)â€™=-1/(sinX)2=-(cscX)2<br>9.(secX)â€™=tanX secXï¼›<br>10.(cscX)â€™=-cotX cscXï¼›</p>
<h1 id="è®¡ç®—å›¾"><a href="#è®¡ç®—å›¾" class="headerlink" title="è®¡ç®—å›¾"></a>è®¡ç®—å›¾</h1><h2 id="å‘å‰ä¼ æ’­"><a href="#å‘å‰ä¼ æ’­" class="headerlink" title="å‘å‰ä¼ æ’­"></a>å‘å‰ä¼ æ’­</h2><p>è®¡ç®—æˆæœ¬å‡½æ•°<br><img src="/image/deepLearning/2.png" alt></p>
<h2 id="å‘åä¼ æ’­"><a href="#å‘åä¼ æ’­" class="headerlink" title="å‘åä¼ æ’­"></a>å‘åä¼ æ’­</h2><p>é€šè¿‡é“¾å¼æ±‚å¯¼å¾—åˆ°æ¯ä¸€è½®è®¡ç®—ä¸­å‚æ•°çš„å¯¼æ•°ï¼Œä»è€Œç”¨äºè¿›è¡Œæ¢¯åº¦ä¸‹é™è®¡ç®—<br><img src="/image/deepLearning/3.png" alt></p>
<h1 id="æ¢¯åº¦ä¸‹é™è®¡ç®—è¿‡ç¨‹"><a href="#æ¢¯åº¦ä¸‹é™è®¡ç®—è¿‡ç¨‹" class="headerlink" title="æ¢¯åº¦ä¸‹é™è®¡ç®—è¿‡ç¨‹"></a>æ¢¯åº¦ä¸‹é™è®¡ç®—è¿‡ç¨‹</h1><p><img src="/image/deepLearning/4.png" alt><br><img src="/image/deepLearning/5.png" alt><br><img src="/image/deepLearning/6.png" alt><br><img src="/image/deepLearning/7.png" alt><br>Neural network programming guideline<br>Whenever possible, avoid explicit for-loops.<br>é¿å…for-loopså¾ªç¯è®¡ç®—å¸¦æ¥çš„ç®—åŠ›æŸè€—ï¼Œä½¿ç”¨å‘é‡å¯¹ä¸Šé¢ä¸¤æ¬¡å¾ªç¯(è®­ç»ƒæ•°è¿­ä»£å’Œå‚æ•°è¿­ä»£)è¿›è¡Œä¼˜åŒ–ï¼Œæœ€ç»ˆåªå‰©è®­ç»ƒæ¬¡æ•°ä¸€æ¬¡loop å¾ªç¯<br><img src="/image/deepLearning/8.png" alt></p>
<h2 id="å¹¿æ’­"><a href="#å¹¿æ’­" class="headerlink" title="å¹¿æ’­"></a>å¹¿æ’­</h2><p>é€šè¿‡ä½¿ç”¨å‘é‡çš„å¹¿æ’­è®¡ç®—ï¼Œå¯ä»¥å¤§å¹…åº¦å‡å°‘forå¾ªç¯çš„è®¡ç®—æˆæœ¬<br>å¹¿æ’­å¸¸è§çš„è®¡ç®—è¿‡ç¨‹å¦‚ä¸‹</p>
<p><img src="/image/deepLearning/9.png" alt><br><img src="/image/deepLearning/10.png" alt></p>
<h3 id="ç»ƒä¹ "><a href="#ç»ƒä¹ " class="headerlink" title="ç»ƒä¹ "></a>ç»ƒä¹ </h3><p>ä½¿ç”¨å¹¿æ’­çš„è¿ç®—æ¦‚å¿µï¼Œå®ç°ä¸‹é¢çš„softmax å‡½æ•°<br><img src="/image/deepLearning/36.png" alt><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">def softmax(x):</span><br><span class="line">    &quot;&quot;&quot;Calculates the softmax for each row of the input x.</span><br><span class="line"></span><br><span class="line">    Your code should work for a row vector and also for matrices of shape (m,n).</span><br><span class="line"></span><br><span class="line">    Argument:</span><br><span class="line">    x -- A numpy matrix of shape (m,n)</span><br><span class="line"></span><br><span class="line">    Returns:</span><br><span class="line">    s -- A numpy matrix equal to the softmax of x, of shape (m,n)</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">    # Apply exp() element-wise to x. Use np.exp(...).</span><br><span class="line">    x_exp = np.exp(x)</span><br><span class="line"></span><br><span class="line">    # Create a vector x_sum that sums each row of x_exp. Use np.sum(..., axis = 1, keepdims = True).</span><br><span class="line">    x_sum = np.sum(x_exp, axis=1, keepdims=True)</span><br><span class="line">    </span><br><span class="line">    # Compute softmax(x) by dividing x_exp by x_sum. It should automatically use numpy broadcasting.</span><br><span class="line">    s = x_exp / x_sum</span><br><span class="line">    </span><br><span class="line">    return s</span><br><span class="line"></span><br><span class="line">x = np.array([</span><br><span class="line">    [9, 2, 5, 0, 0],</span><br><span class="line">    [7, 5, 0, 0 ,0]])</span><br><span class="line">print(&quot;softmax(x) = &quot; + str(softmax(x)))</span><br><span class="line">==&gt;</span><br><span class="line">softmax(x) = [[9.80897665e-01 8.94462891e-04 1.79657674e-02 1.21052389e-04</span><br><span class="line">  1.21052389e-04]</span><br><span class="line"> [8.78679856e-01 1.18916387e-01 8.01252314e-04 8.01252314e-04</span><br><span class="line">  8.01252314e-04]]</span><br></pre></td></tr></table></figure></p>
<p><a href="https://github.com/GeeeekExplorer/AndrewNg-Deep-Learning/blob/master/Neural%20Networks%20and%20Deep%20Learning/Week%202/Python%20Basics%20with%20Numpy/Python%20Basics%20With%20Numpy%20Solution.ipynb" target="_blank" rel="noopener">github å®éªŒç»ƒä¹ </a></p>
<p><a href="https://docs.scipy.org/doc/numpy-1.10.1/reference/generated/numpy.exp.html" target="_blank" rel="noopener">numpy å®˜ç½‘</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://yoohannah.github.io/post/machineLearning/dataWash.html">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="YooHannah">
    <meta itemprop="description" content>
    <meta itemprop="image" content="/psb.jpg">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="My Little World">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="My Little World" src>
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/post/machineLearning/dataWash.html" itemprop="url">
                  æ•°æ®æ¸…æ´—å’Œè½¬æ¢
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2024-10-15T20:14:37+08:00">
                2024-10-15
              </time>
            

            

            
          </span>

          

          
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="å¸¸è§æ•°æ®é”™è¯¯å½¢å¼"><a href="#å¸¸è§æ•°æ®é”™è¯¯å½¢å¼" class="headerlink" title="å¸¸è§æ•°æ®é”™è¯¯å½¢å¼"></a>å¸¸è§æ•°æ®é”™è¯¯å½¢å¼</h1><ol>
<li>è¶…å‡ºæ­£å¸¸æ•°æ®èŒƒå›´ï¼Œå€¼æˆ–è€…å¤ªå¤§æˆ–è€…å¤ªå°</li>
<li>ä¸ç¬¦åˆç›¸å…³æ ¡éªŒè§„åˆ™ï¼Œæ¯”å¦‚æ•°å€¼ç±»å‹åªèƒ½æ˜¯æ•´å½¢ï¼Œè´§å¸å•ä½åº”è¯¥æ˜¯ç¾å…ƒï¼Œä½†æ˜¯å‡ºç°äº†è‹±é•‘</li>
<li>å½¢å¼é”™è¯¯ï¼Œæ¯”å¦‚æ—¥æœŸæ ¼å¼é”™è¯¯ï¼Œç”µè¯å·ç æ ¼å¼é”™è¯¯ï¼Œä¸ç¬¦åˆç›¸å…³è¯­æ³•è¯­ä¹‰è§„èŒƒ</li>
</ol>
<p><img src="/image/LLM/236.png" alt></p>
<p>å¯¹äºè¿™æ ·çš„æ•°æ®è¦è¿›è¡Œå»é™¤æ¸…æ´—å¤„ç†</p>
<h1 id="æ•°æ®è½¬æ¢"><a href="#æ•°æ®è½¬æ¢" class="headerlink" title="æ•°æ®è½¬æ¢"></a>æ•°æ®è½¬æ¢</h1><p>é’ˆå¯¹æ•°å€¼ï¼Œå›¾ç‰‡ï¼Œè§†é¢‘ï¼Œæ–‡å­—ä¸åŒè¾“å…¥ç±»å‹ï¼Œæœ‰ä¸åŒè½¬æ¢æ–¹å¼<br><img src="/image/LLM/237.png" alt><br><img src="/image/LLM/238.png" alt><br><img src="/image/LLM/239.png" alt><br><img src="/image/LLM/240.png" alt><br><img src="/image/LLM/241.png" alt><br>å°ç»“</p>
<ol>
<li>æ•°å€¼ç±»å‹è½¬æ¢å°±é‡‡ç”¨å„ç§å½’ä¸€åŒ–çš„è®¡ç®—å…¬å¼è¿›è¡Œè½¬æ¢</li>
<li>å›¾ç‰‡ï¼Œå¯ä»¥é‡‡ç”¨è£å‰ªå°ºå¯¸ï¼Œä¸‹é‡‡æ ·ï¼Œå‹ç¼©ï¼Œç™½åŒ–å¤„ç†</li>
<li>è§†é¢‘ï¼Œå¯ä»¥é‡‡ç”¨æˆªå–å…³é”®ç‰‡æ®µï¼Œé‡‡æ ·å…³é”®é’ˆé™ä½æ•°æ®å¤„ç†é™ˆæœ¬</li>
<li>æ–‡å­—ï¼Œå¯ä»¥è¿›è¡Œè¯å¹²æå–ï¼Œè¯å½¢è¿˜åŸä»¥åŠtokenåŒ–å¤„ç†<br><img src="/image/LLM/242.png" alt></li>
</ol>
<h1 id="mL-å¸¸è§ç®—æ³•ç±»å‹"><a href="#mL-å¸¸è§ç®—æ³•ç±»å‹" class="headerlink" title="mL å¸¸è§ç®—æ³•ç±»å‹"></a>mL å¸¸è§ç®—æ³•ç±»å‹</h1><p>ç›‘ç£ï¼Œè‡ªç›‘ç£ï¼ŒåŠç›‘ç£ï¼Œæ— ç›‘ç£ï¼Œå¼ºåŒ–å­¦ä¹ <br><img src="/image/LLM/243.png" alt><br><img src="/image/LLM/244.png" alt></p>
<h2 id="è‡ªç›‘ç£ç›¸å…³æ¦‚å¿µ"><a href="#è‡ªç›‘ç£ç›¸å…³æ¦‚å¿µ" class="headerlink" title="è‡ªç›‘ç£ç›¸å…³æ¦‚å¿µ"></a>è‡ªç›‘ç£ç›¸å…³æ¦‚å¿µ</h2><p><img src="/image/LLM/245.png" alt></p>
<h2 id="å†³ç­–æ ‘ç›¸å…³æ³¨æ„ç‚¹"><a href="#å†³ç­–æ ‘ç›¸å…³æ³¨æ„ç‚¹" class="headerlink" title="å†³ç­–æ ‘ç›¸å…³æ³¨æ„ç‚¹"></a>å†³ç­–æ ‘ç›¸å…³æ³¨æ„ç‚¹</h2><p><img src="/image/LLM/246.png" alt><br><img src="/image/LLM/247.png" alt><br><img src="/image/LLM/248.png" alt></p>
<h2 id="äºŒåˆ†ç±»è¯„ä»·æŒ‡æ ‡"><a href="#äºŒåˆ†ç±»è¯„ä»·æŒ‡æ ‡" class="headerlink" title="äºŒåˆ†ç±»è¯„ä»·æŒ‡æ ‡"></a>äºŒåˆ†ç±»è¯„ä»·æŒ‡æ ‡</h2><p><img src="/image/LLM/249.png" alt></p>
<h2 id="å¤æ‚åº¦è§£é‡Šorè§£é‡Š"><a href="#å¤æ‚åº¦è§£é‡Šorè§£é‡Š" class="headerlink" title="å¤æ‚åº¦è§£é‡Šorè§£é‡Š"></a>å¤æ‚åº¦è§£é‡Šorè§£é‡Š</h2><p><img src="/image/LLM/250.png" alt><br><img src="/image/LLM/251.png" alt><br><img src="/image/LLM/252.png" alt><br><img src="/image/LLM/253.png" alt><br><img src="/image/LLM/254.png" alt></p>
<p><a href="https://c.d2l.ai/stanford-cs329p/syllabus.html#data-i" target="_blank" rel="noopener">ææ²æœºå™¨å­¦ä¹ ppt</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://yoohannah.github.io/post/machineLearning/datalabel.html">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="YooHannah">
    <meta itemprop="description" content>
    <meta itemprop="image" content="/psb.jpg">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="My Little World">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="My Little World" src>
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/post/machineLearning/datalabel.html" itemprop="url">
                  æ•°æ®æ ‡æ³¨
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2024-10-14T21:05:37+08:00">
                2024-10-14
              </time>
            

            

            
          </span>

          

          
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>æ ¹æ®æ ‡æ³¨æ•°æ®çš„ç›®çš„(æ•°æ®ä¼˜åŒ–è¿˜æ˜¯è®­ç»ƒæ¨¡å‹)ï¼Œæ•°æ®å½“å‰çš„æ ‡æ³¨æƒ…å†µä»¥åŠé¢„ç®—æƒ…å†µ<br>å¯ä»¥æ ¹æ®ä¸‹é¢çš„æµç¨‹è¿›è¡Œæ•°æ®æ ‡æ³¨<br><img src="/image/LLM/226.png" alt></p>
<h1 id="åŠç›‘ç£å­¦ä¹ "><a href="#åŠç›‘ç£å­¦ä¹ " class="headerlink" title="åŠç›‘ç£å­¦ä¹ "></a>åŠç›‘ç£å­¦ä¹ </h1><p>å¦‚æœä¸€å¼€å§‹æœ‰ä¸€éƒ¨åˆ†æ•°æ®å¯ä»¥è¿›è¡Œç›‘ç£å­¦ä¹ è®­ç»ƒï¼Œç„¶åç”¨æœªæ ‡è®°çš„æ•°æ®è¿›è¡Œæµ‹è¯•ï¼Œæ‹¿åˆ°æµ‹è¯•ç»“æœï¼Œ<br>æ ¹æ®æµ‹è¯•ç»“æœå‡†ç¡®æ€§åˆ¤æ–­æ˜¯å¦å°†å½“å‰æœªæ ‡è®°æ•°æ®å½“åšæ ‡è®°æ•°æ®æ·»åŠ åˆ°ä¸‹ä¸€è½®çš„è®­ç»ƒä¸­<br><img src="/image/LLM/227.png" alt><br><img src="/image/LLM/228.png" alt><br>ç”±äºè¿™é‡Œçš„å·¥ä½œæ˜¯è¿›è¡Œæ•°æ®æ ‡æ³¨ï¼Œæ‰€ä»¥å¯ä»¥ä½¿ç”¨è¾ƒæ·±çš„ç¥ç»ç½‘ç»œæˆ–è€…è¾ƒè´µçš„æ¨¡å‹è¿›è¡Œè®­ç»ƒ<br>ä»¥ä¿è¯å¾—åˆ°æ›´å‡†ç¡®çš„æ ‡æ³¨ç»“æœ</p>
<h1 id="ä¼—åŒ…æ ‡æ³¨"><a href="#ä¼—åŒ…æ ‡æ³¨" class="headerlink" title="ä¼—åŒ…æ ‡æ³¨"></a>ä¼—åŒ…æ ‡æ³¨</h1><p>å¦‚æœæœ‰è¶³å¤Ÿçš„èµ„é‡‘é¢„ç®—ï¼Œå¯ä»¥å°†æ•°æ®äº¤ç»™ç¬¬ä¸‰æ–¹è¿›è¡Œæ ‡æ³¨ï¼Œç„¶åå°†æ ‡æ³¨ç»“æœè¿›è¡Œæ±‡æ€»<br><img src="/image/LLM/229.png" alt><br>ä½†è¦é¢ä¸´å¦‚ä½•é™ä½æ ‡æ³¨é—¨æ§›ï¼Œæ ‡æ³¨è´¨é‡ï¼Œä»·æ ¼æ˜‚è´µï¼Œæ ‡æ³¨äººå‘˜ä¸ç¨³å®šç­‰é—®é¢˜<br><img src="/image/LLM/230.png" alt></p>
<h2 id="ä¸»åŠ¨å­¦ä¹ "><a href="#ä¸»åŠ¨å­¦ä¹ " class="headerlink" title="ä¸»åŠ¨å­¦ä¹ "></a>ä¸»åŠ¨å­¦ä¹ </h2><p>åªå°†è®­ç»ƒç»“æœæœ€ä¸ç¡®å®šçš„æ•°æ®ï¼Œæˆ–è€…æœ€éš¾æ ‡è®°çš„æ•°æ®è¿›è¡Œäººå·¥æ ‡æ³¨ï¼Œç„¶åç”¨å¤šä¸ªæ¨¡å‹æŠ•ç¥¨ä¿è¯æ ‡è®°å‡†ç¡®åº¦<br><img src="/image/LLM/231.png" alt><br>é€šå¸¸ä¸åŠç›‘ç£å­¦ä¹ ç»“åˆä½¿ç”¨<br><img src="/image/LLM/232.png" alt></p>
<h2 id="è´¨é‡æ§åˆ¶"><a href="#è´¨é‡æ§åˆ¶" class="headerlink" title="è´¨é‡æ§åˆ¶"></a>è´¨é‡æ§åˆ¶</h2><p>é˜²æ­¢æ ‡é”™æˆ–è€…èŒƒå›´æœ‰é—®é¢˜ï¼Œå¯ä»¥é€‰æ‹©å°†ä¸€ä¸ªæ•°æ®å‘ç»™å¤šä¸ªæ ‡æ³¨äººå‘˜è¿›è¡Œæ ‡æ³¨ï¼Œç„¶åæ ¹æ®æ ‡æ³¨ç»“æœè¿›è¡ŒæŠ•ç¥¨<br>ä½†è¿™æ ·åšä¼šå¯¼è‡´æ ‡æ³¨æˆæœ¬å¢åŠ <br>é™ä½æˆæœ¬çš„æ–¹æ³•å¯ä»¥æ˜¯ï¼Œ<br>ä¸€æ˜¯ä»ç»“æœè§’åº¦æ€è€ƒï¼Œå…ˆè®©æ¨¡å‹è¿›è¡Œæ¨æµ‹ï¼Œå¦‚æœäººå·¥æ ‡æ³¨ä¸æ¨¡å‹æ¨æµ‹ç»“æœç›¸å·®è¾ƒå¤§ï¼Œåˆ™å°†æ•°æ®å‘ç»™å¤šä¸ªæ ‡æ³¨äººå‘˜è¿›è¡Œæ ‡æ³¨<br>å¦åˆ™åœæ­¢ä»»åŠ¡å‘é€ï¼Œå‡å°‘æˆæœ¬ï¼›æˆ–è€…å‘é€çš„å‰å‡ ä¸ªäººæ ‡è®°ç»“æœéƒ½ä¸€æ ·ï¼Œå°±åœæ­¢å‘é€æ›´å¤šäººè¿›è¡Œæ ‡è®°<br>äºŒæ˜¯ä»äººçš„è§’åº¦æ€è€ƒï¼Œå…ˆç»™ä¸€äº›æœ‰ç¡®å®šæ ‡æ³¨çš„æ•°æ®ç»™æ ‡è®°äººå‘˜è¿›è¡Œæ ‡æ³¨ï¼Œå¦‚æœæ ‡æ³¨ç»“æœä¸ç¡®å®šæ ‡æ³¨ç›¸å·®ç»“æœè¾ƒå¤§ï¼Œè¯´æ˜æ ‡æ³¨äººå‘˜èƒ½åŠ›æœ‰é—®é¢˜ï¼Œè¿›è¡Œäººå‘˜æ›´æ¢<br><img src="/image/LLM/233.png" alt></p>
<h2 id="å¼±ç›‘ç£å­¦ä¹ "><a href="#å¼±ç›‘ç£å­¦ä¹ " class="headerlink" title="å¼±ç›‘ç£å­¦ä¹ "></a>å¼±ç›‘ç£å­¦ä¹ </h2><p>ä½¿ç”¨å¯å‘å¼è§„åˆ™é€šè¿‡æ•°æ®ç¼–ç¨‹å¾—åˆ°ä¸€äº›æœ‰å™ªéŸ³çš„æ ‡æ³¨<br>é€šè¿‡åŠè‡ªåŠ¨åŒ–çš„æ–¹å¼ç”Ÿæˆå‡†ç¡®åº¦å¼±äºäººå·¥æ ‡è®°ï¼Œä½†è¶³ä»¥è¿›è¡Œæ¨¡å‹è®­ç»ƒçš„æ ‡æ³¨<br>é€šè¿‡æ ¹æ®æ•°æ®ç‰¹å¾çš„ä¸€ç³»åˆ—åˆ¤æ–­(å¯å‘å¼è§„åˆ™)è¿›è¡ŒæŠ•ç¥¨ï¼Œç„¶åå°†æŠ•ç¥¨ç»“æœè¿›è¡Œé˜ˆå€¼æ¯”è¾ƒï¼Œä»è€Œåˆ¤æ–­å±äºå“ªä¸ªåˆ†ç±»æ ‡ç­¾<br><img src="/image/LLM/233.png" alt></p>
<h1 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h1><p>ä¸‰ç§å¸¸è§æ•°æ®æ ‡æ³¨æ–¹å¼</p>
<ol>
<li>åŠç›‘ç£å­¦ä¹ </li>
<li>ä¼—åŒ…æ ‡æ³¨</li>
<li>å¼±ç›‘ç£å­¦ä¹ <br>å¯¹äºæ²¡æœ‰æ ‡è®°çš„æ•°æ®ä¹Ÿå¯ä»¥ç”¨æ— ç›‘ç£æˆ–è€…è‡ªç›‘ç£å­¦ä¹ è¿›è¡Œè®­ç»ƒ<br><img src="/image/LLM/233.png" alt></li>
</ol>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://yoohannah.github.io/post/machineLearning/ReinforcementLearning.html">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="YooHannah">
    <meta itemprop="description" content>
    <meta itemprop="image" content="/psb.jpg">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="My Little World">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="My Little World" src>
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/post/machineLearning/ReinforcementLearning.html" itemprop="url">
                  å¼ºåŒ–å­¦ä¹ 
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2024-10-07T14:34:37+08:00">
                2024-10-07
              </time>
            

            

            
          </span>

          

          
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>å¼ºåŒ–å­¦ä¹ çš„ä¸»è¦æ€æƒ³ä¸æ˜¯å‘Šè¯‰ç®—æ³•æ¯ä¸ªè¾“å…¥çš„æ­£ç¡®è¾“å‡ºæ˜¯ä»€ä¹ˆ<br>è€Œæ˜¯æŒ‡å®šä¸€ä¸ªå¥–åŠ±å‡½æ•°ï¼Œå‘Šè¯‰å®ƒä»€ä¹ˆæ—¶å€™åšçš„å¥½ï¼Œä»€ä¹ˆæ—¶å€™åšçš„ä¸å¥½<br>ç®—æ³•çš„å·¥ä½œæ˜¯è‡ªåŠ¨æ‰¾å‡ºå¦‚ä½•é€‰æ‹©å¥½çš„åŠ¨ä½œ</p>
<p><img src="/image/LLM/202.png" alt></p>
<h1 id="ä¸€äº›æ¦‚å¿µ"><a href="#ä¸€äº›æ¦‚å¿µ" class="headerlink" title="ä¸€äº›æ¦‚å¿µ"></a>ä¸€äº›æ¦‚å¿µ</h1><p>ä»¥ç«æ˜Ÿæ¢æµ‹å™¨ä¸ºä¾‹ï¼Œåœ¨å…¶å†³å®šè·¯çº¿çš„è¿‡ç¨‹ä¸­äº§ç”Ÿçš„å‡ ä¸ªæ¦‚å¿µ</p>
<ol>
<li>S ï¼š å½“å‰çŠ¶æ€</li>
<li>a : åŠ¨ä½œ</li>
<li>Sâ€™ : ä¸‹ä¸€ä¸ªçŠ¶æ€</li>
<li>R : å¥–åŠ±å‡½æ•°</li>
<li><p>teminal state : ç»ˆæ­¢çŠ¶æ€<br><img src="/image/LLM/203.png" alt><br>æ¯ç§è·¯çº¿å›æŠ¥é€šè¿‡è®¡ç®—è·¯ä¸Šæ¯ä¸€æ­¥å¥–åŠ±ä¹˜ä»¥æŠ˜ç°ç³»æ•°åŠ å’Œå¾—åˆ°<br><img src="/image/LLM/204.png" alt></p>
</li>
<li><p>policy : ç­–ç•¥å‡½æ•°ï¼Œæ ¹æ®å½“å‰çš„çŠ¶æ€é€‰æ‹©å¯ä»¥è·å¾—æœ€å¤§æ”¶ç›Šçš„åŠ¨ä½œ</p>
</li>
</ol>
<p>A policy is a function Ï€ï¼ˆsï¼‰= a  mapping from states to actions, that tells you what action a to take in a given state s.</p>
<p>The goal of reinforcement learning ===&gt;<br>Find a policy 5 that tells you what action (a = 5(s)) to take in every state (s) so as to maximize the return.</p>
<p><img src="/image/LLM/205.png" alt></p>
<h1 id="é©¬å°”ç§‘å¤«å†³ç­–è¿‡ç¨‹"><a href="#é©¬å°”ç§‘å¤«å†³ç­–è¿‡ç¨‹" class="headerlink" title="é©¬å°”ç§‘å¤«å†³ç­–è¿‡ç¨‹"></a>é©¬å°”ç§‘å¤«å†³ç­–è¿‡ç¨‹</h1><p>æœªæ¥åªå–å†³äºå½“å‰çš„åç§°ï¼Œè€Œä¸æ˜¯åˆ°è¾¾å½“å‰çŠ¶æ€ä¹‹å‰å¯èƒ½å‘ç”Ÿçš„ä»»ä½•äº‹æƒ…</p>
<p><img src="/image/LLM/206.png" alt></p>
<h1 id="çŠ¶æ€åŠ¨ä½œå›æŠ¥å‡½æ•°-Q"><a href="#çŠ¶æ€åŠ¨ä½œå›æŠ¥å‡½æ•°-Q" class="headerlink" title="çŠ¶æ€åŠ¨ä½œå›æŠ¥å‡½æ•° Q"></a>çŠ¶æ€åŠ¨ä½œå›æŠ¥å‡½æ•° Q</h1><p>å½“å‰çŠ¶æ€ä¸‹æ‰§è¡Œä¸€æ¬¡å‡½æ•°èƒ½å¤Ÿå¾—åˆ°çš„æœ€å¤§å›æŠ¥å€¼<br>å¦‚æœèƒ½å¤Ÿæ‰¾åˆ°æœ€å¤§å›æŠ¥å€¼ä¹Ÿå°±èƒ½çŸ¥é“æ¥ä¸‹æ¥åº”è¯¥ç”¨ä»€ä¹ˆåŠ¨ä½œ</p>
<p><img src="/image/LLM/207.png" alt></p>
<p><img src="/image/LLM/208.png" alt></p>
<h1 id="è´å°”æ›¼å…¬å¼"><a href="#è´å°”æ›¼å…¬å¼" class="headerlink" title="è´å°”æ›¼å…¬å¼"></a>è´å°”æ›¼å…¬å¼</h1><p><img src="/image/LLM/209.png" alt><br><img src="/image/LLM/210.png" alt><br><img src="/image/LLM/211.png" alt></p>
<h2 id="ä¼˜åŒ–"><a href="#ä¼˜åŒ–" class="headerlink" title="ä¼˜åŒ–"></a>ä¼˜åŒ–</h2><p>é¢å¯¹ç¯å¢ƒéšæœºçš„æƒ…å†µï¼ŒåŠ¨ä½œå®é™…æ‰§è¡Œè¿‡ç¨‹å¯èƒ½å­˜åœ¨å¤šä¸ªå¯èƒ½è·¯çº¿ï¼Œå¯¼è‡´æ¯æ¬¡å¾—åˆ°çš„æœ€å¤§å›æŠ¥å€¼ä¸åŒï¼Œå› æ­¤è®¡ç®—å½“å‰çŠ¶æ€æœ€å¤§æ”¶ç›Šæ—¶å–æ‰€æœ‰è·¯çº¿æƒ…å†µçš„å¹³å‡å€¼è¿›è¡Œè®¡ç®—<br>å³ä½¿ç”¨æœŸæœ›å›æŠ¥å€¼è¿›è¡Œè®¡ç®—<br><img src="/image/LLM/212.png" alt><br><img src="/image/LLM/213.png" alt></p>
<h1 id="DQN-ç®—æ³•"><a href="#DQN-ç®—æ³•" class="headerlink" title="DQN ç®—æ³•"></a>DQN ç®—æ³•</h1><p>D: deep learning<br>Q: Q function<br>N: Network</p>
<p>å¯¹äºè¿ç»­çŠ¶æ€å€¼çš„æƒ…å†µï¼Œä½¿ç”¨ç¥ç»ç½‘ç»œè®­ç»ƒQå‡½æ•°è¿›è¡Œæ·±åº¦å¼ºåŒ–å­¦ä¹ <br><img src="/image/LLM/214.png" alt><br><img src="/image/LLM/215.png" alt><br><img src="/image/LLM/216.png" alt><br>By using experience replay we avoid problematic correlations, oscillations and instabilities. In addition, experience replay also allows the agent to potentially use the same experience in multiple weight updates, which increases data efficiency.<br>é€šè¿‡ä½¿ç”¨ç»éªŒé‡æ”¾ï¼Œæˆ‘ä»¬å¯ä»¥é¿å…æœ‰é—®é¢˜çš„ç›¸å…³æ€§ã€æŒ¯è¡å’Œä¸ç¨³å®šæ€§ã€‚æ­¤å¤–ï¼Œç»éªŒé‡æ”¾è¿˜å…è®¸ä»£ç†åœ¨å¤šæ¬¡æƒé‡æ›´æ–°ä¸­ä½¿ç”¨ç›¸åŒçš„ç»éªŒï¼Œä»è€Œæé«˜æ•°æ®æ•ˆç‡ã€‚</p>
<h2 id="ä¼˜åŒ–-1"><a href="#ä¼˜åŒ–-1" class="headerlink" title="ä¼˜åŒ–"></a>ä¼˜åŒ–</h2><h3 id="ä¼˜åŒ–ç¥ç»ç½‘ç»œç»“æ„"><a href="#ä¼˜åŒ–ç¥ç»ç½‘ç»œç»“æ„" class="headerlink" title="ä¼˜åŒ–ç¥ç»ç½‘ç»œç»“æ„"></a>ä¼˜åŒ–ç¥ç»ç½‘ç»œç»“æ„</h3><p>ä¸Šé¢å°†så’Œaä½œä¸ºX åŒæ—¶å‚ä¸è®­ç»ƒï¼Œæœ€ç»ˆåªä¼šå¾—åˆ°ä¸€ä¸ªåŠ¨ä½œaæœ€å¤§å›æŠ¥å‡½æ•°å€¼,éœ€è¦è¿›è¡Œå¤šæ¬¡è¿ç®—<br>å¦‚æœä»…å°†sä½œä¸ºè¾“å…¥ï¼Œè¾“å‡ºå±‚äº§ç”Ÿå¤šä¸ªaçš„å›æŠ¥å€¼ï¼Œå°±å¯ä»¥æ ¹æ®å›æŠ¥å€¼å¤§å°é€‰æ‹©ç›¸åº”çš„åŠ¨ä½œ</p>
<p><img src="/image/LLM/217.png" alt><br><img src="/image/LLM/218.png" alt></p>
<h3 id="epsilon-greedy-policy"><a href="#epsilon-greedy-policy" class="headerlink" title="epsilon-greedy policy"></a>epsilon-greedy policy</h3><p>é€‰æ‹©action è¿‡ç¨‹ä¸­ï¼Œå¦‚æœä¸€ç›´æŒ‰Qå€¼æœ€å¤§åŸåˆ™é€‰æ‹©action,ä¸‡ä¸€åˆå§‹å€¼ç‰¹åˆ«å°æ— æ³•å¼€å¯æˆ‘ä»¬æƒ³è¦çš„ç¬¬ä¸€æ­¥ç¨‹åºï¼Œå°±ä¼šå¯¼è‡´æ— æ³•è¿›è¡Œåç»­çš„action<br>epsilon-greedy policy æ–¹æ¡ˆå°±æ˜¯æ‰¾ä¸€ä¸ªåˆé€‚çš„é˜ˆå€¼epsilonï¼Œæ¯”å¦‚è¯´0.05,<br>95%çš„æ—¶é—´é€‰æ‹©æœ€å¤§Qå€¼action (è´ªå©ªå‰¥å‰Šç­–ç•¥)<br>5%çš„æ—¶é—´é€‰æ‹©éšæœºé€‰æ‹©actionï¼ˆæ¢ç´¢ç­–ç•¥ï¼‰<br>è¿™æ ·å°±å¯ä»¥é¿å…é€‰åˆ°å›ºå®šä¸ç¬¦åˆé¢„æœŸçš„action,å¼€æ”¾ä¸€å®šçš„çª—å£æœ‰å¯èƒ½é€‰åˆ°å…¶ä»–çš„action<br>epsilon å¤§å° ç±»ä¼¼äºæ¢¯åº¦ï¼Œéšè®­ç»ƒè¿‡ç¨‹è¿›è¡Œä¼šé€æ¸å˜å°ï¼Œå˜å°çš„è¿‡ç¨‹ï¼Œæ¨¡å‹ä¹Ÿå°±å­¦ä¼šäº†å¦‚ä½•é€‰æ‹©æ›´æœ‰å¯èƒ½é€‰æ‹©ç¬¦åˆé¢„æœŸçš„action</p>
<p><img src="/image/LLM/219.png" alt></p>
<h3 id="å°æ‰¹é‡"><a href="#å°æ‰¹é‡" class="headerlink" title="å°æ‰¹é‡"></a>å°æ‰¹é‡</h3><p>è®­ç»ƒæ•°æ®å¦‚æœéå¸¸åºå¤§ï¼Œåœ¨è®­ç»ƒè¿‡ç¨‹ä¸­å¯èƒ½ä¼šé€ æˆæ—¶é—´æ¶ˆè€—ï¼Œä¸ºäº†æé«˜è®­ç»ƒé€Ÿåº¦ï¼Œå¯ä»¥é‡‡ç”¨å°æ‰¹é‡çš„æ–¹å¼è¿›è¡Œ<br>å°†è®­ç»ƒæ•°æ®åˆ†æˆå¤šä¸ªæ‰¹æ¬¡ï¼Œæ¯æ¬¡è¿­ä»£ç”¨ä¸åŒæ‰¹æ¬¡æ•°æ®ï¼Œè™½ç„¶æ¢¯åº¦ä¼šæ¯”è¾ƒå˜ˆæ‚ï¼Œä½†è¿˜æ˜¯ä¼šæœç€æ¢¯åº¦ä¸‹é™çš„æ–¹å‘è¿›è¡Œ<br><img src="/image/LLM/220.png" alt><br><img src="/image/LLM/221.png" alt><br><img src="/image/LLM/222.png" alt><br><img src="/image/LLM/223.png" alt></p>
<h3 id="è½¯æ›´æ–°"><a href="#è½¯æ›´æ–°" class="headerlink" title="è½¯æ›´æ–°"></a>è½¯æ›´æ–°</h3><p>åœ¨æ›´æ–°å‚æ•°è¿‡ç¨‹ä¸­ï¼Œæ¯æ¬¡æŒ‰æ¯”ä¾‹æ›´æ–°å‚æ•°ï¼Œæ¯æ¬¡ä»…æ›´æ–°éƒ¨åˆ†æ¯”ä¾‹çš„å‚æ•°ï¼Œå¯ä»¥ä½¿å¼ºåŒ–å­¦ä¹ æ›´å¥½çš„æ”¶æ•›<br><img src="/image/LLM/224.png" alt></p>
<h1 id="å¼ºåŒ–å­¦ä¹ çš„ä¸€äº›é™åˆ¶"><a href="#å¼ºåŒ–å­¦ä¹ çš„ä¸€äº›é™åˆ¶" class="headerlink" title="å¼ºåŒ–å­¦ä¹ çš„ä¸€äº›é™åˆ¶"></a>å¼ºåŒ–å­¦ä¹ çš„ä¸€äº›é™åˆ¶</h1><p><img src="/image/LLM/225.png" alt></p>
<p><a href="https://github.com/kaieye/2022-Machine-Learning-Specialization/blob/main/Unsupervised%20learning%20recommenders%20reinforcement%20learning/week3/Practice%20Lab-Reinforcement%20Learning/C3_W3_A1_Assignment.ipynb" target="_blank" rel="noopener">å®éªŒç»ƒä¹ </a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><span class="space">&hellip;</span><a class="page-number" href="/page/25/">25</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image" src="/psb.jpg" alt="YooHannah">
          <p class="site-author-name" itemprop="name">YooHannah</p>
          <p class="site-description motion-element" itemprop="description"></p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">245</span>
              <span class="site-state-item-name">æ—¥å¿—</span>
            </a>
          </div>

          
            <div class="site-state-item site-state-categories">
              <a href="/categories">
                <span class="site-state-item-count">1</span>
                <span class="site-state-item-name">åˆ†ç±»</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">21</span>
                <span class="site-state-item-name">æ ‡ç­¾</span>
              </a>
            </div>
          

        </nav>

        
          <div class="feed-link motion-element">
            <a href="/atom.xml" rel="alternate">
              <i class="fa fa-rss"></i>
              RSS
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

        


      </section>

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">YooHannah</span>
</div>


<div class="powered-by">
  ç”± <a class="theme-link" href="https://hexo.io">Hexo</a> å¼ºåŠ›é©±åŠ¨
</div>

<div class="theme-info">
  ä¸»é¢˜ -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Pisces
  </a>
</div>


        

        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  



  



  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>

  
  <script type="text/javascript" src="/lib/treedocument/treedocument.js"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.0"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.0"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.0"></script>



  



  




	




  
  

  

  

  

  


</body>
</html>
